2022-12-15 14:13:23.143844 (MainThread): Running with dbt=0.19.0
2022-12-15 14:13:24.039831 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 14:13:24.041077 (MainThread): Tracking: tracking
2022-12-15 14:13:24.050974 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83be33d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83be33f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83be33f98>]}
2022-12-15 14:13:24.083163 (MainThread): Partial parsing not enabled
2022-12-15 14:13:24.084896 (MainThread): Parsing macros/catalog.sql
2022-12-15 14:13:24.095668 (MainThread): Parsing macros/etc.sql
2022-12-15 14:13:24.098885 (MainThread): Parsing macros/adapters.sql
2022-12-15 14:13:24.123596 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 14:13:24.127579 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 14:13:24.131499 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 14:13:24.147817 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 14:13:24.160048 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 14:13:24.165819 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 14:13:24.169714 (MainThread): Parsing macros/core.sql
2022-12-15 14:13:24.174819 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 14:13:24.230263 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 14:13:24.232170 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 14:13:24.243495 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 14:13:24.246063 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 14:13:24.248468 (MainThread): Parsing macros/etc/query.sql
2022-12-15 14:13:24.250048 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 14:13:24.252874 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 14:13:24.255269 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 14:13:24.257811 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 14:13:24.261532 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 14:13:24.263699 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 14:13:24.275118 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 14:13:24.283711 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 14:13:24.286196 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 14:13:24.294107 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 14:13:24.311556 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 14:13:24.314105 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 14:13:24.337593 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 14:13:24.375744 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 14:13:24.401866 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 14:13:24.409966 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 14:13:24.424351 (MainThread): Partial parsing not enabled
2022-12-15 14:13:24.493171 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.my_first_dbt_model".
2022-12-15 14:13:24.526575 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.my_second_dbt_model".
2022-12-15 14:13:24.831068 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01f72b87-ab3e-4458-9e32-ce9cc52554f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83bb54390>]}
2022-12-15 14:13:24.889819 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-12-15 14:13:24.891093 (MainThread): 
2022-12-15 14:13:24.891634 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 14:13:24.895941 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 14:13:24.896341 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 14:13:25.079825 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 14:13:25.080341 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 14:13:25.085680 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 14:13:25.247554 (MainThread): 14:13:25 | Concurrency: 1 threads (target='dev')
2022-12-15 14:13:25.247884 (MainThread): 14:13:25 | 
2022-12-15 14:13:25.250854 (Thread-1): Began running node model.online_payment_fraud.my_first_dbt_model
2022-12-15 14:13:25.252661 (Thread-1): 14:13:25 | 1 of 2 START table model timestamp_fraud_complete.my_first_dbt_model. [RUN]
2022-12-15 14:13:25.253194 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.my_first_dbt_model".
2022-12-15 14:13:25.253456 (Thread-1): Compiling model.online_payment_fraud.my_first_dbt_model
2022-12-15 14:13:25.276046 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.my_first_dbt_model"
2022-12-15 14:13:25.277091 (Thread-1): finished collecting timing info
2022-12-15 14:13:25.327542 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.my_first_dbt_model"
2022-12-15 14:13:25.328410 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 14:13:25.334417 (Thread-1): On model.online_payment_fraud.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.my_first_dbt_model"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2022-12-15 14:13:27.350795 (Thread-1): finished collecting timing info
2022-12-15 14:13:27.352128 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01f72b87-ab3e-4458-9e32-ce9cc52554f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83baf3eb8>]}
2022-12-15 14:13:27.353962 (Thread-1): 14:13:27 | 1 of 2 OK created table model timestamp_fraud_complete.my_first_dbt_model [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.10s]
2022-12-15 14:13:27.354329 (Thread-1): Finished running node model.online_payment_fraud.my_first_dbt_model
2022-12-15 14:13:27.355090 (Thread-1): Began running node model.online_payment_fraud.my_second_dbt_model
2022-12-15 14:13:27.357324 (Thread-1): 14:13:27 | 2 of 2 START view model timestamp_fraud_complete.my_second_dbt_model. [RUN]
2022-12-15 14:13:27.357916 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.my_second_dbt_model".
2022-12-15 14:13:27.358194 (Thread-1): Compiling model.online_payment_fraud.my_second_dbt_model
2022-12-15 14:13:27.368683 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.my_second_dbt_model"
2022-12-15 14:13:27.369327 (Thread-1): finished collecting timing info
2022-12-15 14:13:27.393916 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.my_second_dbt_model"
2022-12-15 14:13:27.394625 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 14:13:27.399998 (Thread-1): On model.online_payment_fraud.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.my_second_dbt_model"} */


  create or replace view `final-project-team1`.`timestamp_fraud_complete`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `final-project-team1`.`timestamp_fraud_complete`.`my_first_dbt_model`
where id = 1;


2022-12-15 14:13:28.235864 (Thread-1): finished collecting timing info
2022-12-15 14:13:28.237088 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01f72b87-ab3e-4458-9e32-ce9cc52554f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83bbc5e80>]}
2022-12-15 14:13:28.238589 (Thread-1): 14:13:28 | 2 of 2 OK created view model timestamp_fraud_complete.my_second_dbt_model [OK in 0.88s]
2022-12-15 14:13:28.238870 (Thread-1): Finished running node model.online_payment_fraud.my_second_dbt_model
2022-12-15 14:13:28.256687 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 14:13:28.257269 (MainThread): 14:13:28 | 
2022-12-15 14:13:28.257493 (MainThread): 14:13:28 | Finished running 1 table model, 1 view model in 3.37s.
2022-12-15 14:13:28.257688 (MainThread): Connection 'master' was properly closed.
2022-12-15 14:13:28.257805 (MainThread): Connection 'model.online_payment_fraud.my_second_dbt_model' was properly closed.
2022-12-15 14:13:28.307314 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 52366), raddr=('209.85.200.95', 443)>
2022-12-15 14:13:28.307727 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 47392), raddr=('108.177.112.95', 443)>
2022-12-15 14:13:28.308203 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 52376), raddr=('209.85.200.95', 443)>
2022-12-15 14:13:28.308441 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 47396), raddr=('108.177.112.95', 443)>
2022-12-15 14:13:28.308736 (MainThread): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 46274), raddr=('209.85.200.95', 443)>
2022-12-15 14:13:28.308945 (MainThread): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 46722), raddr=('108.177.112.95', 443)>
2022-12-15 14:13:28.314399 (MainThread): 
2022-12-15 14:13:28.314630 (MainThread): Completed successfully
2022-12-15 14:13:28.314831 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-12-15 14:13:28.315119 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83bc7beb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83bcbdf28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83bb16908>]}
2022-12-15 14:13:28.315430 (MainThread): Flushing usage events
2022-12-15 14:37:26.538014 (MainThread): Running with dbt=0.19.0
2022-12-15 14:37:27.297735 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 14:37:27.299298 (MainThread): Tracking: tracking
2022-12-15 14:37:27.309074 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8340579e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8340579fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834058e1d0>]}
2022-12-15 14:37:27.340962 (MainThread): Partial parsing not enabled
2022-12-15 14:37:27.342359 (MainThread): Parsing macros/catalog.sql
2022-12-15 14:37:27.352503 (MainThread): Parsing macros/etc.sql
2022-12-15 14:37:27.355528 (MainThread): Parsing macros/adapters.sql
2022-12-15 14:37:27.380339 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 14:37:27.384047 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 14:37:27.387726 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 14:37:27.404273 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 14:37:27.416674 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 14:37:27.422522 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 14:37:27.425849 (MainThread): Parsing macros/core.sql
2022-12-15 14:37:27.430841 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 14:37:27.483991 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 14:37:27.485423 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 14:37:27.497012 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 14:37:27.499203 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 14:37:27.501337 (MainThread): Parsing macros/etc/query.sql
2022-12-15 14:37:27.502781 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 14:37:27.505456 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 14:37:27.507738 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 14:37:27.510197 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 14:37:27.513680 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 14:37:27.515744 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 14:37:27.527062 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 14:37:27.535316 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 14:37:27.537904 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 14:37:27.545755 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 14:37:27.563027 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 14:37:27.565521 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 14:37:27.587796 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 14:37:27.626765 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 14:37:27.652596 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 14:37:27.660506 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 14:37:27.674275 (MainThread): Partial parsing not enabled
2022-12-15 14:37:27.733489 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 14:37:27.941882 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83fbe431-fc15-4e57-974e-438494c26984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834039e6d8>]}
2022-12-15 14:37:27.979441 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 14:37:27.980683 (MainThread): 
2022-12-15 14:37:27.981318 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 14:37:27.983782 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 14:37:27.984129 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 14:37:28.142917 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 14:37:28.143349 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 14:37:28.148727 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 14:37:28.281561 (MainThread): 14:37:28 | Concurrency: 1 threads (target='dev')
2022-12-15 14:37:28.282154 (MainThread): 14:37:28 | 
2022-12-15 14:37:28.284891 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 14:37:28.286447 (Thread-1): 14:37:28 | 1 of 1 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 14:37:28.287023 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 14:37:28.287355 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 14:37:28.306802 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 14:37:28.307843 (Thread-1): finished collecting timing info
2022-12-15 14:37:28.344883 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 38154), raddr=('142.250.103.95', 443)>
2022-12-15 14:37:28.345327 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 33034), raddr=('74.125.132.95', 443)>
2022-12-15 14:37:28.345653 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 38138), raddr=('142.250.103.95', 443)>
2022-12-15 14:37:28.345997 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 49238), raddr=('142.250.128.95', 443)>
2022-12-15 14:37:28.358412 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 14:37:28.359293 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 14:37:28.364506 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1.timestamp_fraud_complete`
ORDER BY timestamp, step
  );
    
2022-12-15 14:37:28.682071 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1.timestamp_fraud_complete`
ORDER BY timestamp, step
  );
    
2022-12-15 14:37:28.682329 (Thread-1): 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/fc1b0dc2-d547-44e6-a75e-da725633fba1?maxResults=0&location=US&prettyPrint=false: Not found: Dataset final-project-team1:final-project-team1 was not found in location US

(job ID: fc1b0dc2-d547-44e6-a75e-da725633fba1)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT * FROM `final-project-team1.timestamp_fraud_complete`
  13:ORDER BY timestamp, step
  14:  );
  15:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2022-12-15 14:37:28.682739 (Thread-1): finished collecting timing info
2022-12-15 14:37:28.683690 (Thread-1): Runtime Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/fc1b0dc2-d547-44e6-a75e-da725633fba1?maxResults=0&location=US&prettyPrint=false: Not found: Dataset final-project-team1:final-project-team1 was not found in location US
  
  (job ID: fc1b0dc2-d547-44e6-a75e-da725633fba1)
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/fc1b0dc2-d547-44e6-a75e-da725633fba1?maxResults=0&location=US&prettyPrint=false: Not found: Dataset final-project-team1:final-project-team1 was not found in location US

(job ID: fc1b0dc2-d547-44e6-a75e-da725633fba1)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT * FROM `final-project-team1.timestamp_fraud_complete`
  13:ORDER BY timestamp, step
  14:  );
  15:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 181, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/fc1b0dc2-d547-44e6-a75e-da725633fba1?maxResults=0&location=US&prettyPrint=false: Not found: Dataset final-project-team1:final-project-team1 was not found in location US
  
  (job ID: fc1b0dc2-d547-44e6-a75e-da725633fba1)
2022-12-15 14:37:28.692245 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83fbe431-fc15-4e57-974e-438494c26984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83403a2400>]}
2022-12-15 14:37:28.693851 (Thread-1): 14:37:28 | 1 of 1 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 0.41s]
2022-12-15 14:37:28.694065 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 14:37:28.785924 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 14:37:28.786468 (MainThread): 14:37:28 | 
2022-12-15 14:37:28.786645 (MainThread): 14:37:28 | Finished running 1 table model in 0.81s.
2022-12-15 14:37:28.786763 (MainThread): Connection 'master' was properly closed.
2022-12-15 14:37:28.786844 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-15 14:37:28.824743 (MainThread): 
2022-12-15 14:37:28.824978 (MainThread): Completed with 1 error and 0 warnings:
2022-12-15 14:37:28.825195 (MainThread): 
2022-12-15 14:37:28.825416 (MainThread): Runtime Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-15 14:37:28.825625 (MainThread):   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/fc1b0dc2-d547-44e6-a75e-da725633fba1?maxResults=0&location=US&prettyPrint=false: Not found: Dataset final-project-team1:final-project-team1 was not found in location US
2022-12-15 14:37:28.825810 (MainThread):   
2022-12-15 14:37:28.826019 (MainThread):   (job ID: fc1b0dc2-d547-44e6-a75e-da725633fba1)
2022-12-15 14:37:28.826217 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-12-15 14:37:28.826570 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8340460a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8340460da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8340359588>]}
2022-12-15 14:37:28.826899 (MainThread): Flushing usage events
2022-12-15 14:39:00.217512 (MainThread): Running with dbt=0.19.0
2022-12-15 14:39:00.885872 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 14:39:00.887079 (MainThread): Tracking: tracking
2022-12-15 14:39:00.896432 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d24a9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d24a9f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d24a9fd0>]}
2022-12-15 14:39:00.927260 (MainThread): Partial parsing not enabled
2022-12-15 14:39:00.928765 (MainThread): Parsing macros/catalog.sql
2022-12-15 14:39:00.939320 (MainThread): Parsing macros/etc.sql
2022-12-15 14:39:00.942136 (MainThread): Parsing macros/adapters.sql
2022-12-15 14:39:00.966119 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 14:39:00.969709 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 14:39:00.973203 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 14:39:00.989812 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 14:39:01.001839 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 14:39:01.007242 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 14:39:01.010507 (MainThread): Parsing macros/core.sql
2022-12-15 14:39:01.015386 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 14:39:01.070096 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 14:39:01.071937 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 14:39:01.083746 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 14:39:01.086006 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 14:39:01.088455 (MainThread): Parsing macros/etc/query.sql
2022-12-15 14:39:01.089920 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 14:39:01.092651 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 14:39:01.094898 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 14:39:01.097421 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 14:39:01.101207 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 14:39:01.103233 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 14:39:01.114610 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 14:39:01.122886 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 14:39:01.125300 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 14:39:01.133186 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 14:39:01.150827 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 14:39:01.153198 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 14:39:01.175233 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 14:39:01.213348 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 14:39:01.239460 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 14:39:01.247210 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 14:39:01.260580 (MainThread): Partial parsing not enabled
2022-12-15 14:39:01.321509 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 14:39:01.531506 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd4204b-4066-40fc-8d1f-0a2cb66d32f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d229d710>]}
2022-12-15 14:39:01.568543 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 14:39:01.569733 (MainThread): 
2022-12-15 14:39:01.570356 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 14:39:01.572896 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 14:39:01.573241 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 14:39:01.736908 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 14:39:01.737342 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 14:39:01.742741 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 14:39:01.864924 (MainThread): 14:39:01 | Concurrency: 1 threads (target='dev')
2022-12-15 14:39:01.865260 (MainThread): 14:39:01 | 
2022-12-15 14:39:01.867961 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 14:39:01.869700 (Thread-1): 14:39:01 | 1 of 1 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 14:39:01.870388 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 14:39:01.870764 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 14:39:01.890679 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 14:39:01.891399 (Thread-1): finished collecting timing info
2022-12-15 14:39:01.927033 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44988), raddr=('142.250.128.95', 443)>
2022-12-15 14:39:01.927477 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 56974), raddr=('142.250.103.95', 443)>
2022-12-15 14:39:01.940579 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 14:39:01.941205 (Thread-1): Opening a new connection, currently in state init
2022-12-15 14:39:01.946446 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1.timestamp_fraud_complete`
ORDER BY timestamp, step
  );
    
2022-12-15 14:39:02.222080 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1.timestamp_fraud_complete`
ORDER BY timestamp, step
  );
    
2022-12-15 14:39:02.222549 (Thread-1): 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/3ab14c49-ea9a-4dcc-b4d9-1001b62428cc?maxResults=0&location=US&prettyPrint=false: Not found: Dataset final-project-team1:final-project-team1 was not found in location US

(job ID: 3ab14c49-ea9a-4dcc-b4d9-1001b62428cc)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT * FROM `final-project-team1.timestamp_fraud_complete`
  13:ORDER BY timestamp, step
  14:  );
  15:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2022-12-15 14:39:02.223012 (Thread-1): finished collecting timing info
2022-12-15 14:39:02.223899 (Thread-1): Runtime Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/3ab14c49-ea9a-4dcc-b4d9-1001b62428cc?maxResults=0&location=US&prettyPrint=false: Not found: Dataset final-project-team1:final-project-team1 was not found in location US
  
  (job ID: 3ab14c49-ea9a-4dcc-b4d9-1001b62428cc)
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/3ab14c49-ea9a-4dcc-b4d9-1001b62428cc?maxResults=0&location=US&prettyPrint=false: Not found: Dataset final-project-team1:final-project-team1 was not found in location US

(job ID: 3ab14c49-ea9a-4dcc-b4d9-1001b62428cc)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT * FROM `final-project-team1.timestamp_fraud_complete`
  13:ORDER BY timestamp, step
  14:  );
  15:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 181, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/3ab14c49-ea9a-4dcc-b4d9-1001b62428cc?maxResults=0&location=US&prettyPrint=false: Not found: Dataset final-project-team1:final-project-team1 was not found in location US
  
  (job ID: 3ab14c49-ea9a-4dcc-b4d9-1001b62428cc)
2022-12-15 14:39:02.227942 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd4204b-4066-40fc-8d1f-0a2cb66d32f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d23952e8>]}
2022-12-15 14:39:02.229663 (Thread-1): 14:39:02 | 1 of 1 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 0.36s]
2022-12-15 14:39:02.229946 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 14:39:02.268605 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 14:39:02.269204 (MainThread): 14:39:02 | 
2022-12-15 14:39:02.269434 (MainThread): 14:39:02 | Finished running 1 table model in 0.70s.
2022-12-15 14:39:02.269634 (MainThread): Connection 'master' was properly closed.
2022-12-15 14:39:02.269784 (MainThread): Connection 'list_final-project-team1_timestamp_fraud_complete' was properly closed.
2022-12-15 14:39:02.269916 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-15 14:39:02.280287 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 45008), raddr=('142.250.128.95', 443)>
2022-12-15 14:39:02.280568 (MainThread): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 56990), raddr=('142.250.103.95', 443)>
2022-12-15 14:39:02.307183 (MainThread): 
2022-12-15 14:39:02.307480 (MainThread): Completed with 1 error and 0 warnings:
2022-12-15 14:39:02.307678 (MainThread): 
2022-12-15 14:39:02.307872 (MainThread): Runtime Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-15 14:39:02.308049 (MainThread):   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/3ab14c49-ea9a-4dcc-b4d9-1001b62428cc?maxResults=0&location=US&prettyPrint=false: Not found: Dataset final-project-team1:final-project-team1 was not found in location US
2022-12-15 14:39:02.308214 (MainThread):   
2022-12-15 14:39:02.308361 (MainThread):   (job ID: 3ab14c49-ea9a-4dcc-b4d9-1001b62428cc)
2022-12-15 14:39:02.308538 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-12-15 14:39:02.308862 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d233eeb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d221c048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97d2333668>]}
2022-12-15 14:39:02.309192 (MainThread): Flushing usage events
2022-12-15 14:40:23.386821 (MainThread): Running with dbt=0.19.0
2022-12-15 14:40:24.074690 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 14:40:24.076089 (MainThread): Tracking: tracking
2022-12-15 14:40:24.085763 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7f5e9e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7f5e9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7f5fe1d0>]}
2022-12-15 14:40:24.138164 (MainThread): Partial parsing not enabled
2022-12-15 14:40:24.140353 (MainThread): Parsing macros/catalog.sql
2022-12-15 14:40:24.151796 (MainThread): Parsing macros/etc.sql
2022-12-15 14:40:24.154556 (MainThread): Parsing macros/adapters.sql
2022-12-15 14:40:24.179200 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 14:40:24.183125 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 14:40:24.186708 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 14:40:24.203027 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 14:40:24.215527 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 14:40:24.221127 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 14:40:24.224498 (MainThread): Parsing macros/core.sql
2022-12-15 14:40:24.229787 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 14:40:24.284403 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 14:40:24.285855 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 14:40:24.297298 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 14:40:24.299614 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 14:40:24.301760 (MainThread): Parsing macros/etc/query.sql
2022-12-15 14:40:24.303212 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 14:40:24.305906 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 14:40:24.308224 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 14:40:24.310741 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 14:40:24.314516 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 14:40:24.316620 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 14:40:24.328309 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 14:40:24.337195 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 14:40:24.339649 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 14:40:24.347556 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 14:40:24.365554 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 14:40:24.368030 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 14:40:24.391658 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 14:40:24.429772 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 14:40:24.455941 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 14:40:24.463949 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 14:40:24.477697 (MainThread): Partial parsing not enabled
2022-12-15 14:40:24.536554 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 14:40:24.681471 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd90f3e5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7f4932b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7f493e48>]}
2022-12-15 14:40:24.681909 (MainThread): Flushing usage events
2022-12-15 14:40:24.875757 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-15 14:40:24.876542 (MainThread): Encountered an error:
2022-12-15 14:40:24.877472 (MainThread): Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Model 'model.online_payment_fraud.stg_raw_fraud' (models/staging/stg_raw_fraud.sql) depends on a source named 'timestamp_fraud_complete.raw_fraud' which was not found
2022-12-15 14:40:24.880279 (MainThread): Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 799, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 502, in invalid_source_fail_unless_test
    disabled=disabled
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Model 'model.online_payment_fraud.stg_raw_fraud' (models/staging/stg_raw_fraud.sql) depends on a source named 'timestamp_fraud_complete.raw_fraud' which was not found

2022-12-15 17:11:16.209567 (MainThread): Running with dbt=0.19.0
2022-12-15 17:11:16.892087 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 17:11:16.893027 (MainThread): Tracking: tracking
2022-12-15 17:11:16.903622 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c7953dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c7953f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c7953f98>]}
2022-12-15 17:11:16.955269 (MainThread): Partial parsing not enabled
2022-12-15 17:11:16.957629 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:11:16.973840 (MainThread): Parsing macros/etc.sql
2022-12-15 17:11:16.978426 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:11:17.006315 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:11:17.010334 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:11:17.013984 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:11:17.030075 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:11:17.042296 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:11:17.047901 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:11:17.051620 (MainThread): Parsing macros/core.sql
2022-12-15 17:11:17.056578 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:11:17.110820 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:11:17.112350 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:11:17.124306 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:11:17.126622 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:11:17.128845 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:11:17.130335 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:11:17.133036 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:11:17.135317 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:11:17.138172 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:11:17.141643 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:11:17.143955 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:11:17.155574 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:11:17.164706 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:11:17.167067 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:11:17.174806 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:11:17.192278 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:11:17.194726 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:11:17.217685 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:11:17.256937 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:11:17.283221 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:11:17.291541 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:11:17.305836 (MainThread): Partial parsing not enabled
2022-12-15 17:11:17.372879 (MainThread): Acquiring new bigquery connection "model.timestamp_fraud_complete.stg_raw_fraud".
2022-12-15 17:11:17.532166 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d92ad550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c77fdb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c77fd278>]}
2022-12-15 17:11:17.532516 (MainThread): Flushing usage events
2022-12-15 17:11:17.711334 (MainThread): Connection 'model.timestamp_fraud_complete.stg_raw_fraud' was properly closed.
2022-12-15 17:11:17.712132 (MainThread): Encountered an error:
2022-12-15 17:11:17.712470 (MainThread): Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Model 'model.timestamp_fraud_complete.stg_raw_fraud' (models/staging/stg_raw_fraud.sql) depends on a source named 'timestamp_fraud_complete.raw_fraud' which was not found
2022-12-15 17:11:17.715186 (MainThread): Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 799, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 502, in invalid_source_fail_unless_test
    disabled=disabled
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Model 'model.timestamp_fraud_complete.stg_raw_fraud' (models/staging/stg_raw_fraud.sql) depends on a source named 'timestamp_fraud_complete.raw_fraud' which was not found

2022-12-15 17:12:00.631204 (MainThread): Running with dbt=0.19.0
2022-12-15 17:12:01.332744 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 17:12:01.334319 (MainThread): Tracking: tracking
2022-12-15 17:12:01.346116 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9807383e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9807383fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98073991d0>]}
2022-12-15 17:12:01.379080 (MainThread): Partial parsing not enabled
2022-12-15 17:12:01.380566 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:12:01.391233 (MainThread): Parsing macros/etc.sql
2022-12-15 17:12:01.394155 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:12:01.418925 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:12:01.422646 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:12:01.426172 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:12:01.442336 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:12:01.454811 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:12:01.460521 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:12:01.464349 (MainThread): Parsing macros/core.sql
2022-12-15 17:12:01.469439 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:12:01.523458 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:12:01.524898 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:12:01.536336 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:12:01.538766 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:12:01.540910 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:12:01.542354 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:12:01.544999 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:12:01.547213 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:12:01.549787 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:12:01.553571 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:12:01.555620 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:12:01.567482 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:12:01.575839 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:12:01.578358 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:12:01.586176 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:12:01.603761 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:12:01.606195 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:12:01.628025 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:12:01.666671 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:12:01.693183 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:12:01.701323 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:12:01.715056 (MainThread): Partial parsing not enabled
2022-12-15 17:12:01.774430 (MainThread): Acquiring new bigquery connection "model.timestamp_fraud_complete.stg_raw_fraud".
2022-12-15 17:12:01.937615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f980722db70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f980722deb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9818ce35c0>]}
2022-12-15 17:12:01.938034 (MainThread): Flushing usage events
2022-12-15 17:12:02.065488 (MainThread): Connection 'model.timestamp_fraud_complete.stg_raw_fraud' was properly closed.
2022-12-15 17:12:02.066175 (MainThread): Encountered an error:
2022-12-15 17:12:02.066464 (MainThread): Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Model 'model.timestamp_fraud_complete.stg_raw_fraud' (models/staging/stg_raw_fraud.sql) depends on a source named 'timestamp_fraud_complete.raw_fraud' which was not found
2022-12-15 17:12:02.068486 (MainThread): Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 379, in process_manifest
    process_sources(manifest, project_name)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 812, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 799, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 502, in invalid_source_fail_unless_test
    disabled=disabled
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Model 'model.timestamp_fraud_complete.stg_raw_fraud' (models/staging/stg_raw_fraud.sql) depends on a source named 'timestamp_fraud_complete.raw_fraud' which was not found

2022-12-15 17:13:44.597955 (MainThread): Running with dbt=0.19.0
2022-12-15 17:13:45.285720 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 17:13:45.287328 (MainThread): Tracking: tracking
2022-12-15 17:13:45.297109 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2b072e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2b072f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2b072fd0>]}
2022-12-15 17:13:45.328937 (MainThread): Partial parsing not enabled
2022-12-15 17:13:45.330365 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:13:45.340576 (MainThread): Parsing macros/etc.sql
2022-12-15 17:13:45.343392 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:13:45.367695 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:13:45.371394 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:13:45.374916 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:13:45.391231 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:13:45.404054 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:13:45.409921 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:13:45.413258 (MainThread): Parsing macros/core.sql
2022-12-15 17:13:45.418516 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:13:45.471197 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:13:45.472643 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:13:45.483714 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:13:45.485905 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:13:45.488000 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:13:45.489381 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:13:45.492006 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:13:45.494190 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:13:45.496671 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:13:45.500414 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:13:45.502380 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:13:45.513525 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:13:45.521690 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:13:45.524034 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:13:45.531988 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:13:45.549532 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:13:45.551852 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:13:45.574423 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:13:45.612114 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:13:45.637286 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:13:45.644894 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:13:45.658316 (MainThread): Partial parsing not enabled
2022-12-15 17:13:45.718294 (MainThread): Acquiring new bigquery connection "model.timestamp_fraud_complete.stg_raw_fraud".
2022-12-15 17:13:45.934386 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39520b1b-fddd-4bd7-909b-6ad0188c096f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2ae67a20>]}
2022-12-15 17:13:45.972459 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 17:13:45.973602 (MainThread): 
2022-12-15 17:13:45.974103 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:13:45.976622 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 17:13:45.977000 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 17:13:46.139269 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 17:13:46.139683 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 17:13:46.144923 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:13:46.277575 (MainThread): 17:13:46 | Concurrency: 1 threads (target='dev')
2022-12-15 17:13:46.277987 (MainThread): 17:13:46 | 
2022-12-15 17:13:46.281561 (Thread-1): Began running node model.timestamp_fraud_complete.stg_raw_fraud
2022-12-15 17:13:46.283281 (Thread-1): 17:13:46 | 1 of 1 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 17:13:46.283854 (Thread-1): Acquiring new bigquery connection "model.timestamp_fraud_complete.stg_raw_fraud".
2022-12-15 17:13:46.284151 (Thread-1): Compiling model.timestamp_fraud_complete.stg_raw_fraud
2022-12-15 17:13:46.306957 (Thread-1): Writing injected SQL for node "model.timestamp_fraud_complete.stg_raw_fraud"
2022-12-15 17:13:46.308261 (Thread-1): finished collecting timing info
2022-12-15 17:13:46.351903 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 49468), raddr=('142.251.161.95', 443)>
2022-12-15 17:13:46.352339 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 58572), raddr=('74.125.69.95', 443)>
2022-12-15 17:13:46.352633 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 49464), raddr=('142.251.161.95', 443)>
2022-12-15 17:13:46.352882 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 58578), raddr=('74.125.69.95', 443)>
2022-12-15 17:13:46.363416 (Thread-1): Writing runtime SQL for node "model.timestamp_fraud_complete.stg_raw_fraud"
2022-12-15 17:13:46.364599 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:13:46.369747 (Thread-1): On model.timestamp_fraud_complete.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "timestamp_fraud_complete", "target_name": "dev", "node_id": "model.timestamp_fraud_complete.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 17:13:59.640143 (Thread-1): finished collecting timing info
2022-12-15 17:13:59.641192 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39520b1b-fddd-4bd7-909b-6ad0188c096f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2a7334a8>]}
2022-12-15 17:13:59.642584 (Thread-1): 17:13:59 | 1 of 1 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 13.36s]
2022-12-15 17:13:59.642798 (Thread-1): Finished running node model.timestamp_fraud_complete.stg_raw_fraud
2022-12-15 17:13:59.709321 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:13:59.709776 (MainThread): 17:13:59 | 
2022-12-15 17:13:59.709992 (MainThread): 17:13:59 | Finished running 1 table model in 13.74s.
2022-12-15 17:13:59.710151 (MainThread): Connection 'master' was properly closed.
2022-12-15 17:13:59.710241 (MainThread): Connection 'model.timestamp_fraud_complete.stg_raw_fraud' was properly closed.
2022-12-15 17:13:59.746583 (MainThread): 
2022-12-15 17:13:59.746783 (MainThread): Completed successfully
2022-12-15 17:13:59.746974 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-12-15 17:13:59.747270 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2add9e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2aea74e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2af07358>]}
2022-12-15 17:13:59.747549 (MainThread): Flushing usage events
2022-12-15 17:15:41.643385 (MainThread): Running with dbt=0.19.0
2022-12-15 17:15:42.323949 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 17:15:42.325624 (MainThread): Tracking: tracking
2022-12-15 17:15:42.335579 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b1a22d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b1a22f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b1a22f28>]}
2022-12-15 17:15:42.377660 (MainThread): Partial parsing not enabled
2022-12-15 17:15:42.379070 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:15:42.389036 (MainThread): Parsing macros/etc.sql
2022-12-15 17:15:42.391767 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:15:42.415344 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:15:42.419212 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:15:42.422677 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:15:42.438626 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:15:42.450739 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:15:42.456708 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:15:42.459970 (MainThread): Parsing macros/core.sql
2022-12-15 17:15:42.464928 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:15:42.517977 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:15:42.519263 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:15:42.530422 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:15:42.532598 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:15:42.534651 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:15:42.536068 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:15:42.538678 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:15:42.540966 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:15:42.543396 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:15:42.546768 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:15:42.548792 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:15:42.560477 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:15:42.568669 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:15:42.570984 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:15:42.578654 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:15:42.596476 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:15:42.598766 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:15:42.620598 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:15:42.658201 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:15:42.683195 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:15:42.690712 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:15:42.703871 (MainThread): Partial parsing not enabled
2022-12-15 17:15:42.763124 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:15:42.970643 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8488835-e940-4cec-a58c-373346db542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b1808ba8>]}
2022-12-15 17:15:43.008906 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 17:15:43.010012 (MainThread): 
2022-12-15 17:15:43.010543 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:15:43.012955 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 17:15:43.013334 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 17:15:43.174914 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 17:15:43.175338 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 17:15:43.180642 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:15:43.303687 (MainThread): 17:15:43 | Concurrency: 1 threads (target='dev')
2022-12-15 17:15:43.304009 (MainThread): 17:15:43 | 
2022-12-15 17:15:43.306215 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:15:43.307819 (Thread-1): 17:15:43 | 1 of 1 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 17:15:43.308331 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:15:43.308600 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:15:43.329023 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:15:43.329747 (Thread-1): finished collecting timing info
2022-12-15 17:15:43.356630 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:15:43.362184 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:15:43.529739 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 55256), raddr=('108.177.121.95', 443)>
2022-12-15 17:15:43.530122 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44502), raddr=('74.125.70.95', 443)>
2022-12-15 17:15:43.530365 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 55254), raddr=('108.177.121.95', 443)>
2022-12-15 17:15:43.530579 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 50320), raddr=('142.250.148.95', 443)>
2022-12-15 17:15:43.554149 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:15:43.554792 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 17:15:56.451304 (Thread-1): finished collecting timing info
2022-12-15 17:15:56.452396 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8488835-e940-4cec-a58c-373346db542c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b1734128>]}
2022-12-15 17:15:56.453855 (Thread-1): 17:15:56 | 1 of 1 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 13.14s]
2022-12-15 17:15:56.454094 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:15:56.534025 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:15:56.534642 (MainThread): 17:15:56 | 
2022-12-15 17:15:56.534860 (MainThread): 17:15:56 | Finished running 1 table model in 13.52s.
2022-12-15 17:15:56.535052 (MainThread): Connection 'master' was properly closed.
2022-12-15 17:15:56.535175 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-15 17:15:56.572536 (MainThread): 
2022-12-15 17:15:56.572795 (MainThread): Completed successfully
2022-12-15 17:15:56.573011 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-12-15 17:15:56.573316 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b18510f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b179aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b184b6a0>]}
2022-12-15 17:15:56.573613 (MainThread): Flushing usage events
2022-12-15 17:23:57.086487 (MainThread): Running with dbt=0.19.0
2022-12-15 17:23:57.801593 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 17:23:57.803117 (MainThread): Tracking: tracking
2022-12-15 17:23:57.813462 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9784edfe48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9784edffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9784ef61d0>]}
2022-12-15 17:23:57.866947 (MainThread): Partial parsing not enabled
2022-12-15 17:23:57.868383 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:23:57.878883 (MainThread): Parsing macros/etc.sql
2022-12-15 17:23:57.881732 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:23:57.905697 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:23:57.909660 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:23:57.913206 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:23:57.929586 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:23:57.941755 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:23:57.947305 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:23:57.950630 (MainThread): Parsing macros/core.sql
2022-12-15 17:23:57.955530 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:23:58.009556 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:23:58.010972 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:23:58.022710 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:23:58.024956 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:23:58.027070 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:23:58.028500 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:23:58.031115 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:23:58.033337 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:23:58.035793 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:23:58.039204 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:23:58.041274 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:23:58.052649 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:23:58.061824 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:23:58.064246 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:23:58.071912 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:23:58.089386 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:23:58.091736 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:23:58.115080 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:23:58.154461 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:23:58.180970 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:23:58.188772 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:23:58.202271 (MainThread): Partial parsing not enabled
2022-12-15 17:23:58.262147 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:23:58.293098 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:23:58.505135 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83455cb1-ea64-4e77-b41c-1ee6392ddf3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979681f550>]}
2022-12-15 17:23:58.552047 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 17:23:58.553232 (MainThread): 
2022-12-15 17:23:58.553779 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:23:58.558437 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 17:23:58.558770 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 17:23:58.732004 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 17:23:58.732481 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 17:23:58.737866 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:23:58.859743 (MainThread): 17:23:58 | Concurrency: 1 threads (target='dev')
2022-12-15 17:23:58.860651 (MainThread): 17:23:58 | 
2022-12-15 17:23:58.863960 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:23:58.865611 (Thread-1): 17:23:58 | 1 of 2 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 17:23:58.866095 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:23:58.866326 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:23:58.881189 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 46760), raddr=('74.125.69.95', 443)>
2022-12-15 17:23:58.881572 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 59824), raddr=('209.85.146.95', 443)>
2022-12-15 17:23:58.881822 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 57208), raddr=('108.177.112.95', 443)>
2022-12-15 17:23:58.882022 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 59836), raddr=('209.85.146.95', 443)>
2022-12-15 17:23:58.889659 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:23:58.890257 (Thread-1): finished collecting timing info
2022-12-15 17:23:58.917806 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:23:58.923201 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:23:59.093799 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:23:59.094487 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 17:24:12.847746 (Thread-1): finished collecting timing info
2022-12-15 17:24:12.848880 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83455cb1-ea64-4e77-b41c-1ee6392ddf3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9784551470>]}
2022-12-15 17:24:12.850371 (Thread-1): 17:24:12 | 1 of 2 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 13.98s]
2022-12-15 17:24:12.850614 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:24:12.851350 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 17:24:12.853011 (Thread-1): 17:24:12 | 2 of 2 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-15 17:24:12.853527 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:24:12.853767 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 17:24:12.864310 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:24:12.865069 (Thread-1): finished collecting timing info
2022-12-15 17:24:12.871078 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:24:12.871822 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:24:12.877149 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    transactionID,
    step,
    timestamp,
    type,
    amount,
    nameOrig,
    oldbalanceOrg
    newbalanceOrig
    nameDest
    oldbalanceDest
    newbalanceDest
    isFraud,
    isFlaggedFraud
FROM
    fact_raw_fraud
  );
    
2022-12-15 17:24:13.066384 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/b059a00d-69da-414f-85e9-407724031915?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got identifier "nameDest" at [25:5]',)
2022-12-15 17:24:14.269447 (Thread-1): finished collecting timing info
2022-12-15 17:24:14.270660 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Syntax error: Expected ")" but got identifier "nameDest" at [25:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/c57dc23c-1edd-458d-a265-493d08eafe79?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got identifier "nameDest" at [25:5]

(job ID: c57dc23c-1edd-458d-a265-493d08eafe79)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    transactionID,
  18:    step,
  19:    timestamp,
  20:    type,
  21:    amount,
  22:    nameOrig,
  23:    oldbalanceOrg
  24:    newbalanceOrig
  25:    nameDest
  26:    oldbalanceDest
  27:    newbalanceDest
  28:    isFraud,
  29:    isFlaggedFraud
  30:FROM
  31:    fact_raw_fraud
  32:  );
  33:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Syntax error: Expected ")" but got identifier "nameDest" at [25:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-15 17:24:14.277291 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83455cb1-ea64-4e77-b41c-1ee6392ddf3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97844c7630>]}
2022-12-15 17:24:14.278925 (Thread-1): 17:24:14 | 2 of 2 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 1.42s]
2022-12-15 17:24:14.279206 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 17:24:14.297524 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:24:14.298064 (MainThread): 17:24:14 | 
2022-12-15 17:24:14.298255 (MainThread): 17:24:14 | Finished running 2 table models in 15.74s.
2022-12-15 17:24:14.298391 (MainThread): Connection 'master' was properly closed.
2022-12-15 17:24:14.298484 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 17:24:14.339297 (MainThread): 
2022-12-15 17:24:14.339683 (MainThread): Completed with 1 error and 0 warnings:
2022-12-15 17:24:14.339854 (MainThread): 
2022-12-15 17:24:14.339975 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-15 17:24:14.340069 (MainThread):   Syntax error: Expected ")" but got identifier "nameDest" at [25:5]
2022-12-15 17:24:14.340153 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-15 17:24:14.340251 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2022-12-15 17:24:14.340490 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97844b6588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97b6151358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97844f6be0>]}
2022-12-15 17:24:14.340724 (MainThread): Flushing usage events
2022-12-15 17:24:43.031849 (MainThread): Running with dbt=0.19.0
2022-12-15 17:24:43.725205 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 17:24:43.726860 (MainThread): Tracking: tracking
2022-12-15 17:24:43.737478 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1124d69da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1124d69fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1124d69f60>]}
2022-12-15 17:24:43.789374 (MainThread): Partial parsing not enabled
2022-12-15 17:24:43.791308 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:24:43.803001 (MainThread): Parsing macros/etc.sql
2022-12-15 17:24:43.805790 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:24:43.830083 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:24:43.833716 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:24:43.837206 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:24:43.853095 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:24:43.865389 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:24:43.870934 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:24:43.874203 (MainThread): Parsing macros/core.sql
2022-12-15 17:24:43.879111 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:24:43.931784 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:24:43.933155 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:24:43.944357 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:24:43.946542 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:24:43.948617 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:24:43.949973 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:24:43.952578 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:24:43.954743 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:24:43.957172 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:24:43.960554 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:24:43.962484 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:24:43.973917 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:24:43.982173 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:24:43.984542 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:24:43.992296 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:24:44.009357 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:24:44.011827 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:24:44.034154 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:24:44.072358 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:24:44.098094 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:24:44.107045 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:24:44.120709 (MainThread): Partial parsing not enabled
2022-12-15 17:24:44.179780 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:24:44.210686 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:24:44.414774 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32b19649-c151-4e11-86af-3577cd678af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11366da518>]}
2022-12-15 17:24:44.460120 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 17:24:44.461263 (MainThread): 
2022-12-15 17:24:44.461844 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:24:44.466296 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 17:24:44.466695 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 17:24:44.626072 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 17:24:44.626419 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 17:24:44.632845 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:24:44.759343 (MainThread): 17:24:44 | Concurrency: 1 threads (target='dev')
2022-12-15 17:24:44.760153 (MainThread): 17:24:44 | 
2022-12-15 17:24:44.762743 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:24:44.764351 (Thread-1): 17:24:44 | 1 of 2 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 17:24:44.764926 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:24:44.765210 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:24:44.780528 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 42134), raddr=('108.177.112.95', 443)>
2022-12-15 17:24:44.780874 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 46090), raddr=('209.85.146.95', 443)>
2022-12-15 17:24:44.781158 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 42148), raddr=('108.177.112.95', 443)>
2022-12-15 17:24:44.781409 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 46106), raddr=('209.85.146.95', 443)>
2022-12-15 17:24:44.790589 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:24:44.791251 (Thread-1): finished collecting timing info
2022-12-15 17:24:44.818179 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:24:44.823515 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:24:44.992934 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:24:44.993584 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 17:24:58.987553 (Thread-1): finished collecting timing info
2022-12-15 17:24:58.988597 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32b19649-c151-4e11-86af-3577cd678af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11243e8160>]}
2022-12-15 17:24:58.990039 (Thread-1): 17:24:58 | 1 of 2 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 14.22s]
2022-12-15 17:24:58.990272 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:24:58.990989 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 17:24:58.992943 (Thread-1): 17:24:58 | 2 of 2 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-15 17:24:58.993367 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:24:58.993531 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 17:24:59.004266 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:24:59.004729 (Thread-1): finished collecting timing info
2022-12-15 17:24:59.010818 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:24:59.011286 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:24:59.016396 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    transactionID,
    step,
    timestamp,
    type,
    amount,
    nameOrig,
    oldbalanceOrg,
    newbalanceOrig,
    nameDest,
    oldbalanceDest,
    newbalanceDest,
    isFraud,
    isFlaggedFraud
FROM
    fact_raw_fraud
  );
    
2022-12-15 17:25:09.046264 (Thread-1): finished collecting timing info
2022-12-15 17:25:09.047338 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32b19649-c151-4e11-86af-3577cd678af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1124392b70>]}
2022-12-15 17:25:09.049088 (Thread-1): 17:25:09 | 2 of 2 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 694.1 MB processed) in 10.05s]
2022-12-15 17:25:09.049310 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 17:25:09.121562 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:25:09.122274 (MainThread): 17:25:09 | 
2022-12-15 17:25:09.122517 (MainThread): 17:25:09 | Finished running 2 table models in 24.66s.
2022-12-15 17:25:09.122729 (MainThread): Connection 'master' was properly closed.
2022-12-15 17:25:09.122869 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 17:25:09.164455 (MainThread): 
2022-12-15 17:25:09.164747 (MainThread): Completed successfully
2022-12-15 17:25:09.164993 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-12-15 17:25:09.165364 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1124bf3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1124a7b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1124d3f6d8>]}
2022-12-15 17:25:09.165724 (MainThread): Flushing usage events
2022-12-15 17:35:16.064826 (MainThread): Running with dbt=0.19.0
2022-12-15 17:35:16.753002 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 17:35:16.754568 (MainThread): Tracking: tracking
2022-12-15 17:35:16.764312 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0d781e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0d781fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0d7961d0>]}
2022-12-15 17:35:16.796156 (MainThread): Partial parsing not enabled
2022-12-15 17:35:16.797267 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 17:35:16.798814 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:35:16.808570 (MainThread): Parsing macros/etc.sql
2022-12-15 17:35:16.811274 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:35:16.835032 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:35:16.838605 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:35:16.842064 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:35:16.857773 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:35:16.869730 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:35:16.875155 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:35:16.878433 (MainThread): Parsing macros/core.sql
2022-12-15 17:35:16.883263 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:35:16.935533 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:35:16.936937 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:35:16.948004 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:35:16.950181 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:35:16.952251 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:35:16.953615 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:35:16.956196 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:35:16.958442 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:35:16.960849 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:35:16.964284 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:35:16.966272 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:35:16.977382 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:35:16.985529 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:35:16.987876 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:35:16.995634 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:35:17.012516 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:35:17.014813 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:35:17.036382 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:35:17.073925 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:35:17.099493 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:35:17.107334 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:35:17.120787 (MainThread): Partial parsing not enabled
2022-12-15 17:35:17.179503 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:35:17.210149 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:35:17.409150 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbdaf6ee-4d4a-4ce2-a69d-b6a8a63dfa24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0d4a62b0>]}
2022-12-15 17:35:17.452178 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 17:35:17.453368 (MainThread): 
2022-12-15 17:35:17.453903 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:35:17.458124 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 17:35:17.458481 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 17:35:17.628818 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 17:35:17.629223 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 17:35:17.634744 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:35:17.754535 (MainThread): 17:35:17 | Concurrency: 1 threads (target='dev')
2022-12-15 17:35:17.754852 (MainThread): 17:35:17 | 
2022-12-15 17:35:17.757178 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:35:17.758722 (Thread-1): 17:35:17 | 1 of 2 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 17:35:17.759412 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:35:17.759597 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:35:17.774618 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 53766), raddr=('172.217.219.95', 443)>
2022-12-15 17:35:17.774871 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 41828), raddr=('142.250.128.95', 443)>
2022-12-15 17:35:17.775098 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 50534), raddr=('108.177.121.95', 443)>
2022-12-15 17:35:17.775248 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 41840), raddr=('142.250.128.95', 443)>
2022-12-15 17:35:17.783486 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:35:17.783919 (Thread-1): finished collecting timing info
2022-12-15 17:35:17.810017 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:35:17.815247 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:35:17.986988 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:35:17.987672 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 17:35:32.359892 (Thread-1): finished collecting timing info
2022-12-15 17:35:32.361012 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbdaf6ee-4d4a-4ce2-a69d-b6a8a63dfa24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0cdeada0>]}
2022-12-15 17:35:32.362906 (Thread-1): 17:35:32 | 1 of 2 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 14.60s]
2022-12-15 17:35:32.363159 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:35:32.363723 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 17:35:32.365008 (Thread-1): 17:35:32 | 2 of 2 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-15 17:35:32.365423 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:35:32.365610 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 17:35:32.375542 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:35:32.376041 (Thread-1): finished collecting timing info
2022-12-15 17:35:32.381934 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:35:32.387331 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:35:32.516620 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:35:32.517322 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    transactionID,
    step,
    timestamp,
    type,
    amount,
    nameOrig,
    oldbalanceOrg,
    newbalanceOrig,
    nameDest,
    oldbalanceDest,
    newbalanceDest,
    isFraud,
    isFlaggedFraud
FROM
    fact_raw_fraud
  );
    
2022-12-15 17:35:43.868358 (Thread-1): finished collecting timing info
2022-12-15 17:35:43.869406 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbdaf6ee-4d4a-4ce2-a69d-b6a8a63dfa24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0cdea2e8>]}
2022-12-15 17:35:43.870825 (Thread-1): 17:35:43 | 2 of 2 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 694.1 MB processed) in 11.50s]
2022-12-15 17:35:43.871063 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 17:35:43.912003 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:35:43.912429 (MainThread): 17:35:43 | 
2022-12-15 17:35:43.912594 (MainThread): 17:35:43 | Finished running 2 table models in 26.46s.
2022-12-15 17:35:43.912712 (MainThread): Connection 'master' was properly closed.
2022-12-15 17:35:43.912788 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 17:35:43.952338 (MainThread): 
2022-12-15 17:35:43.952530 (MainThread): Completed successfully
2022-12-15 17:35:43.952661 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-12-15 17:35:43.952948 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0d755160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0d617438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0d4a69b0>]}
2022-12-15 17:35:43.953267 (MainThread): Flushing usage events
2022-12-15 17:37:01.721422 (MainThread): Running with dbt=0.19.0
2022-12-15 17:37:02.396660 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-15 17:37:02.398139 (MainThread): Tracking: tracking
2022-12-15 17:37:02.408674 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f04a0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f04a0f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f04a0fd0>]}
2022-12-15 17:37:02.450043 (MainThread): Partial parsing not enabled
2022-12-15 17:37:02.451133 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 17:37:02.452675 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:37:02.462310 (MainThread): Parsing macros/etc.sql
2022-12-15 17:37:02.465039 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:37:02.489207 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:37:02.492839 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:37:02.496331 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:37:02.512031 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:37:02.524793 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:37:02.530213 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:37:02.533533 (MainThread): Parsing macros/core.sql
2022-12-15 17:37:02.538475 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:37:02.591560 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:37:02.592970 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:37:02.603966 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:37:02.606170 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:37:02.608322 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:37:02.609749 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:37:02.612492 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:37:02.614858 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:37:02.617390 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:37:02.621489 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:37:02.623597 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:37:02.634946 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:37:02.643250 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:37:02.645685 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:37:02.653375 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:37:02.670374 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:37:02.672725 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:37:02.694973 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:37:02.732608 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:37:02.757918 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:37:02.765825 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:37:02.779102 (MainThread): Partial parsing not enabled
2022-12-15 17:37:02.839079 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:37:02.869562 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:37:03.068496 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32f247c8-b1f3-41ad-82bc-5439ee20ac23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f01b6e48>]}
2022-12-15 17:37:03.109972 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 17:37:03.111191 (MainThread): 
2022-12-15 17:37:03.111753 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:37:03.115543 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 17:37:03.115855 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 17:37:03.122553 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:37:03.261330 (MainThread): 17:37:03 | Concurrency: 1 threads (target='dev')
2022-12-15 17:37:03.261631 (MainThread): 17:37:03 | 
2022-12-15 17:37:03.264153 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:37:03.264874 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:37:03.265207 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:37:03.285381 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 40102), raddr=('108.177.121.95', 443)>
2022-12-15 17:37:03.285769 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 44722), raddr=('142.250.128.95', 443)>
2022-12-15 17:37:03.288786 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:37:03.289403 (Thread-1): finished collecting timing info
2022-12-15 17:37:03.289991 (Thread-1): finished collecting timing info
2022-12-15 17:37:03.290649 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:37:03.291247 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 17:37:03.291740 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:37:03.291979 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 17:37:03.301911 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:37:03.302471 (Thread-1): finished collecting timing info
2022-12-15 17:37:03.302857 (Thread-1): finished collecting timing info
2022-12-15 17:37:03.303482 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 17:37:03.364028 (MainThread): Connection 'master' was properly closed.
2022-12-15 17:37:03.364254 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 17:37:03.410628 (MainThread): 17:37:03 | Done.
2022-12-15 17:37:03.410992 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f01ad6d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f0248f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6f0473908>]}
2022-12-15 17:37:03.411260 (MainThread): Flushing usage events
2022-12-15 17:39:25.721946 (MainThread): Running with dbt=0.19.0
2022-12-15 17:39:26.425008 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-15 17:39:26.426541 (MainThread): Tracking: tracking
2022-12-15 17:39:26.436701 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e784b9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e784b9f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e784b9fd0>]}
2022-12-15 17:39:26.489869 (MainThread): Partial parsing not enabled
2022-12-15 17:39:26.491468 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 17:39:26.493814 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:39:26.504877 (MainThread): Parsing macros/etc.sql
2022-12-15 17:39:26.508089 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:39:26.532173 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:39:26.535884 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:39:26.539366 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:39:26.555406 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:39:26.567798 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:39:26.573198 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:39:26.576514 (MainThread): Parsing macros/core.sql
2022-12-15 17:39:26.581575 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:39:26.634834 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:39:26.636277 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:39:26.647696 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:39:26.649954 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:39:26.652057 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:39:26.653453 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:39:26.656086 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:39:26.658449 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:39:26.660882 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:39:26.664416 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:39:26.666446 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:39:26.677629 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:39:26.685854 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:39:26.688218 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:39:26.695850 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:39:26.713358 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:39:26.715666 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:39:26.737561 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:39:26.775688 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:39:26.801916 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:39:26.809646 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:39:26.823066 (MainThread): Partial parsing not enabled
2022-12-15 17:39:26.881579 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:39:26.912204 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:39:27.118075 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b294a96-ecb4-414a-b0a8-84669f3c6504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e781c74e0>]}
2022-12-15 17:39:27.159731 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 17:39:27.160916 (MainThread): 
2022-12-15 17:39:27.161449 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:39:27.165196 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 17:39:27.165527 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 17:39:27.171298 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:39:27.308568 (MainThread): 17:39:27 | Concurrency: 1 threads (target='dev')
2022-12-15 17:39:27.308852 (MainThread): 17:39:27 | 
2022-12-15 17:39:27.311790 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:39:27.312364 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:39:27.312641 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:39:27.337743 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 41496), raddr=('108.177.121.95', 443)>
2022-12-15 17:39:27.338139 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 34892), raddr=('142.250.128.95', 443)>
2022-12-15 17:39:27.340741 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:39:27.341360 (Thread-1): finished collecting timing info
2022-12-15 17:39:27.341863 (Thread-1): finished collecting timing info
2022-12-15 17:39:27.342520 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:39:27.343135 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 17:39:27.343593 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:39:27.343814 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 17:39:27.354032 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:39:27.354612 (Thread-1): finished collecting timing info
2022-12-15 17:39:27.355050 (Thread-1): finished collecting timing info
2022-12-15 17:39:27.355678 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 17:39:27.411671 (MainThread): Connection 'master' was properly closed.
2022-12-15 17:39:27.411912 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 17:39:27.452706 (MainThread): 17:39:27 | Done.
2022-12-15 17:39:27.453091 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e781cdb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e781cdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7834e2e8>]}
2022-12-15 17:39:27.453409 (MainThread): Flushing usage events
2022-12-15 17:39:34.240398 (MainThread): Running with dbt=0.19.0
2022-12-15 17:39:34.931605 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 17:39:34.933044 (MainThread): Tracking: tracking
2022-12-15 17:39:34.942759 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80712b9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80712b9f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80712b9fd0>]}
2022-12-15 17:39:34.978130 (MainThread): Partial parsing not enabled
2022-12-15 17:39:34.979172 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 17:39:34.980669 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:39:34.990394 (MainThread): Parsing macros/etc.sql
2022-12-15 17:39:34.993208 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:39:35.017217 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:39:35.020838 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:39:35.024307 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:39:35.040065 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:39:35.052127 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:39:35.057576 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:39:35.060870 (MainThread): Parsing macros/core.sql
2022-12-15 17:39:35.065719 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:39:35.119231 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:39:35.120686 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:39:35.132170 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:39:35.134348 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:39:35.136444 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:39:35.137851 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:39:35.140469 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:39:35.142712 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:39:35.145157 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:39:35.148579 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:39:35.150615 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:39:35.162113 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:39:35.170416 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:39:35.172758 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:39:35.180408 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:39:35.197341 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:39:35.199644 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:39:35.221593 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:39:35.259699 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:39:35.285438 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:39:35.293170 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:39:35.306759 (MainThread): Partial parsing not enabled
2022-12-15 17:39:35.365777 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:39:35.397212 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:39:35.603907 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac2baf1a-ecf5-4779-b77a-aad27c0bb685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8070fc7518>]}
2022-12-15 17:39:35.644790 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 17:39:35.646069 (MainThread): 
2022-12-15 17:39:35.646578 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:39:35.650866 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 17:39:35.651231 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 17:39:35.823898 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 17:39:35.824256 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 17:39:35.830230 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:39:35.960539 (MainThread): 17:39:35 | Concurrency: 1 threads (target='dev')
2022-12-15 17:39:35.960856 (MainThread): 17:39:35 | 
2022-12-15 17:39:35.963395 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:39:35.964952 (Thread-1): 17:39:35 | 1 of 2 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 17:39:35.965440 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:39:35.965660 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:39:35.980121 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 41508), raddr=('108.177.121.95', 443)>
2022-12-15 17:39:35.980460 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 34906), raddr=('142.250.128.95', 443)>
2022-12-15 17:39:35.980710 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 41522), raddr=('108.177.121.95', 443)>
2022-12-15 17:39:35.980949 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 34914), raddr=('142.250.128.95', 443)>
2022-12-15 17:39:35.988562 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:39:35.989127 (Thread-1): finished collecting timing info
2022-12-15 17:39:36.015715 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:39:36.021106 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:39:36.199944 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:39:36.200763 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 17:39:49.057370 (Thread-1): finished collecting timing info
2022-12-15 17:39:49.058912 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2baf1a-ecf5-4779-b77a-aad27c0bb685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8071020b00>]}
2022-12-15 17:39:49.060403 (Thread-1): 17:39:49 | 1 of 2 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 13.09s]
2022-12-15 17:39:49.060636 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:39:49.061298 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 17:39:49.062557 (Thread-1): 17:39:49 | 2 of 2 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-15 17:39:49.063018 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:39:49.063200 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 17:39:49.073046 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:39:49.073512 (Thread-1): finished collecting timing info
2022-12-15 17:39:49.078762 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:39:49.083955 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:39:49.241098 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:39:49.241763 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    transactionID,
    step,
    timestamp,
    type,
    amount,
    nameOrig,
    oldbalanceOrg,
    newbalanceOrig,
    nameDest,
    oldbalanceDest,
    newbalanceDest,
    isFraud,
    isFlaggedFraud
FROM
    fact_raw_fraud
  );
    
2022-12-15 17:40:01.371415 (Thread-1): finished collecting timing info
2022-12-15 17:40:01.372482 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2baf1a-ecf5-4779-b77a-aad27c0bb685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8070932ef0>]}
2022-12-15 17:40:01.373930 (Thread-1): 17:40:01 | 2 of 2 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 694.1 MB processed) in 12.31s]
2022-12-15 17:40:01.374150 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 17:40:01.419514 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:40:01.420250 (MainThread): 17:40:01 | 
2022-12-15 17:40:01.420479 (MainThread): 17:40:01 | Finished running 2 table models in 25.77s.
2022-12-15 17:40:01.420670 (MainThread): Connection 'master' was properly closed.
2022-12-15 17:40:01.420787 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 17:40:01.461591 (MainThread): 
2022-12-15 17:40:01.461845 (MainThread): Completed successfully
2022-12-15 17:40:01.462054 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-12-15 17:40:01.462344 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f807114d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80710f3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8070fc2eb8>]}
2022-12-15 17:40:01.462634 (MainThread): Flushing usage events
2022-12-15 17:44:56.232643 (MainThread): Running with dbt=0.19.0
2022-12-15 17:44:56.939820 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-15 17:44:56.941399 (MainThread): Tracking: tracking
2022-12-15 17:44:56.952138 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2c11de48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2c11dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2c1321d0>]}
2022-12-15 17:44:57.004773 (MainThread): Partial parsing not enabled
2022-12-15 17:44:57.006391 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 17:44:57.008868 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:44:57.020200 (MainThread): Parsing macros/etc.sql
2022-12-15 17:44:57.023007 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:44:57.047863 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:44:57.051500 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:44:57.054984 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:44:57.071535 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:44:57.083882 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:44:57.089385 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:44:57.092724 (MainThread): Parsing macros/core.sql
2022-12-15 17:44:57.097655 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:44:57.151751 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:44:57.153135 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:44:57.164708 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:44:57.167148 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:44:57.169259 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:44:57.170637 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:44:57.173248 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:44:57.175445 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:44:57.177835 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:44:57.181240 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:44:57.183437 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:44:57.195635 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:44:57.204046 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:44:57.206421 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:44:57.214506 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:44:57.231711 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:44:57.234141 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:44:57.257346 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:44:57.296199 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:44:57.322230 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:44:57.330090 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:44:57.343892 (MainThread): Partial parsing not enabled
2022-12-15 17:44:57.405420 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:44:57.420565 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2bf9b748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2bfb3358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2bfb3390>]}
2022-12-15 17:44:57.421032 (MainThread): Flushing usage events
2022-12-15 17:44:57.607421 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-15 17:44:57.608109 (MainThread): Encountered an error:
2022-12-15 17:44:57.608393 (MainThread): Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  macro 'dbt_macro__decode_isFraud' takes not more than 1 argument(s)
  
  > in macro decode_isFraud (macros/decode_isFraud.sql)
  > called by model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-15 17:44:57.614714 (MainThread): Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 672, in __call__
    % (self.name, len(self.arguments))
TypeError: macro 'dbt_macro__decode_isFraud' takes not more than 1 argument(s)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  macro 'dbt_macro__decode_isFraud' takes not more than 1 argument(s)
  
  > in macro decode_isFraud (macros/decode_isFraud.sql)
  > called by model stg_raw_fraud (models/staging/stg_raw_fraud.sql)

2022-12-15 17:45:49.357117 (MainThread): Running with dbt=0.19.0
2022-12-15 17:45:50.046422 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-15 17:45:50.047970 (MainThread): Tracking: tracking
2022-12-15 17:45:50.058275 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55eca1f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55eca1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55ecb61d0>]}
2022-12-15 17:45:50.110030 (MainThread): Partial parsing not enabled
2022-12-15 17:45:50.111465 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 17:45:50.113673 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:45:50.124635 (MainThread): Parsing macros/etc.sql
2022-12-15 17:45:50.127266 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:45:50.150822 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:45:50.154395 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:45:50.158053 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:45:50.174497 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:45:50.186733 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:45:50.192189 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:45:50.195463 (MainThread): Parsing macros/core.sql
2022-12-15 17:45:50.200351 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:45:50.253319 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:45:50.254686 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:45:50.265857 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:45:50.268224 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:45:50.270717 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:45:50.272168 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:45:50.274719 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:45:50.276919 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:45:50.279309 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:45:50.282680 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:45:50.284709 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:45:50.295912 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:45:50.304237 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:45:50.306623 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:45:50.314285 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:45:50.331274 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:45:50.333509 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:45:50.355779 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:45:50.395504 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:45:50.421303 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:45:50.429176 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:45:50.442837 (MainThread): Partial parsing not enabled
2022-12-15 17:45:50.501997 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:45:50.514087 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55eb1c6d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55eb35320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55eb35358>]}
2022-12-15 17:45:50.514412 (MainThread): Flushing usage events
2022-12-15 17:45:50.656402 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-15 17:45:50.657177 (MainThread): Encountered an error:
2022-12-15 17:45:50.657573 (MainThread): Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  macro 'dbt_macro__decode_isFraud' takes not more than 1 argument(s)
  
  > in macro decode_isFraud (macros/decode_isFraud.sql)
  > called by model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-15 17:45:50.661550 (MainThread): Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 672, in __call__
    % (self.name, len(self.arguments))
TypeError: macro 'dbt_macro__decode_isFraud' takes not more than 1 argument(s)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  macro 'dbt_macro__decode_isFraud' takes not more than 1 argument(s)
  
  > in macro decode_isFraud (macros/decode_isFraud.sql)
  > called by model stg_raw_fraud (models/staging/stg_raw_fraud.sql)

2022-12-15 17:58:30.226470 (MainThread): Running with dbt=0.19.0
2022-12-15 17:58:31.085411 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 17:58:31.086462 (MainThread): Tracking: tracking
2022-12-15 17:58:31.096609 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2dfcbe48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2dfcbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2dfcbfd0>]}
2022-12-15 17:58:31.139991 (MainThread): Partial parsing not enabled
2022-12-15 17:58:31.141582 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 17:58:31.143392 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:58:31.153747 (MainThread): Parsing macros/etc.sql
2022-12-15 17:58:31.156540 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:58:31.181412 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:58:31.185220 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:58:31.188919 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:58:31.205608 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:58:31.218187 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:58:31.223737 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:58:31.227188 (MainThread): Parsing macros/core.sql
2022-12-15 17:58:31.232306 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:58:31.287119 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:58:31.288612 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:58:31.300277 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:58:31.302555 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:58:31.304716 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:58:31.306136 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:58:31.308789 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:58:31.311023 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:58:31.313676 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:58:31.317715 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:58:31.320040 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:58:31.331520 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:58:31.340030 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:58:31.342744 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:58:31.351252 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:58:31.369178 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:58:31.371705 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:58:31.395006 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:58:31.434365 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:58:31.459998 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:58:31.467944 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:58:31.482681 (MainThread): Partial parsing not enabled
2022-12-15 17:58:31.549711 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:58:31.563228 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2de486d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2de612b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2de612e8>]}
2022-12-15 17:58:31.563672 (MainThread): Flushing usage events
2022-12-15 17:58:31.769764 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-15 17:58:31.770441 (MainThread): Encountered an error:
2022-12-15 17:58:31.770767 (MainThread): Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  macro 'dbt_macro__decode_isFraud' takes not more than 1 argument(s)
  
  > in macro decode_isFraud (macros/decode_isFraud.sql)
  > called by model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-15 17:58:31.774094 (MainThread): Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 672, in __call__
    % (self.name, len(self.arguments))
TypeError: macro 'dbt_macro__decode_isFraud' takes not more than 1 argument(s)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/parser/base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 4, in top-level template code
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  macro 'dbt_macro__decode_isFraud' takes not more than 1 argument(s)
  
  > in macro decode_isFraud (macros/decode_isFraud.sql)
  > called by model stg_raw_fraud (models/staging/stg_raw_fraud.sql)

2022-12-15 17:58:54.949939 (MainThread): Running with dbt=0.19.0
2022-12-15 17:58:55.620384 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 17:58:55.621658 (MainThread): Tracking: tracking
2022-12-15 17:58:55.630600 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f43ffdda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f43ffdf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f43ffdf60>]}
2022-12-15 17:58:55.682680 (MainThread): Partial parsing not enabled
2022-12-15 17:58:55.684165 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 17:58:55.686467 (MainThread): Parsing macros/catalog.sql
2022-12-15 17:58:55.698552 (MainThread): Parsing macros/etc.sql
2022-12-15 17:58:55.701305 (MainThread): Parsing macros/adapters.sql
2022-12-15 17:58:55.725028 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 17:58:55.728779 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 17:58:55.732246 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 17:58:55.748509 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 17:58:55.760435 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 17:58:55.765845 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 17:58:55.769126 (MainThread): Parsing macros/core.sql
2022-12-15 17:58:55.773969 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 17:58:55.827717 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 17:58:55.829100 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 17:58:55.840612 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 17:58:55.842806 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 17:58:55.844908 (MainThread): Parsing macros/etc/query.sql
2022-12-15 17:58:55.846310 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 17:58:55.848967 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 17:58:55.851237 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 17:58:55.853718 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 17:58:55.857293 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 17:58:55.859854 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 17:58:55.871328 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 17:58:55.879555 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 17:58:55.882006 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 17:58:55.889765 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 17:58:55.907327 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 17:58:55.909611 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 17:58:55.931486 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 17:58:55.968872 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 17:58:55.994746 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 17:58:56.002598 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 17:58:56.015998 (MainThread): Partial parsing not enabled
2022-12-15 17:58:56.074533 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:58:56.105090 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:58:56.321964 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c983e24-eb9e-4948-882d-f284a93dd245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f43d09518>]}
2022-12-15 17:58:56.370140 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 17:58:56.371446 (MainThread): 
2022-12-15 17:58:56.371968 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:58:56.376153 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 17:58:56.376495 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 17:58:56.556230 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 17:58:56.556722 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 17:58:56.562068 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:58:56.689266 (MainThread): 17:58:56 | Concurrency: 1 threads (target='dev')
2022-12-15 17:58:56.689626 (MainThread): 17:58:56 | 
2022-12-15 17:58:56.692684 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:58:56.694713 (Thread-1): 17:58:56 | 1 of 2 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 17:58:56.695340 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 17:58:56.695816 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:58:56.711366 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 50440), raddr=('172.253.114.95', 443)>
2022-12-15 17:58:56.711788 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 47470), raddr=('108.177.112.95', 443)>
2022-12-15 17:58:56.712142 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 50450), raddr=('172.253.114.95', 443)>
2022-12-15 17:58:56.712396 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 54736), raddr=('108.177.112.95', 443)>
2022-12-15 17:58:56.721150 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:58:56.721874 (Thread-1): finished collecting timing info
2022-12-15 17:58:56.752113 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:58:56.757475 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:58:56.916122 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 17:58:56.916772 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT * FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 17:59:08.822060 (Thread-1): finished collecting timing info
2022-12-15 17:59:08.823201 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c983e24-eb9e-4948-882d-f284a93dd245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f43d63b00>]}
2022-12-15 17:59:08.824918 (Thread-1): 17:59:08 | 1 of 2 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 12.13s]
2022-12-15 17:59:08.825235 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 17:59:08.825881 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 17:59:08.827288 (Thread-1): 17:59:08 | 2 of 2 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-15 17:59:08.827861 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 17:59:08.828099 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 17:59:08.838269 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:59:08.838819 (Thread-1): finished collecting timing info
2022-12-15 17:59:08.844282 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 17:59:08.849528 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 17:59:08.998014 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 17:59:08.998841 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    transactionID as transaction_Id,
    step,
    timestamp,
    type,
    amount,
    nameOrig,
    oldbalanceOrg,
    newbalanceOrig,
    nameDest,
    oldbalanceDest,
    newbalanceDest,
    isFraud,
    isFlaggedFraud
FROM
    fact_raw_fraud
  );
    
2022-12-15 17:59:20.884123 (Thread-1): finished collecting timing info
2022-12-15 17:59:20.885196 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c983e24-eb9e-4948-882d-f284a93dd245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f4367cfd0>]}
2022-12-15 17:59:20.886615 (Thread-1): 17:59:20 | 2 of 2 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 694.1 MB processed) in 12.06s]
2022-12-15 17:59:20.886867 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 17:59:20.948503 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 17:59:20.949067 (MainThread): 17:59:20 | 
2022-12-15 17:59:20.949279 (MainThread): 17:59:20 | Finished running 2 table models in 24.58s.
2022-12-15 17:59:20.949442 (MainThread): Connection 'master' was properly closed.
2022-12-15 17:59:20.949545 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 17:59:20.990123 (MainThread): 
2022-12-15 17:59:20.990330 (MainThread): Completed successfully
2022-12-15 17:59:20.990458 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-12-15 17:59:20.990665 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f43e93320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f43fd1f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f43d15898>]}
2022-12-15 17:59:20.990881 (MainThread): Flushing usage events
2022-12-15 18:12:27.918404 (MainThread): Running with dbt=0.19.0
2022-12-15 18:12:28.606865 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 18:12:28.608415 (MainThread): Tracking: tracking
2022-12-15 18:12:28.617853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ceb3ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ceb3af98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ceb3afd0>]}
2022-12-15 18:12:28.648264 (MainThread): Partial parsing not enabled
2022-12-15 18:12:28.649433 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 18:12:28.651051 (MainThread): Parsing macros/catalog.sql
2022-12-15 18:12:28.660765 (MainThread): Parsing macros/etc.sql
2022-12-15 18:12:28.663517 (MainThread): Parsing macros/adapters.sql
2022-12-15 18:12:28.687215 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 18:12:28.691158 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 18:12:28.694784 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 18:12:28.710602 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 18:12:28.722615 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 18:12:28.728037 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 18:12:28.731236 (MainThread): Parsing macros/core.sql
2022-12-15 18:12:28.736126 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 18:12:28.788427 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 18:12:28.790036 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 18:12:28.801534 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 18:12:28.803842 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 18:12:28.805945 (MainThread): Parsing macros/etc/query.sql
2022-12-15 18:12:28.807417 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 18:12:28.810350 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 18:12:28.812620 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 18:12:28.815068 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 18:12:28.818527 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 18:12:28.820583 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 18:12:28.831886 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 18:12:28.840125 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 18:12:28.842557 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 18:12:28.850472 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 18:12:28.867798 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 18:12:28.870156 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 18:12:28.892984 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 18:12:28.930610 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 18:12:28.956085 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 18:12:28.963884 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 18:12:28.977261 (MainThread): Partial parsing not enabled
2022-12-15 18:12:29.036244 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:12:29.066856 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:12:29.272419 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '128d249a-79b1-4030-b232-19caa7b69e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ce847518>]}
2022-12-15 18:12:29.313617 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 18:12:29.314728 (MainThread): 
2022-12-15 18:12:29.315231 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:12:29.319459 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 18:12:29.319827 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 18:12:29.487104 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 18:12:29.487489 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 18:12:29.493068 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:12:29.612319 (MainThread): 18:12:29 | Concurrency: 1 threads (target='dev')
2022-12-15 18:12:29.612647 (MainThread): 18:12:29 | 
2022-12-15 18:12:29.615129 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:12:29.616639 (Thread-1): 18:12:29 | 1 of 2 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 18:12:29.617207 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:12:29.617433 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:12:29.631768 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 49596), raddr=('172.217.212.95', 443)>
2022-12-15 18:12:29.632048 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 39810), raddr=('173.194.194.95', 443)>
2022-12-15 18:12:29.632290 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 35144), raddr=('64.233.191.95', 443)>
2022-12-15 18:12:29.632485 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 39822), raddr=('173.194.194.95', 443)>
2022-12-15 18:12:29.640436 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:12:29.641243 (Thread-1): finished collecting timing info
2022-12-15 18:12:29.667885 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:12:29.673137 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:12:29.842678 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:12:29.843471 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender.
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    isFraud as is_fraud,
    isFlaggedFraud as is_flagged_fraud
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 18:12:30.025395 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/2acf7d56-cf60-4050-80c0-8b2b7138362f?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got "." at [20:41]',)
2022-12-15 18:12:30.802413 (Thread-1): finished collecting timing info
2022-12-15 18:12:30.803293 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Expected ")" but got "." at [20:41]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/1194a948-4c70-4206-a087-1bd0c217a4c0?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got "." at [20:41]

(job ID: 1194a948-4c70-4206-a087-1bd0c217a4c0)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    amount,
  18:    nameOrig as name_sender,
  19:    oldbalanceOrg as old_balance_sender,
  20:    newbalanceOrig as new_balance_sender.
  21:    nameDest as name_recipient,
  22:    oldbalanceDest as old_balance_recipient,
  23:    newbalanceDest as new_balance_recipient,
  24:    isFraud as is_fraud,
  25:    isFlaggedFraud as is_flagged_fraud
  26:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  27:ORDER BY timestamp, step
  28:  );
  29:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Expected ")" but got "." at [20:41]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-15 18:12:30.809430 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128d249a-79b1-4030-b232-19caa7b69e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ce1a00f0>]}
2022-12-15 18:12:30.811055 (Thread-1): 18:12:30 | 1 of 2 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 1.19s]
2022-12-15 18:12:30.811288 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:12:30.812024 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 18:12:30.812266 (Thread-1): 18:12:30 | 2 of 2 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-15 18:12:30.812452 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 18:12:30.817730 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:12:30.818137 (MainThread): 18:12:30 | 
2022-12-15 18:12:30.818760 (MainThread): 18:12:30 | Finished running 2 table models in 1.50s.
2022-12-15 18:12:30.819191 (MainThread): Connection 'master' was properly closed.
2022-12-15 18:12:30.819337 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-15 18:12:30.859806 (MainThread): 
2022-12-15 18:12:30.860046 (MainThread): Completed with 1 error and 0 warnings:
2022-12-15 18:12:30.860181 (MainThread): 
2022-12-15 18:12:30.860295 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-15 18:12:30.860461 (MainThread):   Syntax error: Expected ")" but got "." at [20:41]
2022-12-15 18:12:30.860627 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-15 18:12:30.860816 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2022-12-15 18:12:30.861163 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ce9896a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50e047f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ce8a1b00>]}
2022-12-15 18:12:30.861471 (MainThread): Flushing usage events
2022-12-15 18:13:40.350757 (MainThread): Running with dbt=0.19.0
2022-12-15 18:13:41.017770 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 18:13:41.019196 (MainThread): Tracking: tracking
2022-12-15 18:13:41.027234 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d75e9e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d75e9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d75fe1d0>]}
2022-12-15 18:13:41.057843 (MainThread): Partial parsing not enabled
2022-12-15 18:13:41.058937 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 18:13:41.060502 (MainThread): Parsing macros/catalog.sql
2022-12-15 18:13:41.070211 (MainThread): Parsing macros/etc.sql
2022-12-15 18:13:41.072965 (MainThread): Parsing macros/adapters.sql
2022-12-15 18:13:41.096401 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 18:13:41.100094 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 18:13:41.103841 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 18:13:41.119767 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 18:13:41.131784 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 18:13:41.137790 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 18:13:41.141077 (MainThread): Parsing macros/core.sql
2022-12-15 18:13:41.145974 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 18:13:41.199715 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 18:13:41.201116 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 18:13:41.212349 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 18:13:41.214636 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 18:13:41.216810 (MainThread): Parsing macros/etc/query.sql
2022-12-15 18:13:41.218268 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 18:13:41.221017 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 18:13:41.223255 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 18:13:41.225688 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 18:13:41.229200 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 18:13:41.231219 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 18:13:41.242398 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 18:13:41.250600 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 18:13:41.253085 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 18:13:41.260870 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 18:13:41.277707 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 18:13:41.279986 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 18:13:41.301624 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 18:13:41.339138 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 18:13:41.365186 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 18:13:41.373101 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 18:13:41.386300 (MainThread): Partial parsing not enabled
2022-12-15 18:13:41.445639 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:13:41.476309 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:13:41.682613 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1926f145-1ffb-4aa5-8469-767efddbb926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d72f6550>]}
2022-12-15 18:13:41.723155 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 18:13:41.724460 (MainThread): 
2022-12-15 18:13:41.725032 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:13:41.729266 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 18:13:41.729644 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 18:13:41.887145 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 18:13:41.887505 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 18:13:41.892777 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:13:42.016493 (MainThread): 18:13:42 | Concurrency: 1 threads (target='dev')
2022-12-15 18:13:42.016756 (MainThread): 18:13:42 | 
2022-12-15 18:13:42.019099 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:13:42.020603 (Thread-1): 18:13:42 | 1 of 2 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 18:13:42.021060 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:13:42.021259 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:13:42.036267 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44864), raddr=('64.233.191.95', 443)>
2022-12-15 18:13:42.036582 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 54518), raddr=('173.194.194.95', 443)>
2022-12-15 18:13:42.036898 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44866), raddr=('64.233.191.95', 443)>
2022-12-15 18:13:42.037146 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 54526), raddr=('173.194.194.95', 443)>
2022-12-15 18:13:42.044652 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:13:42.045135 (Thread-1): finished collecting timing info
2022-12-15 18:13:42.072364 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:13:42.077815 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:13:42.242996 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:13:42.243660 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    isFraud as is_fraud,
    isFlaggedFraud as is_flagged_fraud

FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 18:13:54.746468 (Thread-1): finished collecting timing info
2022-12-15 18:13:54.747634 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1926f145-1ffb-4aa5-8469-767efddbb926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d734fc18>]}
2022-12-15 18:13:54.749176 (Thread-1): 18:13:54 | 1 of 2 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 12.73s]
2022-12-15 18:13:54.749415 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:13:54.750030 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 18:13:54.751343 (Thread-1): 18:13:54 | 2 of 2 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-15 18:13:54.751780 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:13:54.751940 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 18:13:54.761732 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 18:13:54.762206 (Thread-1): finished collecting timing info
2022-12-15 18:13:54.767485 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:13:54.772630 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:13:54.905338 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 18:13:54.906288 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    transactionID,
    step,
    timestamp,
    type,
    amount,
    nameOrig,
    oldbalanceOrg,
    newbalanceOrig,
    nameDest,
    oldbalanceDest,
    newbalanceDest,
    isFraud,
    isFlaggedFraud
FROM
    fact_raw_fraud
  );
    
2022-12-15 18:13:55.473563 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/4501e538-f13f-446c-8b47-28054314acb6?maxResults=0&location=US&prettyPrint=false: Unrecognized name: transactionID at [17:5]',)
2022-12-15 18:13:56.441903 (Thread-1): finished collecting timing info
2022-12-15 18:13:56.442815 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: transactionID at [17:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/d29b1658-66db-4ba2-a046-71e7cebda0ac?maxResults=0&location=US&prettyPrint=false: Unrecognized name: transactionID at [17:5]

(job ID: d29b1658-66db-4ba2-a046-71e7cebda0ac)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    transactionID,
  18:    step,
  19:    timestamp,
  20:    type,
  21:    amount,
  22:    nameOrig,
  23:    oldbalanceOrg,
  24:    newbalanceOrig,
  25:    nameDest,
  26:    oldbalanceDest,
  27:    newbalanceDest,
  28:    isFraud,
  29:    isFlaggedFraud
  30:FROM
  31:    fact_raw_fraud
  32:  );
  33:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: transactionID at [17:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-15 18:13:56.446729 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1926f145-1ffb-4aa5-8469-767efddbb926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d63caef0>]}
2022-12-15 18:13:56.448299 (Thread-1): 18:13:56 | 2 of 2 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 1.70s]
2022-12-15 18:13:56.448571 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 18:13:56.450885 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:13:56.451387 (MainThread): 18:13:56 | 
2022-12-15 18:13:56.451587 (MainThread): 18:13:56 | Finished running 2 table models in 14.73s.
2022-12-15 18:13:56.451743 (MainThread): Connection 'master' was properly closed.
2022-12-15 18:13:56.451841 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 18:13:56.491632 (MainThread): 
2022-12-15 18:13:56.491869 (MainThread): Completed with 1 error and 0 warnings:
2022-12-15 18:13:56.492043 (MainThread): 
2022-12-15 18:13:56.492240 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-15 18:13:56.492427 (MainThread):   Unrecognized name: transactionID at [17:5]
2022-12-15 18:13:56.492580 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-15 18:13:56.492745 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2022-12-15 18:13:56.493069 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d6418e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d63b3630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d747e470>]}
2022-12-15 18:13:56.493414 (MainThread): Flushing usage events
2022-12-15 18:16:54.598560 (MainThread): Running with dbt=0.19.0
2022-12-15 18:16:55.280684 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 18:16:55.282022 (MainThread): Tracking: tracking
2022-12-15 18:16:55.291363 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9ec21dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9ec21f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9ec21f28>]}
2022-12-15 18:16:55.344189 (MainThread): Partial parsing not enabled
2022-12-15 18:16:55.345697 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 18:16:55.347996 (MainThread): Parsing macros/catalog.sql
2022-12-15 18:16:55.359002 (MainThread): Parsing macros/etc.sql
2022-12-15 18:16:55.361804 (MainThread): Parsing macros/adapters.sql
2022-12-15 18:16:55.386407 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 18:16:55.390090 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 18:16:55.393735 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 18:16:55.410517 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 18:16:55.422738 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 18:16:55.428355 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 18:16:55.431677 (MainThread): Parsing macros/core.sql
2022-12-15 18:16:55.436638 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 18:16:55.489825 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 18:16:55.491255 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 18:16:55.502447 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 18:16:55.504680 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 18:16:55.506772 (MainThread): Parsing macros/etc/query.sql
2022-12-15 18:16:55.508232 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 18:16:55.510906 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 18:16:55.513270 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 18:16:55.515828 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 18:16:55.519328 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 18:16:55.521370 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 18:16:55.532811 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 18:16:55.541375 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 18:16:55.543790 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 18:16:55.551639 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 18:16:55.569149 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 18:16:55.571504 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 18:16:55.595193 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 18:16:55.633019 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 18:16:55.658270 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 18:16:55.665959 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 18:16:55.680146 (MainThread): Partial parsing not enabled
2022-12-15 18:16:55.739925 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:16:55.770799 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:16:55.980791 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b3afa9f-48e5-4be1-8bf1-a5ecc8405af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9e92f550>]}
2022-12-15 18:16:56.022220 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 18:16:56.023364 (MainThread): 
2022-12-15 18:16:56.023880 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:16:56.028137 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 18:16:56.028486 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 18:16:56.186952 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 18:16:56.187320 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-12-15 18:16:56.192585 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:16:56.317069 (MainThread): 18:16:56 | Concurrency: 1 threads (target='dev')
2022-12-15 18:16:56.317383 (MainThread): 18:16:56 | 
2022-12-15 18:16:56.319934 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:16:56.321713 (Thread-1): 18:16:56 | 1 of 2 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 18:16:56.322196 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:16:56.322444 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:16:56.338396 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 37652), raddr=('64.233.191.95', 443)>
2022-12-15 18:16:56.338751 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 37454), raddr=('173.194.194.95', 443)>
2022-12-15 18:16:56.347177 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:16:56.348276 (Thread-1): finished collecting timing info
2022-12-15 18:16:56.377413 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:16:56.383322 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:16:56.547506 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:16:56.548173 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    isFraud as is_fraud,
    isFlaggedFraud as is_flagged_fraud

FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 18:17:09.624692 (Thread-1): finished collecting timing info
2022-12-15 18:17:09.625928 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3afa9f-48e5-4be1-8bf1-a5ecc8405af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9da2d550>]}
2022-12-15 18:17:09.627641 (Thread-1): 18:17:09 | 1 of 2 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 13.30s]
2022-12-15 18:17:09.627962 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:17:09.628731 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 18:17:09.630106 (Thread-1): 18:17:09 | 2 of 2 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-15 18:17:09.630484 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:17:09.630645 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 18:17:09.640711 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 18:17:09.641114 (Thread-1): finished collecting timing info
2022-12-15 18:17:09.646374 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:17:09.651626 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:17:09.797370 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 18:17:09.798198 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-15 18:17:18.923535 (Thread-1): finished collecting timing info
2022-12-15 18:17:18.924690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3afa9f-48e5-4be1-8bf1-a5ecc8405af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9da3ebe0>]}
2022-12-15 18:17:18.926176 (Thread-1): 18:17:18 | 2 of 2 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 542.6 MB processed) in 9.29s]
2022-12-15 18:17:18.926480 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 18:17:18.967695 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:17:18.968287 (MainThread): 18:17:18 | 
2022-12-15 18:17:18.968503 (MainThread): 18:17:18 | Finished running 2 table models in 22.94s.
2022-12-15 18:17:18.968699 (MainThread): Connection 'master' was properly closed.
2022-12-15 18:17:18.968837 (MainThread): Connection 'list_final-project-team1' was properly closed.
2022-12-15 18:17:18.968943 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 18:17:19.009501 (MainThread): 
2022-12-15 18:17:19.009764 (MainThread): Completed successfully
2022-12-15 18:17:19.009991 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-12-15 18:17:19.010354 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9e942da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9e989ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c9eaaca90>]}
2022-12-15 18:17:19.010728 (MainThread): Flushing usage events
2022-12-15 18:22:13.171970 (MainThread): Running with dbt=0.19.0
2022-12-15 18:22:13.841210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 18:22:13.842667 (MainThread): Tracking: tracking
2022-12-15 18:22:13.852008 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5b6ba6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5b6baf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5b6bafd0>]}
2022-12-15 18:22:13.904347 (MainThread): Partial parsing not enabled
2022-12-15 18:22:13.905722 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 18:22:13.908008 (MainThread): Parsing macros/catalog.sql
2022-12-15 18:22:13.918717 (MainThread): Parsing macros/etc.sql
2022-12-15 18:22:13.921410 (MainThread): Parsing macros/adapters.sql
2022-12-15 18:22:13.945392 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 18:22:13.948939 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 18:22:13.952455 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 18:22:13.968143 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 18:22:13.980396 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 18:22:13.985986 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 18:22:13.989172 (MainThread): Parsing macros/core.sql
2022-12-15 18:22:13.994291 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 18:22:14.047845 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 18:22:14.049166 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 18:22:14.060332 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 18:22:14.062479 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 18:22:14.064510 (MainThread): Parsing macros/etc/query.sql
2022-12-15 18:22:14.065845 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 18:22:14.068401 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 18:22:14.070557 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 18:22:14.072944 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 18:22:14.076306 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 18:22:14.078346 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 18:22:14.090893 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 18:22:14.099825 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 18:22:14.102137 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 18:22:14.109890 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 18:22:14.126736 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 18:22:14.128963 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 18:22:14.151529 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 18:22:14.188892 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 18:22:14.214665 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 18:22:14.222257 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 18:22:14.235453 (MainThread): Partial parsing not enabled
2022-12-15 18:22:14.295654 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:22:14.327112 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-15 18:22:14.344177 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:22:14.562260 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd9308c-306b-41f8-b509-76d89f19828e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd6d016550>]}
2022-12-15 18:22:14.607009 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 18:22:14.608198 (MainThread): 
2022-12-15 18:22:14.608651 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:22:14.614343 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 18:22:14.614760 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 18:22:14.778555 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 18:22:14.778998 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 18:22:14.784330 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:22:14.785556 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 40380), raddr=('142.250.148.95', 443)>
2022-12-15 18:22:14.785862 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 38404), raddr=('209.85.146.95', 443)>
2022-12-15 18:22:14.910348 (MainThread): 18:22:14 | Concurrency: 1 threads (target='dev')
2022-12-15 18:22:14.910629 (MainThread): 18:22:14 | 
2022-12-15 18:22:14.914126 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:22:14.915783 (Thread-1): 18:22:14 | 1 of 3 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 18:22:14.916567 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:22:14.916820 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:22:14.938263 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:22:14.938877 (Thread-1): finished collecting timing info
2022-12-15 18:22:14.965226 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:22:14.970446 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:22:15.144435 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:22:15.145279 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    isFraud as is_fraud,
    isFlaggedFraud as is_flagged_fraud

FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 18:22:28.217155 (Thread-1): finished collecting timing info
2022-12-15 18:22:28.218318 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd9308c-306b-41f8-b509-76d89f19828e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a41ab38>]}
2022-12-15 18:22:28.219852 (Thread-1): 18:22:28 | 1 of 3 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 13.30s]
2022-12-15 18:22:28.220167 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:22:28.221129 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-15 18:22:28.222444 (Thread-1): 18:22:28 | 2 of 3 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-15 18:22:28.222840 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-15 18:22:28.222990 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-15 18:22:28.233449 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-15 18:22:28.233955 (Thread-1): finished collecting timing info
2022-12-15 18:22:28.239862 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-15 18:22:28.240313 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:22:28.245435 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT
    payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_payment_type
  );
    
2022-12-15 18:22:32.248417 (Thread-1): finished collecting timing info
2022-12-15 18:22:32.249598 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd9308c-306b-41f8-b509-76d89f19828e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a41a978>]}
2022-12-15 18:22:32.251409 (Thread-1): 18:22:32 | 2 of 3 OK created table model timestamp_fraud_complete.dim_payment_type [CREATE TABLE (6.4m rows, 57.2 MB processed) in 4.03s]
2022-12-15 18:22:32.251731 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-15 18:22:32.252038 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 18:22:32.253355 (Thread-1): 18:22:32 | 3 of 3 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-15 18:22:32.254090 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:22:32.254317 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 18:22:32.264638 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 18:22:32.265190 (Thread-1): finished collecting timing info
2022-12-15 18:22:32.270728 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:22:32.275997 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:22:32.406667 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 18:22:32.407515 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-15 18:22:40.485781 (Thread-1): finished collecting timing info
2022-12-15 18:22:40.486935 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd9308c-306b-41f8-b509-76d89f19828e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a3c8160>]}
2022-12-15 18:22:40.488491 (Thread-1): 18:22:40 | 3 of 3 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 542.6 MB processed) in 8.23s]
2022-12-15 18:22:40.488797 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 18:22:40.571666 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:22:40.572223 (MainThread): 18:22:40 | 
2022-12-15 18:22:40.572426 (MainThread): 18:22:40 | Finished running 3 table models in 25.96s.
2022-12-15 18:22:40.572590 (MainThread): Connection 'master' was properly closed.
2022-12-15 18:22:40.572695 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 18:22:40.591607 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 50246), raddr=('74.125.126.95', 443)>
2022-12-15 18:22:40.591895 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 38418), raddr=('209.85.146.95', 443)>
2022-12-15 18:22:40.592130 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44426), raddr=('74.125.126.95', 443)>
2022-12-15 18:22:40.592273 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 55890), raddr=('209.85.146.95', 443)>
2022-12-15 18:22:40.620507 (MainThread): 
2022-12-15 18:22:40.620732 (MainThread): Completed successfully
2022-12-15 18:22:40.620865 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-12-15 18:22:40.621077 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5b68ecf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5ac6e0b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8c94a358>]}
2022-12-15 18:22:40.621330 (MainThread): Flushing usage events
2022-12-15 18:27:57.879016 (MainThread): Running with dbt=0.19.0
2022-12-15 18:27:58.577295 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-15 18:27:58.578853 (MainThread): Tracking: tracking
2022-12-15 18:27:58.589181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15978bae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15978baf28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15978bafd0>]}
2022-12-15 18:27:58.641358 (MainThread): Partial parsing not enabled
2022-12-15 18:27:58.642785 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 18:27:58.645373 (MainThread): Parsing macros/catalog.sql
2022-12-15 18:27:58.655867 (MainThread): Parsing macros/etc.sql
2022-12-15 18:27:58.660094 (MainThread): Parsing macros/adapters.sql
2022-12-15 18:27:58.684307 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 18:27:58.687995 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 18:27:58.691526 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 18:27:58.707580 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 18:27:58.720291 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 18:27:58.725956 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 18:27:58.729333 (MainThread): Parsing macros/core.sql
2022-12-15 18:27:58.734398 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 18:27:58.788265 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 18:27:58.789677 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 18:27:58.801512 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 18:27:58.803799 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 18:27:58.805927 (MainThread): Parsing macros/etc/query.sql
2022-12-15 18:27:58.807692 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 18:27:58.810350 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 18:27:58.812628 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 18:27:58.815070 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 18:27:58.818617 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 18:27:58.820685 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 18:27:58.832083 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 18:27:58.841013 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 18:27:58.843425 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 18:27:58.851826 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 18:27:58.868891 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 18:27:58.871260 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 18:27:58.894563 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 18:27:58.934610 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 18:27:58.961275 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 18:27:58.969054 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 18:27:58.982766 (MainThread): Partial parsing not enabled
2022-12-15 18:27:59.044034 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:27:59.075073 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-15 18:27:59.093417 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-15 18:27:59.110481 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:27:59.128495 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-15 18:27:59.347481 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71b2db44-f741-4c4e-b2ac-f28a320ac8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1597558b00>]}
2022-12-15 18:27:59.401199 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 18:27:59.402583 (MainThread): 
2022-12-15 18:27:59.403220 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:27:59.412856 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-15 18:27:59.413253 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 18:27:59.590183 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 18:27:59.590559 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-15 18:27:59.595829 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:27:59.719008 (MainThread): 18:27:59 | Concurrency: 1 threads (target='dev')
2022-12-15 18:27:59.719311 (MainThread): 18:27:59 | 
2022-12-15 18:27:59.721801 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:27:59.723257 (Thread-1): 18:27:59 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-15 18:27:59.723831 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:27:59.724104 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:27:59.745005 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:27:59.745674 (Thread-1): finished collecting timing info
2022-12-15 18:27:59.772850 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:27:59.778176 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:27:59.941521 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:27:59.942309 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    isFraud as is_fraud,
    isFlaggedFraud as is_flagged_fraud

FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-15 18:28:13.528295 (Thread-1): finished collecting timing info
2022-12-15 18:28:13.529432 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b2db44-f741-4c4e-b2ac-f28a320ac8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15975ed320>]}
2022-12-15 18:28:13.530939 (Thread-1): 18:28:13 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 13.81s]
2022-12-15 18:28:13.531253 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:28:13.532207 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-15 18:28:13.533807 (Thread-1): 18:28:13 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-15 18:28:13.534234 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-15 18:28:13.534416 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-15 18:28:13.544386 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-15 18:28:13.544873 (Thread-1): finished collecting timing info
2022-12-15 18:28:13.550403 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:28:13.555719 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:28:14.066597 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-15 18:28:14.067419 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT
    payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_payment_type
  );
    
2022-12-15 18:28:17.402016 (Thread-1): finished collecting timing info
2022-12-15 18:28:17.403152 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b2db44-f741-4c4e-b2ac-f28a320ac8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15966b92b0>]}
2022-12-15 18:28:17.404704 (Thread-1): 18:28:17 | 2 of 5 OK created table model timestamp_fraud_complete.dim_payment_type [CREATE TABLE (6.4m rows, 57.2 MB processed) in 3.87s]
2022-12-15 18:28:17.404997 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-15 18:28:17.405357 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-15 18:28:17.406845 (Thread-1): 18:28:17 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-15 18:28:17.407262 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-15 18:28:17.407465 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-15 18:28:17.413133 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 43580), raddr=('64.233.191.95', 443)>
2022-12-15 18:28:17.413397 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 48882), raddr=('209.85.200.95', 443)>
2022-12-15 18:28:17.413618 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 51476), raddr=('74.125.124.95', 443)>
2022-12-15 18:28:17.413825 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 48896), raddr=('209.85.200.95', 443)>
2022-12-15 18:28:17.414084 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 51492), raddr=('74.125.124.95', 443)>
2022-12-15 18:28:17.414285 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 48904), raddr=('209.85.200.95', 443)>
2022-12-15 18:28:17.414575 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 33986), raddr=('74.125.124.95', 443)>
2022-12-15 18:28:17.414827 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 34368), raddr=('209.85.200.95', 443)>
2022-12-15 18:28:17.421727 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-15 18:28:17.422236 (Thread-1): finished collecting timing info
2022-12-15 18:28:17.428245 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-15 18:28:17.428734 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:28:17.433911 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-15 18:28:23.841854 (Thread-1): finished collecting timing info
2022-12-15 18:28:23.843037 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b2db44-f741-4c4e-b2ac-f28a320ac8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15966baa58>]}
2022-12-15 18:28:23.844850 (Thread-1): 18:28:23 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.44s]
2022-12-15 18:28:23.845143 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-15 18:28:23.845493 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-15 18:28:23.846944 (Thread-1): 18:28:23 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-15 18:28:23.847697 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-15 18:28:23.847914 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-15 18:28:23.858533 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-15 18:28:23.859186 (Thread-1): finished collecting timing info
2022-12-15 18:28:23.865841 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-15 18:28:23.866578 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:28:23.871954 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-15 18:28:30.453503 (Thread-1): finished collecting timing info
2022-12-15 18:28:30.454730 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b2db44-f741-4c4e-b2ac-f28a320ac8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1596678e10>]}
2022-12-15 18:28:30.456339 (Thread-1): 18:28:30 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.61s]
2022-12-15 18:28:30.456644 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-15 18:28:30.456948 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 18:28:30.458837 (Thread-1): 18:28:30 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-15 18:28:30.459297 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:28:30.459519 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 18:28:30.463014 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 42560), raddr=('74.125.124.95', 443)>
2022-12-15 18:28:30.463299 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 59236), raddr=('209.85.200.95', 443)>
2022-12-15 18:28:30.470735 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 18:28:30.471230 (Thread-1): finished collecting timing info
2022-12-15 18:28:30.477315 (Thread-1): Opening a new connection, currently in state closed
2022-12-15 18:28:30.482504 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:28:30.615297 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 18:28:30.616253 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-15 18:28:40.815396 (Thread-1): finished collecting timing info
2022-12-15 18:28:40.816561 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b2db44-f741-4c4e-b2ac-f28a320ac8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1596664668>]}
2022-12-15 18:28:40.818023 (Thread-1): 18:28:40 | 5 of 5 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 542.6 MB processed) in 10.36s]
2022-12-15 18:28:40.818241 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 18:28:40.917010 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:28:40.917551 (MainThread): 18:28:40 | 
2022-12-15 18:28:40.917726 (MainThread): 18:28:40 | Finished running 5 table models in 41.51s.
2022-12-15 18:28:40.917842 (MainThread): Connection 'master' was properly closed.
2022-12-15 18:28:40.917908 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 18:28:40.970434 (MainThread): 
2022-12-15 18:28:40.970698 (MainThread): Completed successfully
2022-12-15 18:28:40.970930 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-12-15 18:28:40.971308 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1596664668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15976120f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15a4081128>]}
2022-12-15 18:28:40.971678 (MainThread): Flushing usage events
2022-12-15 18:29:46.027588 (MainThread): Running with dbt=0.19.0
2022-12-15 18:29:46.695070 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-15 18:29:46.696449 (MainThread): Tracking: tracking
2022-12-15 18:29:46.704891 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6beba1e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6beba1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bebb61d0>]}
2022-12-15 18:29:46.735703 (MainThread): Partial parsing not enabled
2022-12-15 18:29:46.736649 (MainThread): Parsing macros/decode_isFraud.sql
2022-12-15 18:29:46.738077 (MainThread): Parsing macros/catalog.sql
2022-12-15 18:29:46.747666 (MainThread): Parsing macros/etc.sql
2022-12-15 18:29:46.750300 (MainThread): Parsing macros/adapters.sql
2022-12-15 18:29:46.774294 (MainThread): Parsing macros/materializations/view.sql
2022-12-15 18:29:46.777851 (MainThread): Parsing macros/materializations/seed.sql
2022-12-15 18:29:46.781451 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-15 18:29:46.797786 (MainThread): Parsing macros/materializations/table.sql
2022-12-15 18:29:46.809794 (MainThread): Parsing macros/materializations/copy.sql
2022-12-15 18:29:46.815347 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-15 18:29:46.818575 (MainThread): Parsing macros/core.sql
2022-12-15 18:29:46.823488 (MainThread): Parsing macros/adapters/common.sql
2022-12-15 18:29:46.876499 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-15 18:29:46.877870 (MainThread): Parsing macros/etc/datetime.sql
2022-12-15 18:29:46.889402 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-15 18:29:46.891592 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-15 18:29:46.893649 (MainThread): Parsing macros/etc/query.sql
2022-12-15 18:29:46.895026 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-15 18:29:46.897652 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-15 18:29:46.899873 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-15 18:29:46.902292 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-15 18:29:46.905840 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-15 18:29:46.907861 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-15 18:29:46.919242 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-15 18:29:46.927457 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-15 18:29:46.929768 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-15 18:29:46.937474 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-15 18:29:46.954460 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-15 18:29:46.956721 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-15 18:29:46.979278 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-15 18:29:47.017936 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-15 18:29:47.043710 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-15 18:29:47.051485 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-15 18:29:47.064801 (MainThread): Partial parsing not enabled
2022-12-15 18:29:47.124224 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:29:47.154940 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-15 18:29:47.171812 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-15 18:29:47.189663 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:29:47.207205 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-15 18:29:47.423342 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c088c29-a9fd-4f43-b6c3-bac64c1ff0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6be83ff28>]}
2022-12-15 18:29:47.475189 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 157 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-15 18:29:47.476661 (MainThread): 
2022-12-15 18:29:47.477279 (MainThread): Acquiring new bigquery connection "master".
2022-12-15 18:29:47.486436 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-15 18:29:47.486775 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-15 18:29:47.492708 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-15 18:29:47.629134 (MainThread): 18:29:47 | Concurrency: 1 threads (target='dev')
2022-12-15 18:29:47.629451 (MainThread): 18:29:47 | 
2022-12-15 18:29:47.631782 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:29:47.632314 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-15 18:29:47.632568 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:29:47.653322 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-15 18:29:47.653904 (Thread-1): finished collecting timing info
2022-12-15 18:29:47.654427 (Thread-1): finished collecting timing info
2022-12-15 18:29:47.655050 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-15 18:29:47.655696 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-15 18:29:47.656097 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-15 18:29:47.656290 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-15 18:29:47.665915 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-15 18:29:47.666404 (Thread-1): finished collecting timing info
2022-12-15 18:29:47.666793 (Thread-1): finished collecting timing info
2022-12-15 18:29:47.667360 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-15 18:29:47.667628 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-15 18:29:47.668126 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-15 18:29:47.668323 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-15 18:29:47.678002 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-15 18:29:47.678497 (Thread-1): finished collecting timing info
2022-12-15 18:29:47.678902 (Thread-1): finished collecting timing info
2022-12-15 18:29:47.679539 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-15 18:29:47.679795 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-15 18:29:47.680280 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-15 18:29:47.680474 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-15 18:29:47.690421 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-15 18:29:47.690878 (Thread-1): finished collecting timing info
2022-12-15 18:29:47.691211 (Thread-1): finished collecting timing info
2022-12-15 18:29:47.691737 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-15 18:29:47.691921 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-15 18:29:47.692435 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-15 18:29:47.692588 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-15 18:29:47.702040 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-15 18:29:47.702466 (Thread-1): finished collecting timing info
2022-12-15 18:29:47.702834 (Thread-1): finished collecting timing info
2022-12-15 18:29:47.703365 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-15 18:29:47.731850 (MainThread): Connection 'master' was properly closed.
2022-12-15 18:29:47.732073 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-15 18:29:47.782450 (MainThread): 18:29:47 | Done.
2022-12-15 18:29:47.782776 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6be8c5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6be9f26d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6be8b3128>]}
2022-12-15 18:29:47.783076 (MainThread): Flushing usage events
2022-12-16 02:11:06.475976 (MainThread): Running with dbt=0.19.0
2022-12-16 02:11:07.155310 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-16 02:11:07.156727 (MainThread): Tracking: tracking
2022-12-16 02:11:07.164981 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be144e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be144fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be1591d0>]}
2022-12-16 02:11:07.197611 (MainThread): Partial parsing not enabled
2022-12-16 02:11:07.198792 (MainThread): Parsing macros/decode_fraud.sql
2022-12-16 02:11:07.202954 (MainThread): Parsing macros/catalog.sql
2022-12-16 02:11:07.211289 (MainThread): Parsing macros/etc.sql
2022-12-16 02:11:07.214203 (MainThread): Parsing macros/adapters.sql
2022-12-16 02:11:07.238724 (MainThread): Parsing macros/materializations/view.sql
2022-12-16 02:11:07.242499 (MainThread): Parsing macros/materializations/seed.sql
2022-12-16 02:11:07.246163 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-16 02:11:07.262235 (MainThread): Parsing macros/materializations/table.sql
2022-12-16 02:11:07.274539 (MainThread): Parsing macros/materializations/copy.sql
2022-12-16 02:11:07.280280 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-16 02:11:07.284000 (MainThread): Parsing macros/core.sql
2022-12-16 02:11:07.289043 (MainThread): Parsing macros/adapters/common.sql
2022-12-16 02:11:07.343096 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-16 02:11:07.344668 (MainThread): Parsing macros/etc/datetime.sql
2022-12-16 02:11:07.356130 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-16 02:11:07.358489 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-16 02:11:07.361047 (MainThread): Parsing macros/etc/query.sql
2022-12-16 02:11:07.362626 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-16 02:11:07.365533 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-16 02:11:07.368199 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-16 02:11:07.370740 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-16 02:11:07.374283 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-16 02:11:07.376466 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-16 02:11:07.388103 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-16 02:11:07.396645 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-16 02:11:07.399212 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-16 02:11:07.407186 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-16 02:11:07.424739 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-16 02:11:07.427310 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-16 02:11:07.449697 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-16 02:11:07.489110 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-16 02:11:07.515460 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-16 02:11:07.523680 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-16 02:11:07.537610 (MainThread): Partial parsing not enabled
2022-12-16 02:11:07.599896 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:11:07.634796 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:11:07.652736 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:11:07.670967 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:11:07.690079 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:11:07.920429 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d96aa82-5f58-4e16-acce-9c628f49f3c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bddd9e48>]}
2022-12-16 02:11:07.982459 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-16 02:11:07.984078 (MainThread): 
2022-12-16 02:11:07.984747 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:11:07.993632 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-16 02:11:07.993966 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-16 02:11:07.999927 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-16 02:11:08.142646 (MainThread): 02:11:08 | Concurrency: 1 threads (target='dev')
2022-12-16 02:11:08.143823 (MainThread): 02:11:08 | 
2022-12-16 02:11:08.146886 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:11:08.147415 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:11:08.147626 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:11:08.169860 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:11:08.170428 (Thread-1): finished collecting timing info
2022-12-16 02:11:08.170875 (Thread-1): finished collecting timing info
2022-12-16 02:11:08.171473 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:11:08.172093 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:11:08.172481 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:11:08.172628 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-16 02:11:08.182673 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-16 02:11:08.183114 (Thread-1): finished collecting timing info
2022-12-16 02:11:08.183476 (Thread-1): finished collecting timing info
2022-12-16 02:11:08.184039 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:11:08.184327 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-16 02:11:08.184767 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:11:08.184901 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-16 02:11:08.194661 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-16 02:11:08.195102 (Thread-1): finished collecting timing info
2022-12-16 02:11:08.195480 (Thread-1): finished collecting timing info
2022-12-16 02:11:08.196032 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-16 02:11:08.196240 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-16 02:11:08.196883 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:11:08.197059 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-16 02:11:08.206710 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-16 02:11:08.207221 (Thread-1): finished collecting timing info
2022-12-16 02:11:08.207625 (Thread-1): finished collecting timing info
2022-12-16 02:11:08.208172 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-16 02:11:08.208388 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-16 02:11:08.208875 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:11:08.209037 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-16 02:11:08.219055 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-16 02:11:08.219539 (Thread-1): finished collecting timing info
2022-12-16 02:11:08.219916 (Thread-1): finished collecting timing info
2022-12-16 02:11:08.220431 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-16 02:11:08.247003 (MainThread): Connection 'master' was properly closed.
2022-12-16 02:11:08.247234 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-16 02:11:08.299343 (MainThread): 02:11:08 | Done.
2022-12-16 02:11:08.299754 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bde9b978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bde9b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bde3aef0>]}
2022-12-16 02:11:08.300104 (MainThread): Flushing usage events
2022-12-16 02:11:13.602738 (MainThread): Running with dbt=0.19.0
2022-12-16 02:11:14.291981 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-16 02:11:14.293196 (MainThread): Tracking: tracking
2022-12-16 02:11:14.301941 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf90eb9f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf90eb9f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf90eb9f98>]}
2022-12-16 02:11:14.345596 (MainThread): Partial parsing not enabled
2022-12-16 02:11:14.346663 (MainThread): Parsing macros/decode_fraud.sql
2022-12-16 02:11:14.350775 (MainThread): Parsing macros/catalog.sql
2022-12-16 02:11:14.359075 (MainThread): Parsing macros/etc.sql
2022-12-16 02:11:14.361805 (MainThread): Parsing macros/adapters.sql
2022-12-16 02:11:14.385626 (MainThread): Parsing macros/materializations/view.sql
2022-12-16 02:11:14.389287 (MainThread): Parsing macros/materializations/seed.sql
2022-12-16 02:11:14.392936 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-16 02:11:14.409599 (MainThread): Parsing macros/materializations/table.sql
2022-12-16 02:11:14.421951 (MainThread): Parsing macros/materializations/copy.sql
2022-12-16 02:11:14.427465 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-16 02:11:14.430771 (MainThread): Parsing macros/core.sql
2022-12-16 02:11:14.435667 (MainThread): Parsing macros/adapters/common.sql
2022-12-16 02:11:14.488684 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-16 02:11:14.490085 (MainThread): Parsing macros/etc/datetime.sql
2022-12-16 02:11:14.501627 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-16 02:11:14.503872 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-16 02:11:14.505967 (MainThread): Parsing macros/etc/query.sql
2022-12-16 02:11:14.507395 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-16 02:11:14.509972 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-16 02:11:14.512225 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-16 02:11:14.514717 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-16 02:11:14.518137 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-16 02:11:14.520161 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-16 02:11:14.531395 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-16 02:11:14.539603 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-16 02:11:14.541935 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-16 02:11:14.549751 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-16 02:11:14.566861 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-16 02:11:14.569307 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-16 02:11:14.591336 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-16 02:11:14.629021 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-16 02:11:14.655076 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-16 02:11:14.663026 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-16 02:11:14.676808 (MainThread): Partial parsing not enabled
2022-12-16 02:11:14.735954 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:11:14.769756 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:11:14.786722 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:11:14.804108 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:11:14.821121 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:11:15.038751 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b26ec40-57bf-4193-bea5-af9cf4e594c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf90b66eb8>]}
2022-12-16 02:11:15.092169 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-16 02:11:15.093483 (MainThread): 
2022-12-16 02:11:15.094024 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:11:15.103124 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-16 02:11:15.103560 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-16 02:11:15.263671 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-16 02:11:15.264066 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-16 02:11:15.269486 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-16 02:11:15.403693 (MainThread): 02:11:15 | Concurrency: 1 threads (target='dev')
2022-12-16 02:11:15.403983 (MainThread): 02:11:15 | 
2022-12-16 02:11:15.406197 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:11:15.407853 (Thread-1): 02:11:15 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-16 02:11:15.408405 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:11:15.408638 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:11:15.430954 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:11:15.431564 (Thread-1): finished collecting timing info
2022-12-16 02:11:15.460192 (Thread-1): Opening a new connection, currently in state closed
2022-12-16 02:11:15.465548 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-16 02:11:15.655833 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:11:15.656734 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    isFraud as is_fraud,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud

FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-16 02:11:16.141773 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/a2955ed3-3772-4f36-9e06-88360c0b8ec2?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name is_fraud at [8:6]',)
2022-12-16 02:11:16.849089 (Thread-1): finished collecting timing info
2022-12-16 02:11:16.850177 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  CREATE TABLE has columns with duplicate name is_fraud at [8:6]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/a89ebe6f-c3c6-4213-8f2f-4c68e30d0e18?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name is_fraud at [8:6]

(job ID: a89ebe6f-c3c6-4213-8f2f-4c68e30d0e18)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    amount,
  18:    nameOrig as name_sender,
  19:    oldbalanceOrg as old_balance_sender,
  20:    newbalanceOrig as new_balance_sender,
  21:    nameDest as name_recipient,
  22:    oldbalanceDest as old_balance_recipient,
  23:    newbalanceDest as new_balance_recipient,
  24:    isFraud as is_fraud,
  25:    case isFraud
  26:        when 0 then "Not Fraud"
  27:        when 1 then "Fraud"
  28:    end as is_fraud,
  29:    case isFlaggedFraud
  30:        when 0 then "Not Fraud"
  31:        when 1 then "Fraud"
  32:    end as is_flagged_fraud
  33:
  34:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  35:ORDER BY timestamp, step
  36:  );
  37:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  CREATE TABLE has columns with duplicate name is_fraud at [8:6]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-16 02:11:16.858528 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b26ec40-57bf-4193-bea5-af9cf4e594c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf9048c1d0>]}
2022-12-16 02:11:16.860314 (Thread-1): 02:11:16 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 1.45s]
2022-12-16 02:11:16.860568 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:11:16.861673 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:11:16.861897 (Thread-1): 02:11:16 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-16 02:11:16.862100 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:11:16.862401 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-16 02:11:16.862788 (Thread-1): 02:11:16 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-16 02:11:16.862991 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-16 02:11:16.863229 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-16 02:11:16.863651 (Thread-1): 02:11:16 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-16 02:11:16.863809 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-16 02:11:16.864069 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-16 02:11:16.864252 (Thread-1): 02:11:16 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-16 02:11:16.864378 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-16 02:11:16.909652 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:11:16.910156 (MainThread): 02:11:16 | 
2022-12-16 02:11:16.910342 (MainThread): 02:11:16 | Finished running 5 table models in 1.82s.
2022-12-16 02:11:16.910540 (MainThread): Connection 'master' was properly closed.
2022-12-16 02:11:16.910633 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-16 02:11:16.970016 (MainThread): 
2022-12-16 02:11:16.970338 (MainThread): Completed with 1 error and 0 warnings:
2022-12-16 02:11:16.970536 (MainThread): 
2022-12-16 02:11:16.970714 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-16 02:11:16.970886 (MainThread):   CREATE TABLE has columns with duplicate name is_fraud at [8:6]
2022-12-16 02:11:16.971043 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-16 02:11:16.971223 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-16 02:11:16.972233 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf90bbc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf90b2b908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf90b4bfd0>]}
2022-12-16 02:11:16.972627 (MainThread): Flushing usage events
2022-12-16 02:12:40.144804 (MainThread): Running with dbt=0.19.0
2022-12-16 02:12:40.821547 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-16 02:12:40.822749 (MainThread): Tracking: tracking
2022-12-16 02:12:40.831170 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac03fbdd68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac03fbdf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac03fbdf98>]}
2022-12-16 02:12:40.883878 (MainThread): Partial parsing not enabled
2022-12-16 02:12:40.885267 (MainThread): Parsing macros/decode_fraud.sql
2022-12-16 02:12:40.890829 (MainThread): Parsing macros/catalog.sql
2022-12-16 02:12:40.899130 (MainThread): Parsing macros/etc.sql
2022-12-16 02:12:40.901884 (MainThread): Parsing macros/adapters.sql
2022-12-16 02:12:40.925693 (MainThread): Parsing macros/materializations/view.sql
2022-12-16 02:12:40.929235 (MainThread): Parsing macros/materializations/seed.sql
2022-12-16 02:12:40.932897 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-16 02:12:40.948800 (MainThread): Parsing macros/materializations/table.sql
2022-12-16 02:12:40.960830 (MainThread): Parsing macros/materializations/copy.sql
2022-12-16 02:12:40.966983 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-16 02:12:40.970195 (MainThread): Parsing macros/core.sql
2022-12-16 02:12:40.975129 (MainThread): Parsing macros/adapters/common.sql
2022-12-16 02:12:41.029778 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-16 02:12:41.031109 (MainThread): Parsing macros/etc/datetime.sql
2022-12-16 02:12:41.042643 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-16 02:12:41.044875 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-16 02:12:41.047036 (MainThread): Parsing macros/etc/query.sql
2022-12-16 02:12:41.048417 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-16 02:12:41.050996 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-16 02:12:41.053164 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-16 02:12:41.055524 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-16 02:12:41.058846 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-16 02:12:41.060842 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-16 02:12:41.072592 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-16 02:12:41.080717 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-16 02:12:41.083060 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-16 02:12:41.090668 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-16 02:12:41.107904 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-16 02:12:41.110176 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-16 02:12:41.132230 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-16 02:12:41.171910 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-16 02:12:41.198077 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-16 02:12:41.205932 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-16 02:12:41.219708 (MainThread): Partial parsing not enabled
2022-12-16 02:12:41.280602 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:12:41.314845 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:12:41.331838 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:12:41.348748 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:12:41.366353 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:12:41.587467 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0eba0a97-bfed-4b1f-bb99-dd72f029c098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac03c4fe10>]}
2022-12-16 02:12:41.647435 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-16 02:12:41.648695 (MainThread): 
2022-12-16 02:12:41.649253 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:12:41.658422 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-16 02:12:41.658817 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-16 02:12:41.665217 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-16 02:12:41.802776 (MainThread): 02:12:41 | Concurrency: 1 threads (target='dev')
2022-12-16 02:12:41.803065 (MainThread): 02:12:41 | 
2022-12-16 02:12:41.805694 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:12:41.806226 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:12:41.806461 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:12:41.828197 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:12:41.828815 (Thread-1): finished collecting timing info
2022-12-16 02:12:41.829288 (Thread-1): finished collecting timing info
2022-12-16 02:12:41.829912 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:12:41.830577 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:12:41.830959 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:12:41.831128 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-16 02:12:41.840801 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-16 02:12:41.841250 (Thread-1): finished collecting timing info
2022-12-16 02:12:41.841632 (Thread-1): finished collecting timing info
2022-12-16 02:12:41.842233 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:12:41.842449 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-16 02:12:41.842825 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:12:41.843188 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-16 02:12:41.852669 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-16 02:12:41.853082 (Thread-1): finished collecting timing info
2022-12-16 02:12:41.853454 (Thread-1): finished collecting timing info
2022-12-16 02:12:41.854022 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-16 02:12:41.854246 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-16 02:12:41.854729 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:12:41.854889 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-16 02:12:41.864760 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-16 02:12:41.865203 (Thread-1): finished collecting timing info
2022-12-16 02:12:41.865591 (Thread-1): finished collecting timing info
2022-12-16 02:12:41.866180 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-16 02:12:41.866401 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-16 02:12:41.866892 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:12:41.867065 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-16 02:12:41.876710 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-16 02:12:41.877182 (Thread-1): finished collecting timing info
2022-12-16 02:12:41.877569 (Thread-1): finished collecting timing info
2022-12-16 02:12:41.878174 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-16 02:12:41.905726 (MainThread): Connection 'master' was properly closed.
2022-12-16 02:12:41.905936 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-16 02:12:41.957058 (MainThread): 02:12:41 | Done.
2022-12-16 02:12:41.957964 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac03ce09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac03ddff98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac03d31f28>]}
2022-12-16 02:12:41.958268 (MainThread): Flushing usage events
2022-12-16 02:12:54.986330 (MainThread): Running with dbt=0.19.0
2022-12-16 02:12:55.670424 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-16 02:12:55.671680 (MainThread): Tracking: tracking
2022-12-16 02:12:55.680870 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e884b9ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e884b9f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e884b9fd0>]}
2022-12-16 02:12:55.732929 (MainThread): Partial parsing not enabled
2022-12-16 02:12:55.734486 (MainThread): Parsing macros/decode_fraud.sql
2022-12-16 02:12:55.740607 (MainThread): Parsing macros/catalog.sql
2022-12-16 02:12:55.748843 (MainThread): Parsing macros/etc.sql
2022-12-16 02:12:55.751677 (MainThread): Parsing macros/adapters.sql
2022-12-16 02:12:55.775088 (MainThread): Parsing macros/materializations/view.sql
2022-12-16 02:12:55.778648 (MainThread): Parsing macros/materializations/seed.sql
2022-12-16 02:12:55.782094 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-16 02:12:55.797718 (MainThread): Parsing macros/materializations/table.sql
2022-12-16 02:12:55.810248 (MainThread): Parsing macros/materializations/copy.sql
2022-12-16 02:12:55.815788 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-16 02:12:55.819074 (MainThread): Parsing macros/core.sql
2022-12-16 02:12:55.823907 (MainThread): Parsing macros/adapters/common.sql
2022-12-16 02:12:55.877475 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-16 02:12:55.879120 (MainThread): Parsing macros/etc/datetime.sql
2022-12-16 02:12:55.890543 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-16 02:12:55.892808 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-16 02:12:55.894858 (MainThread): Parsing macros/etc/query.sql
2022-12-16 02:12:55.896231 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-16 02:12:55.898969 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-16 02:12:55.901397 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-16 02:12:55.903797 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-16 02:12:55.907132 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-16 02:12:55.909104 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-16 02:12:55.920619 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-16 02:12:55.929140 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-16 02:12:55.931562 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-16 02:12:55.939212 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-16 02:12:55.956534 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-16 02:12:55.958855 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-16 02:12:55.980586 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-16 02:12:56.019139 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-16 02:12:56.045391 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-16 02:12:56.053630 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-16 02:12:56.066882 (MainThread): Partial parsing not enabled
2022-12-16 02:12:56.125160 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:12:56.157914 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:12:56.174531 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:12:56.191033 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:12:56.209127 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:12:56.425733 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df63d12e-413f-44b0-b136-f0fa86ca0c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e88168b70>]}
2022-12-16 02:12:56.478299 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-16 02:12:56.479589 (MainThread): 
2022-12-16 02:12:56.480084 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:12:56.488906 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-16 02:12:56.489243 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-16 02:12:56.653337 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-16 02:12:56.653703 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-16 02:12:56.659326 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-16 02:12:56.790154 (MainThread): 02:12:56 | Concurrency: 1 threads (target='dev')
2022-12-16 02:12:56.790498 (MainThread): 02:12:56 | 
2022-12-16 02:12:56.793383 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:12:56.795116 (Thread-1): 02:12:56 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-16 02:12:56.795886 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:12:56.796125 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:12:56.819449 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:12:56.820031 (Thread-1): finished collecting timing info
2022-12-16 02:12:56.868454 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:12:56.869106 (Thread-1): Opening a new connection, currently in state closed
2022-12-16 02:12:56.874278 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    isFraud as is_fraud,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud

FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-16 02:12:57.224430 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    isFraud as is_fraud,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud

FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-16 02:12:57.224653 (Thread-1): 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/b619ff3a-c86c-45d3-93bf-38d2388d567c?maxResults=0&location=US&prettyPrint=false: Not found: Table final-project-team1:timestamp_fraud_complete.raw_fraud was not found in location US

(job ID: b619ff3a-c86c-45d3-93bf-38d2388d567c)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    amount,
  18:    nameOrig as name_sender,
  19:    oldbalanceOrg as old_balance_sender,
  20:    newbalanceOrig as new_balance_sender,
  21:    nameDest as name_recipient,
  22:    oldbalanceDest as old_balance_recipient,
  23:    newbalanceDest as new_balance_recipient,
  24:    isFraud as is_fraud,
  25:    case isFraud
  26:        when 0 then "Not Fraud"
  27:        when 1 then "Fraud"
  28:    end as is_fraud,
  29:    case isFlaggedFraud
  30:        when 0 then "Not Fraud"
  31:        when 1 then "Fraud"
  32:    end as is_flagged_fraud
  33:
  34:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  35:ORDER BY timestamp, step
  36:  );
  37:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2022-12-16 02:12:57.224897 (Thread-1): finished collecting timing info
2022-12-16 02:12:57.225633 (Thread-1): Runtime Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/b619ff3a-c86c-45d3-93bf-38d2388d567c?maxResults=0&location=US&prettyPrint=false: Not found: Table final-project-team1:timestamp_fraud_complete.raw_fraud was not found in location US
  
  (job ID: b619ff3a-c86c-45d3-93bf-38d2388d567c)
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/b619ff3a-c86c-45d3-93bf-38d2388d567c?maxResults=0&location=US&prettyPrint=false: Not found: Table final-project-team1:timestamp_fraud_complete.raw_fraud was not found in location US

(job ID: b619ff3a-c86c-45d3-93bf-38d2388d567c)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    amount,
  18:    nameOrig as name_sender,
  19:    oldbalanceOrg as old_balance_sender,
  20:    newbalanceOrig as new_balance_sender,
  21:    nameDest as name_recipient,
  22:    oldbalanceDest as old_balance_recipient,
  23:    newbalanceDest as new_balance_recipient,
  24:    isFraud as is_fraud,
  25:    case isFraud
  26:        when 0 then "Not Fraud"
  27:        when 1 then "Fraud"
  28:    end as is_fraud,
  29:    case isFlaggedFraud
  30:        when 0 then "Not Fraud"
  31:        when 1 then "Fraud"
  32:    end as is_flagged_fraud
  33:
  34:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  35:ORDER BY timestamp, step
  36:  );
  37:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 181, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/b619ff3a-c86c-45d3-93bf-38d2388d567c?maxResults=0&location=US&prettyPrint=false: Not found: Table final-project-team1:timestamp_fraud_complete.raw_fraud was not found in location US
  
  (job ID: b619ff3a-c86c-45d3-93bf-38d2388d567c)
2022-12-16 02:12:57.231207 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df63d12e-413f-44b0-b136-f0fa86ca0c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e8826d588>]}
2022-12-16 02:12:57.232878 (Thread-1): 02:12:57 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 0.44s]
2022-12-16 02:12:57.233104 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:12:57.234041 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:12:57.234270 (Thread-1): 02:12:57 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-16 02:12:57.234434 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:12:57.234581 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-16 02:12:57.234707 (Thread-1): 02:12:57 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-16 02:12:57.234837 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-16 02:12:57.234962 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-16 02:12:57.235083 (Thread-1): 02:12:57 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-16 02:12:57.235217 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-16 02:12:57.235339 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-16 02:12:57.235798 (Thread-1): 02:12:57 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-16 02:12:57.235991 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-16 02:12:57.294440 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:12:57.295002 (MainThread): 02:12:57 | 
2022-12-16 02:12:57.295194 (MainThread): 02:12:57 | Finished running 5 table models in 0.82s.
2022-12-16 02:12:57.295345 (MainThread): Connection 'master' was properly closed.
2022-12-16 02:12:57.295478 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-16 02:12:57.319426 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 60676), raddr=('74.125.70.95', 443)>
2022-12-16 02:12:57.319743 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 53510), raddr=('173.194.195.95', 443)>
2022-12-16 02:12:57.346357 (MainThread): 
2022-12-16 02:12:57.346630 (MainThread): Completed with 1 error and 0 warnings:
2022-12-16 02:12:57.346796 (MainThread): 
2022-12-16 02:12:57.346962 (MainThread): Runtime Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-16 02:12:57.347127 (MainThread):   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/b619ff3a-c86c-45d3-93bf-38d2388d567c?maxResults=0&location=US&prettyPrint=false: Not found: Table final-project-team1:timestamp_fraud_complete.raw_fraud was not found in location US
2022-12-16 02:12:57.347264 (MainThread):   
2022-12-16 02:12:57.347413 (MainThread):   (job ID: b619ff3a-c86c-45d3-93bf-38d2388d567c)
2022-12-16 02:12:57.347573 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-16 02:12:57.347831 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e88222898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e881a1e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e882df160>]}
2022-12-16 02:12:57.348116 (MainThread): Flushing usage events
2022-12-16 02:15:33.058545 (MainThread): Running with dbt=0.19.0
2022-12-16 02:15:33.746199 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-16 02:15:33.747491 (MainThread): Tracking: tracking
2022-12-16 02:15:33.756464 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048eab6e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048eab6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048eacb1d0>]}
2022-12-16 02:15:33.809824 (MainThread): Partial parsing not enabled
2022-12-16 02:15:33.811257 (MainThread): Parsing macros/decode_fraud.sql
2022-12-16 02:15:33.816919 (MainThread): Parsing macros/catalog.sql
2022-12-16 02:15:33.824729 (MainThread): Parsing macros/etc.sql
2022-12-16 02:15:33.827436 (MainThread): Parsing macros/adapters.sql
2022-12-16 02:15:33.852845 (MainThread): Parsing macros/materializations/view.sql
2022-12-16 02:15:33.856564 (MainThread): Parsing macros/materializations/seed.sql
2022-12-16 02:15:33.860499 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-16 02:15:33.876429 (MainThread): Parsing macros/materializations/table.sql
2022-12-16 02:15:33.888687 (MainThread): Parsing macros/materializations/copy.sql
2022-12-16 02:15:33.894794 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-16 02:15:33.898072 (MainThread): Parsing macros/core.sql
2022-12-16 02:15:33.903040 (MainThread): Parsing macros/adapters/common.sql
2022-12-16 02:15:33.956947 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-16 02:15:33.958339 (MainThread): Parsing macros/etc/datetime.sql
2022-12-16 02:15:33.969711 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-16 02:15:33.971919 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-16 02:15:33.973973 (MainThread): Parsing macros/etc/query.sql
2022-12-16 02:15:33.975323 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-16 02:15:33.977988 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-16 02:15:33.980189 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-16 02:15:33.982564 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-16 02:15:33.985926 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-16 02:15:33.988179 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-16 02:15:34.000294 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-16 02:15:34.008426 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-16 02:15:34.010903 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-16 02:15:34.018553 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-16 02:15:34.035627 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-16 02:15:34.037907 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-16 02:15:34.060091 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-16 02:15:34.099530 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-16 02:15:34.125514 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-16 02:15:34.133431 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-16 02:15:34.146954 (MainThread): Partial parsing not enabled
2022-12-16 02:15:34.205988 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:15:34.240009 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:15:34.257445 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:15:34.275308 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:15:34.293224 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:15:34.516006 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53672793-0769-44e7-bbc8-639b94be1fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048e748e10>]}
2022-12-16 02:15:34.572789 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-16 02:15:34.574267 (MainThread): 
2022-12-16 02:15:34.574753 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:15:34.583423 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-16 02:15:34.583832 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-16 02:15:34.590462 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-16 02:15:34.725531 (MainThread): 02:15:34 | Concurrency: 1 threads (target='dev')
2022-12-16 02:15:34.725823 (MainThread): 02:15:34 | 
2022-12-16 02:15:34.728125 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:15:34.728622 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:15:34.728842 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:15:34.750919 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:15:34.751530 (Thread-1): finished collecting timing info
2022-12-16 02:15:34.752003 (Thread-1): finished collecting timing info
2022-12-16 02:15:34.752611 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:15:34.753339 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:15:34.754102 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:15:34.754265 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-16 02:15:34.764488 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-16 02:15:34.765008 (Thread-1): finished collecting timing info
2022-12-16 02:15:34.765425 (Thread-1): finished collecting timing info
2022-12-16 02:15:34.766025 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:15:34.766255 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-16 02:15:34.766808 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:15:34.766980 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-16 02:15:34.776755 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-16 02:15:34.777262 (Thread-1): finished collecting timing info
2022-12-16 02:15:34.777665 (Thread-1): finished collecting timing info
2022-12-16 02:15:34.778240 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-16 02:15:34.778469 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-16 02:15:34.779020 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:15:34.779190 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-16 02:15:34.789015 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-16 02:15:34.789475 (Thread-1): finished collecting timing info
2022-12-16 02:15:34.789867 (Thread-1): finished collecting timing info
2022-12-16 02:15:34.790427 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-16 02:15:34.790672 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-16 02:15:34.791202 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:15:34.791391 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-16 02:15:34.801296 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-16 02:15:34.801759 (Thread-1): finished collecting timing info
2022-12-16 02:15:34.802140 (Thread-1): finished collecting timing info
2022-12-16 02:15:34.802699 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-16 02:15:34.828231 (MainThread): Connection 'master' was properly closed.
2022-12-16 02:15:34.828469 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-16 02:15:34.881921 (MainThread): 02:15:34 | Done.
2022-12-16 02:15:34.882324 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048e82af98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f048e7a83c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049b1aa748>]}
2022-12-16 02:15:34.882700 (MainThread): Flushing usage events
2022-12-16 02:15:44.988856 (MainThread): Running with dbt=0.19.0
2022-12-16 02:15:45.669429 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-16 02:15:45.670545 (MainThread): Tracking: tracking
2022-12-16 02:15:45.679505 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1ba13e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1ba13f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1ba13fd0>]}
2022-12-16 02:15:45.728798 (MainThread): Partial parsing not enabled
2022-12-16 02:15:45.729811 (MainThread): Parsing macros/decode_fraud.sql
2022-12-16 02:15:45.733708 (MainThread): Parsing macros/catalog.sql
2022-12-16 02:15:45.741665 (MainThread): Parsing macros/etc.sql
2022-12-16 02:15:45.744408 (MainThread): Parsing macros/adapters.sql
2022-12-16 02:15:45.768035 (MainThread): Parsing macros/materializations/view.sql
2022-12-16 02:15:45.771649 (MainThread): Parsing macros/materializations/seed.sql
2022-12-16 02:15:45.775205 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-16 02:15:45.791185 (MainThread): Parsing macros/materializations/table.sql
2022-12-16 02:15:45.803566 (MainThread): Parsing macros/materializations/copy.sql
2022-12-16 02:15:45.809055 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-16 02:15:45.812360 (MainThread): Parsing macros/core.sql
2022-12-16 02:15:45.817310 (MainThread): Parsing macros/adapters/common.sql
2022-12-16 02:15:45.877323 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-16 02:15:45.878658 (MainThread): Parsing macros/etc/datetime.sql
2022-12-16 02:15:45.890046 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-16 02:15:45.892277 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-16 02:15:45.894347 (MainThread): Parsing macros/etc/query.sql
2022-12-16 02:15:45.895737 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-16 02:15:45.898304 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-16 02:15:45.900540 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-16 02:15:45.902903 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-16 02:15:45.906275 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-16 02:15:45.908294 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-16 02:15:45.920022 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-16 02:15:45.928803 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-16 02:15:45.931526 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-16 02:15:45.939349 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-16 02:15:45.956862 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-16 02:15:45.959242 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-16 02:15:45.982546 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-16 02:15:46.021674 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-16 02:15:46.047298 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-16 02:15:46.055008 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-16 02:15:46.068520 (MainThread): Partial parsing not enabled
2022-12-16 02:15:46.127410 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:15:46.160602 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:15:46.177636 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:15:46.194919 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:15:46.212092 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:15:46.431780 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e090a27b-baaf-49ec-beea-43ee1bc7b8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b6c1cc0>]}
2022-12-16 02:15:46.483875 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-16 02:15:46.485153 (MainThread): 
2022-12-16 02:15:46.485663 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:15:46.494312 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-16 02:15:46.494641 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-16 02:15:46.500761 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-16 02:15:46.628014 (MainThread): 02:15:46 | Concurrency: 1 threads (target='dev')
2022-12-16 02:15:46.628284 (MainThread): 02:15:46 | 
2022-12-16 02:15:46.630288 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:15:46.630866 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:15:46.631123 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:15:46.652679 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:15:46.653329 (Thread-1): finished collecting timing info
2022-12-16 02:15:46.653805 (Thread-1): finished collecting timing info
2022-12-16 02:15:46.654425 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:15:46.655048 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:15:46.655519 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:15:46.655716 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-16 02:15:46.665465 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-16 02:15:46.665959 (Thread-1): finished collecting timing info
2022-12-16 02:15:46.666367 (Thread-1): finished collecting timing info
2022-12-16 02:15:46.666934 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:15:46.667182 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-16 02:15:46.667694 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:15:46.667897 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-16 02:15:46.677452 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-16 02:15:46.678023 (Thread-1): finished collecting timing info
2022-12-16 02:15:46.678455 (Thread-1): finished collecting timing info
2022-12-16 02:15:46.679026 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-16 02:15:46.679254 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-16 02:15:46.679749 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:15:46.679900 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-16 02:15:46.690185 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-16 02:15:46.690643 (Thread-1): finished collecting timing info
2022-12-16 02:15:46.691050 (Thread-1): finished collecting timing info
2022-12-16 02:15:46.691660 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-16 02:15:46.691892 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-16 02:15:46.692349 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:15:46.692512 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-16 02:15:46.702203 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-16 02:15:46.702695 (Thread-1): finished collecting timing info
2022-12-16 02:15:46.703078 (Thread-1): finished collecting timing info
2022-12-16 02:15:46.703679 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-16 02:15:46.730553 (MainThread): Connection 'master' was properly closed.
2022-12-16 02:15:46.730945 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-16 02:15:46.781979 (MainThread): 02:15:46 | Done.
2022-12-16 02:15:46.783413 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b6a6ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b72b198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1b843828>]}
2022-12-16 02:15:46.783738 (MainThread): Flushing usage events
2022-12-16 02:15:52.311217 (MainThread): Running with dbt=0.19.0
2022-12-16 02:15:53.000893 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-16 02:15:53.002110 (MainThread): Tracking: tracking
2022-12-16 02:15:53.011005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5fbbad68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5fbbaf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5fbbaf60>]}
2022-12-16 02:15:53.064454 (MainThread): Partial parsing not enabled
2022-12-16 02:15:53.065879 (MainThread): Parsing macros/decode_fraud.sql
2022-12-16 02:15:53.071510 (MainThread): Parsing macros/catalog.sql
2022-12-16 02:15:53.079576 (MainThread): Parsing macros/etc.sql
2022-12-16 02:15:53.082241 (MainThread): Parsing macros/adapters.sql
2022-12-16 02:15:53.106605 (MainThread): Parsing macros/materializations/view.sql
2022-12-16 02:15:53.110275 (MainThread): Parsing macros/materializations/seed.sql
2022-12-16 02:15:53.113757 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-16 02:15:53.130096 (MainThread): Parsing macros/materializations/table.sql
2022-12-16 02:15:53.142922 (MainThread): Parsing macros/materializations/copy.sql
2022-12-16 02:15:53.148442 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-16 02:15:53.151657 (MainThread): Parsing macros/core.sql
2022-12-16 02:15:53.156534 (MainThread): Parsing macros/adapters/common.sql
2022-12-16 02:15:53.211334 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-16 02:15:53.212756 (MainThread): Parsing macros/etc/datetime.sql
2022-12-16 02:15:53.224353 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-16 02:15:53.226546 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-16 02:15:53.228658 (MainThread): Parsing macros/etc/query.sql
2022-12-16 02:15:53.230006 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-16 02:15:53.232567 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-16 02:15:53.234802 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-16 02:15:53.237251 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-16 02:15:53.240819 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-16 02:15:53.243194 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-16 02:15:53.254515 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-16 02:15:53.262752 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-16 02:15:53.265082 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-16 02:15:53.272781 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-16 02:15:53.290145 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-16 02:15:53.292729 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-16 02:15:53.315173 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-16 02:15:53.354768 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-16 02:15:53.381260 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-16 02:15:53.389468 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-16 02:15:53.403473 (MainThread): Partial parsing not enabled
2022-12-16 02:15:53.463894 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:15:53.498087 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:15:53.515332 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:15:53.532618 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:15:53.550341 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:15:53.774914 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '544ca38b-bed4-445e-97ed-905bd1a0b839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5f84fe48>]}
2022-12-16 02:15:53.836668 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-16 02:15:53.837939 (MainThread): 
2022-12-16 02:15:53.838399 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:15:53.848168 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-16 02:15:53.848595 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-16 02:15:54.037295 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-16 02:15:54.037663 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-16 02:15:54.042998 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-16 02:15:54.168162 (MainThread): 02:15:54 | Concurrency: 1 threads (target='dev')
2022-12-16 02:15:54.168425 (MainThread): 02:15:54 | 
2022-12-16 02:15:54.170972 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:15:54.172944 (Thread-1): 02:15:54 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-16 02:15:54.173482 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:15:54.173704 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:15:54.196224 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:15:54.196839 (Thread-1): finished collecting timing info
2022-12-16 02:15:54.246253 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:15:54.247041 (Thread-1): Opening a new connection, currently in state closed
2022-12-16 02:15:54.252331 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    isFraud as is_fraud,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud

FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-16 02:15:54.778702 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/33ca667d-b20f-471e-ab47-b50618693866?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name is_fraud at [8:6]',)
2022-12-16 02:15:55.756497 (Thread-1): finished collecting timing info
2022-12-16 02:15:55.757439 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  CREATE TABLE has columns with duplicate name is_fraud at [8:6]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/3a07d55c-0e48-4f27-8369-fe4873568064?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name is_fraud at [8:6]

(job ID: 3a07d55c-0e48-4f27-8369-fe4873568064)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    amount,
  18:    nameOrig as name_sender,
  19:    oldbalanceOrg as old_balance_sender,
  20:    newbalanceOrig as new_balance_sender,
  21:    nameDest as name_recipient,
  22:    oldbalanceDest as old_balance_recipient,
  23:    newbalanceDest as new_balance_recipient,
  24:    isFraud as is_fraud,
  25:    case isFraud
  26:        when 0 then "Not Fraud"
  27:        when 1 then "Fraud"
  28:    end as is_fraud,
  29:    case isFlaggedFraud
  30:        when 0 then "Not Fraud"
  31:        when 1 then "Fraud"
  32:    end as is_flagged_fraud
  33:
  34:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  35:ORDER BY timestamp, step
  36:  );
  37:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  CREATE TABLE has columns with duplicate name is_fraud at [8:6]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-16 02:15:55.761453 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '544ca38b-bed4-445e-97ed-905bd1a0b839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5f9c9278>]}
2022-12-16 02:15:55.763104 (Thread-1): 02:15:55 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 1.59s]
2022-12-16 02:15:55.763333 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:15:55.764117 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:15:55.764349 (Thread-1): 02:15:55 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-16 02:15:55.764550 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:15:55.764758 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-16 02:15:55.764982 (Thread-1): 02:15:55 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-16 02:15:55.765174 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-16 02:15:55.765715 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-16 02:15:55.766185 (Thread-1): 02:15:55 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-16 02:15:55.766390 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-16 02:15:55.766648 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-16 02:15:55.766858 (Thread-1): 02:15:55 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-16 02:15:55.767106 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-16 02:15:55.774750 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:15:55.775191 (MainThread): 02:15:55 | 
2022-12-16 02:15:55.775351 (MainThread): 02:15:55 | Finished running 5 table models in 1.94s.
2022-12-16 02:15:55.775534 (MainThread): Connection 'master' was properly closed.
2022-12-16 02:15:55.775646 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-16 02:15:55.830553 (MainThread): 
2022-12-16 02:15:55.830919 (MainThread): Completed with 1 error and 0 warnings:
2022-12-16 02:15:55.831172 (MainThread): 
2022-12-16 02:15:55.831419 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-16 02:15:55.831627 (MainThread):   CREATE TABLE has columns with duplicate name is_fraud at [8:6]
2022-12-16 02:15:55.831802 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-16 02:15:55.832027 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-16 02:15:55.832375 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5f9269b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5f8e8f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5fa18390>]}
2022-12-16 02:15:55.832843 (MainThread): Flushing usage events
2022-12-16 02:16:18.047403 (MainThread): Running with dbt=0.19.0
2022-12-16 02:16:18.737052 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-16 02:16:18.738234 (MainThread): Tracking: tracking
2022-12-16 02:16:18.746767 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2575e7fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2575e7ff98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2575e7ffd0>]}
2022-12-16 02:16:18.782939 (MainThread): Partial parsing not enabled
2022-12-16 02:16:18.784050 (MainThread): Parsing macros/decode_fraud.sql
2022-12-16 02:16:18.787990 (MainThread): Parsing macros/catalog.sql
2022-12-16 02:16:18.796209 (MainThread): Parsing macros/etc.sql
2022-12-16 02:16:18.799028 (MainThread): Parsing macros/adapters.sql
2022-12-16 02:16:18.823802 (MainThread): Parsing macros/materializations/view.sql
2022-12-16 02:16:18.827807 (MainThread): Parsing macros/materializations/seed.sql
2022-12-16 02:16:18.831389 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-16 02:16:18.847683 (MainThread): Parsing macros/materializations/table.sql
2022-12-16 02:16:18.861113 (MainThread): Parsing macros/materializations/copy.sql
2022-12-16 02:16:18.866669 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-16 02:16:18.870103 (MainThread): Parsing macros/core.sql
2022-12-16 02:16:18.875008 (MainThread): Parsing macros/adapters/common.sql
2022-12-16 02:16:18.929060 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-16 02:16:18.930488 (MainThread): Parsing macros/etc/datetime.sql
2022-12-16 02:16:18.942648 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-16 02:16:18.944899 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-16 02:16:18.947294 (MainThread): Parsing macros/etc/query.sql
2022-12-16 02:16:18.948821 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-16 02:16:18.951485 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-16 02:16:18.953867 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-16 02:16:18.956342 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-16 02:16:18.959774 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-16 02:16:18.962041 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-16 02:16:18.974039 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-16 02:16:18.982276 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-16 02:16:18.984688 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-16 02:16:18.992537 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-16 02:16:19.010357 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-16 02:16:19.012742 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-16 02:16:19.034541 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-16 02:16:19.072421 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-16 02:16:19.098577 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-16 02:16:19.106829 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-16 02:16:19.120144 (MainThread): Partial parsing not enabled
2022-12-16 02:16:19.179851 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:16:19.214383 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:16:19.231719 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:16:19.248745 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:16:19.265785 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:16:19.488391 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2196ca55-d2a3-4a8c-94b8-0c2d305c7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2575b2deb8>]}
2022-12-16 02:16:19.542786 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-16 02:16:19.544098 (MainThread): 
2022-12-16 02:16:19.544614 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:16:19.554855 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-16 02:16:19.555294 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-16 02:16:19.722317 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-16 02:16:19.722743 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-16 02:16:19.728107 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-16 02:16:19.887211 (MainThread): 02:16:19 | Concurrency: 1 threads (target='dev')
2022-12-16 02:16:19.887621 (MainThread): 02:16:19 | 
2022-12-16 02:16:19.890567 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:16:19.892131 (Thread-1): 02:16:19 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-16 02:16:19.892995 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-16 02:16:19.893176 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:16:19.916015 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:16:19.916702 (Thread-1): finished collecting timing info
2022-12-16 02:16:19.967637 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-16 02:16:19.968179 (Thread-1): Opening a new connection, currently in state closed
2022-12-16 02:16:19.973442 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud

FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-16 02:16:34.225536 (Thread-1): finished collecting timing info
2022-12-16 02:16:34.226643 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2196ca55-d2a3-4a8c-94b8-0c2d305c7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2575c1dbe0>]}
2022-12-16 02:16:34.228099 (Thread-1): 02:16:34 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 14.33s]
2022-12-16 02:16:34.228369 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-16 02:16:34.229246 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:16:34.230867 (Thread-1): 02:16:34 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-16 02:16:34.231262 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-16 02:16:34.231468 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-16 02:16:34.242130 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-16 02:16:34.242532 (Thread-1): finished collecting timing info
2022-12-16 02:16:34.248517 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-16 02:16:34.249001 (Thread-1): Opening a new connection, currently in state closed
2022-12-16 02:16:34.254329 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT
    payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_payment_type
  );
    
2022-12-16 02:16:37.762269 (Thread-1): finished collecting timing info
2022-12-16 02:16:37.763329 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2196ca55-d2a3-4a8c-94b8-0c2d305c7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2574c45b38>]}
2022-12-16 02:16:37.765045 (Thread-1): 02:16:37 | 2 of 5 OK created table model timestamp_fraud_complete.dim_payment_type [CREATE TABLE (6.4m rows, 57.2 MB processed) in 3.53s]
2022-12-16 02:16:37.765248 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-16 02:16:37.765434 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-16 02:16:37.767262 (Thread-1): 02:16:37 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-16 02:16:37.767736 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-16 02:16:37.767917 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-16 02:16:37.774884 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 40740), raddr=('74.125.69.95', 443)>
2022-12-16 02:16:37.775172 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 45226), raddr=('142.251.161.95', 443)>
2022-12-16 02:16:37.775412 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 40748), raddr=('74.125.69.95', 443)>
2022-12-16 02:16:37.775605 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 45228), raddr=('142.251.161.95', 443)>
2022-12-16 02:16:37.775849 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 40750), raddr=('74.125.69.95', 443)>
2022-12-16 02:16:37.776025 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 45242), raddr=('142.251.161.95', 443)>
2022-12-16 02:16:37.776275 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 52824), raddr=('74.125.69.95', 443)>
2022-12-16 02:16:37.776454 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 59630), raddr=('142.251.161.95', 443)>
2022-12-16 02:16:37.780950 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-16 02:16:37.781375 (Thread-1): finished collecting timing info
2022-12-16 02:16:37.787449 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-16 02:16:37.787932 (Thread-1): Opening a new connection, currently in state closed
2022-12-16 02:16:37.793210 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-16 02:16:42.793839 (Thread-1): finished collecting timing info
2022-12-16 02:16:42.794862 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2196ca55-d2a3-4a8c-94b8-0c2d305c7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2574c7b940>]}
2022-12-16 02:16:42.796346 (Thread-1): 02:16:42 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 5.03s]
2022-12-16 02:16:42.796608 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-16 02:16:42.796885 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-16 02:16:42.798402 (Thread-1): 02:16:42 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-16 02:16:42.799061 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-16 02:16:42.799242 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-16 02:16:42.800358 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 33496), raddr=('74.125.69.95', 443)>
2022-12-16 02:16:42.800676 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 40726), raddr=('142.251.161.95', 443)>
2022-12-16 02:16:42.811149 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-16 02:16:42.811673 (Thread-1): finished collecting timing info
2022-12-16 02:16:42.817686 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-16 02:16:42.818242 (Thread-1): Opening a new connection, currently in state closed
2022-12-16 02:16:42.823353 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-16 02:16:49.346945 (Thread-1): finished collecting timing info
2022-12-16 02:16:49.348141 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2196ca55-d2a3-4a8c-94b8-0c2d305c7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2574c24630>]}
2022-12-16 02:16:49.349612 (Thread-1): 02:16:49 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.55s]
2022-12-16 02:16:49.349839 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-16 02:16:49.350260 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-16 02:16:49.351700 (Thread-1): 02:16:49 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-16 02:16:49.352354 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-16 02:16:49.352530 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-16 02:16:49.356476 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 33498), raddr=('74.125.69.95', 443)>
2022-12-16 02:16:49.356704 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 40738), raddr=('142.251.161.95', 443)>
2022-12-16 02:16:49.364716 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-16 02:16:49.365136 (Thread-1): finished collecting timing info
2022-12-16 02:16:49.371804 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-16 02:16:49.372337 (Thread-1): Opening a new connection, currently in state closed
2022-12-16 02:16:49.377940 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-16 02:17:01.899718 (Thread-1): finished collecting timing info
2022-12-16 02:17:01.900824 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2196ca55-d2a3-4a8c-94b8-0c2d305c7396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2574ba9518>]}
2022-12-16 02:17:01.902273 (Thread-1): 02:17:01 | 5 of 5 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 579.0 MB processed) in 12.55s]
2022-12-16 02:17:01.902515 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-16 02:17:01.994512 (MainThread): Acquiring new bigquery connection "master".
2022-12-16 02:17:01.995124 (MainThread): 02:17:01 | 
2022-12-16 02:17:01.995334 (MainThread): 02:17:01 | Finished running 5 table models in 42.45s.
2022-12-16 02:17:01.995539 (MainThread): Connection 'master' was properly closed.
2022-12-16 02:17:01.995662 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-16 02:17:02.050600 (MainThread): 
2022-12-16 02:17:02.050859 (MainThread): Completed successfully
2022-12-16 02:17:02.051087 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-12-16 02:17:02.051452 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2575b98400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2575c1dd68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2575cae978>]}
2022-12-16 02:17:02.051811 (MainThread): Flushing usage events
2022-12-17 00:21:54.784476 (MainThread): Running with dbt=0.19.0
2022-12-17 00:21:55.468189 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 00:21:55.469036 (MainThread): Tracking: tracking
2022-12-17 00:21:55.477790 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efce4daae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efce4daaf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efce4daafd0>]}
2022-12-17 00:21:55.529166 (MainThread): Partial parsing not enabled
2022-12-17 00:21:55.530735 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:21:55.536411 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:21:55.546315 (MainThread): Parsing macros/etc.sql
2022-12-17 00:21:55.549085 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:21:55.572662 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:21:55.576478 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:21:55.580142 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:21:55.596147 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:21:55.608472 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:21:55.614116 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:21:55.617873 (MainThread): Parsing macros/core.sql
2022-12-17 00:21:55.622833 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:21:55.675594 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:21:55.677025 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:21:55.688115 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:21:55.690280 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:21:55.692366 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:21:55.693747 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:21:55.696332 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:21:55.698554 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:21:55.700964 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:21:55.704682 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:21:55.706766 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:21:55.717974 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:21:55.726135 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:21:55.728492 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:21:55.736087 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:21:55.753373 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:21:55.755671 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:21:55.777924 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:21:55.815345 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:21:55.840385 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:21:55.848058 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:21:55.861698 (MainThread): Partial parsing not enabled
2022-12-17 00:21:55.922911 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:21:55.956447 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:21:55.972866 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:21:55.989680 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:21:56.006300 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:21:56.155831 (MainThread): WARNING: Found documentation for macro "add_id_payment" which was not found
2022-12-17 00:21:56.232453 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3117a1e-922e-4c4b-b60f-d9b5ec65ed00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efce4a3ff60>]}
2022-12-17 00:21:56.286076 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:21:56.287331 (MainThread): 
2022-12-17 00:21:56.287807 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:21:56.296029 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:21:56.296381 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:21:56.302598 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:21:56.446231 (MainThread): 00:21:56 | Concurrency: 1 threads (target='dev')
2022-12-17 00:21:56.446537 (MainThread): 00:21:56 | 
2022-12-17 00:21:56.449081 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:21:56.449706 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:21:56.449888 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:21:56.471550 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:21:56.472037 (Thread-1): finished collecting timing info
2022-12-17 00:21:56.472437 (Thread-1): finished collecting timing info
2022-12-17 00:21:56.472952 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:21:56.473572 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:21:56.473917 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:21:56.474051 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:21:56.483969 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:21:56.484387 (Thread-1): finished collecting timing info
2022-12-17 00:21:56.484797 (Thread-1): finished collecting timing info
2022-12-17 00:21:56.485278 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:21:56.485472 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:21:56.485902 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:21:56.486042 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:21:56.496593 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:21:56.497045 (Thread-1): finished collecting timing info
2022-12-17 00:21:56.497384 (Thread-1): finished collecting timing info
2022-12-17 00:21:56.497860 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:21:56.498061 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:21:56.498521 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:21:56.498666 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:21:56.507945 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:21:56.508436 (Thread-1): finished collecting timing info
2022-12-17 00:21:56.508778 (Thread-1): finished collecting timing info
2022-12-17 00:21:56.509245 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:21:56.509421 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:21:56.509878 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:21:56.510016 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:21:56.519253 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:21:56.519625 (Thread-1): finished collecting timing info
2022-12-17 00:21:56.519965 (Thread-1): finished collecting timing info
2022-12-17 00:21:56.520426 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:21:56.548998 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:21:56.549168 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:21:56.600883 (MainThread): 00:21:56 | Done.
2022-12-17 00:21:56.601169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efce4a2e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efce4ab06d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efce4a9fb70>]}
2022-12-17 00:21:56.601412 (MainThread): Flushing usage events
2022-12-17 00:22:01.714337 (MainThread): Running with dbt=0.19.0
2022-12-17 00:22:02.380971 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:22:02.382072 (MainThread): Tracking: tracking
2022-12-17 00:22:02.390895 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a459c9e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a459c9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a459de1d0>]}
2022-12-17 00:22:02.443269 (MainThread): Partial parsing not enabled
2022-12-17 00:22:02.444669 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:22:02.450232 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:22:02.458130 (MainThread): Parsing macros/etc.sql
2022-12-17 00:22:02.460790 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:22:02.484344 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:22:02.487826 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:22:02.492009 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:22:02.507870 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:22:02.519939 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:22:02.525264 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:22:02.528414 (MainThread): Parsing macros/core.sql
2022-12-17 00:22:02.533224 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:22:02.585165 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:22:02.586468 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:22:02.598166 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:22:02.600353 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:22:02.602366 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:22:02.603742 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:22:02.606374 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:22:02.608592 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:22:02.610942 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:22:02.614331 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:22:02.616448 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:22:02.627528 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:22:02.635533 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:22:02.637816 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:22:02.645593 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:22:02.662705 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:22:02.665040 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:22:02.687044 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:22:02.724582 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:22:02.749518 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:22:02.757202 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:22:02.770435 (MainThread): Partial parsing not enabled
2022-12-17 00:22:02.829689 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:22:02.862809 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:22:02.879667 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:22:02.896437 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:22:02.913108 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:22:03.057314 (MainThread): WARNING: Found documentation for macro "add_id_payment" which was not found
2022-12-17 00:22:03.135501 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13acb7c8-8106-4653-b97a-c1eab8f0ad48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a457ee1d0>]}
2022-12-17 00:22:03.189317 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:22:03.190510 (MainThread): 
2022-12-17 00:22:03.190967 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:22:03.199995 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:22:03.200342 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:22:03.369668 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:22:03.370069 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:22:03.375514 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:22:03.538738 (MainThread): 00:22:03 | Concurrency: 1 threads (target='dev')
2022-12-17 00:22:03.539074 (MainThread): 00:22:03 | 
2022-12-17 00:22:03.541454 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:22:03.543088 (Thread-1): 00:22:03 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:22:03.543733 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:22:03.543969 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:22:03.566178 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:22:03.566677 (Thread-1): finished collecting timing info
2022-12-17 00:22:03.593918 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:22:03.599272 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:22:03.770097 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:22:03.770764 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    CASE payment_type,
        WHEN "CASH_IN" THEN 1
        WHEN "CASH_OUT" THEN 2
        WHEN "DEBIT" THEN 3
        WHEN "PAYMENT" THEN 4
        WHEN "TRANSFER" THEN 5
    END AS id_payment_type
    COUNT(*) AS total_of_payment_type
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:22:03.958883 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/91228852-fdf4-4fe4-b683-fbe2c6bff0b9?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [32:22]',)
2022-12-17 00:22:05.160846 (Thread-1): finished collecting timing info
2022-12-17 00:22:05.161938 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [32:22]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/62d4541f-4348-43c9-bdfa-7d958647af38?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [32:22]

(job ID: 62d4541f-4348-43c9-bdfa-7d958647af38)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    amount,
  18:    nameOrig as name_sender,
  19:    oldbalanceOrg as old_balance_sender,
  20:    newbalanceOrig as new_balance_sender,
  21:    nameDest as name_recipient,
  22:    oldbalanceDest as old_balance_recipient,
  23:    newbalanceDest as new_balance_recipient,
  24:    case isFraud
  25:        when 0 then "Not Fraud"
  26:        when 1 then "Fraud"
  27:    end as is_fraud,
  28:    case isFlaggedFraud
  29:        when 0 then "Not Fraud"
  30:        when 1 then "Fraud"
  31:    end as is_flagged_fraud,
  32:    CASE payment_type,
  33:        WHEN "CASH_IN" THEN 1
  34:        WHEN "CASH_OUT" THEN 2
  35:        WHEN "DEBIT" THEN 3
  36:        WHEN "PAYMENT" THEN 4
  37:        WHEN "TRANSFER" THEN 5
  38:    END AS id_payment_type
  39:    COUNT(*) AS total_of_payment_type
  40:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  41:ORDER BY timestamp, step
  42:  );
  43:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [32:22]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:22:05.170375 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13acb7c8-8106-4653-b97a-c1eab8f0ad48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4562d7f0>]}
2022-12-17 00:22:05.172091 (Thread-1): 00:22:05 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 1.63s]
2022-12-17 00:22:05.172319 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:22:05.173272 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:22:05.173529 (Thread-1): 00:22:05 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-17 00:22:05.173731 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:22:05.173959 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:22:05.174250 (Thread-1): 00:22:05 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-17 00:22:05.174427 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:22:05.174668 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:22:05.174920 (Thread-1): 00:22:05 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-17 00:22:05.175089 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:22:05.175319 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:22:05.175585 (Thread-1): 00:22:05 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-17 00:22:05.175762 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:22:05.244819 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:22:05.245385 (MainThread): 00:22:05 | 
2022-12-17 00:22:05.245581 (MainThread): 00:22:05 | Finished running 5 table models in 2.05s.
2022-12-17 00:22:05.245719 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:22:05.245814 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-17 00:22:05.300855 (MainThread): 
2022-12-17 00:22:05.301110 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:22:05.301267 (MainThread): 
2022-12-17 00:22:05.301399 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-17 00:22:05.301494 (MainThread):   Syntax error: Unexpected "," at [32:22]
2022-12-17 00:22:05.301622 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:22:05.301802 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-17 00:22:05.302152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a4568dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a457cff28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a457cf898>]}
2022-12-17 00:22:05.302492 (MainThread): Flushing usage events
2022-12-17 00:22:31.666913 (MainThread): Running with dbt=0.19.0
2022-12-17 00:22:32.331569 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:22:32.332586 (MainThread): Tracking: tracking
2022-12-17 00:22:32.339760 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2f18be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2f18bf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2f18bfd0>]}
2022-12-17 00:22:32.371428 (MainThread): Partial parsing not enabled
2022-12-17 00:22:32.372425 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:22:32.376464 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:22:32.384550 (MainThread): Parsing macros/etc.sql
2022-12-17 00:22:32.387181 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:22:32.410734 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:22:32.414310 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:22:32.417726 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:22:32.433571 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:22:32.445434 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:22:32.450840 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:22:32.454045 (MainThread): Parsing macros/core.sql
2022-12-17 00:22:32.458860 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:22:32.511471 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:22:32.512828 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:22:32.523744 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:22:32.525958 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:22:32.527993 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:22:32.529329 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:22:32.531870 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:22:32.534028 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:22:32.536399 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:22:32.539770 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:22:32.541719 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:22:32.553154 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:22:32.561273 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:22:32.563581 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:22:32.571137 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:22:32.588077 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:22:32.590304 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:22:32.612414 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:22:32.650340 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:22:32.675501 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:22:32.683287 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:22:32.696400 (MainThread): Partial parsing not enabled
2022-12-17 00:22:32.754400 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:22:32.787701 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:22:32.804275 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:22:32.820713 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:22:32.837049 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:22:32.977795 (MainThread): WARNING: Found documentation for macro "add_id_payment" which was not found
2022-12-17 00:22:33.051699 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3545565-ed65-46f7-845f-b6b04f4e1dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2efbdba8>]}
2022-12-17 00:22:33.103086 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:22:33.104439 (MainThread): 
2022-12-17 00:22:33.104925 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:22:33.113515 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:22:33.113902 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:22:33.290053 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:22:33.290380 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:22:33.295585 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:22:33.484915 (MainThread): 00:22:33 | Concurrency: 1 threads (target='dev')
2022-12-17 00:22:33.485216 (MainThread): 00:22:33 | 
2022-12-17 00:22:33.487729 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:22:33.489086 (Thread-1): 00:22:33 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:22:33.489863 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:22:33.490040 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:22:33.511665 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:22:33.512098 (Thread-1): finished collecting timing info
2022-12-17 00:22:33.538381 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:22:33.543713 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:22:33.724411 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:22:33.724929 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    CASE payment_type,
        WHEN "CASH_IN" THEN 1
        WHEN "CASH_OUT" THEN 2
        WHEN "DEBIT" THEN 3
        WHEN "PAYMENT" THEN 4
        WHEN "TRANSFER" THEN 5
    END AS id_payment_type
    -- COUNT(*) AS total_of_payment_type
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:22:33.925828 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/4c29f2ca-19e1-48a3-a7e7-cb4fbb82edc1?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [32:22]',)
2022-12-17 00:22:35.127690 (Thread-1): finished collecting timing info
2022-12-17 00:22:35.128720 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [32:22]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/1887f692-d702-47a4-b99e-7df522820a9b?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [32:22]

(job ID: 1887f692-d702-47a4-b99e-7df522820a9b)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    amount,
  18:    nameOrig as name_sender,
  19:    oldbalanceOrg as old_balance_sender,
  20:    newbalanceOrig as new_balance_sender,
  21:    nameDest as name_recipient,
  22:    oldbalanceDest as old_balance_recipient,
  23:    newbalanceDest as new_balance_recipient,
  24:    case isFraud
  25:        when 0 then "Not Fraud"
  26:        when 1 then "Fraud"
  27:    end as is_fraud,
  28:    case isFlaggedFraud
  29:        when 0 then "Not Fraud"
  30:        when 1 then "Fraud"
  31:    end as is_flagged_fraud,
  32:    CASE payment_type,
  33:        WHEN "CASH_IN" THEN 1
  34:        WHEN "CASH_OUT" THEN 2
  35:        WHEN "DEBIT" THEN 3
  36:        WHEN "PAYMENT" THEN 4
  37:        WHEN "TRANSFER" THEN 5
  38:    END AS id_payment_type
  39:    -- COUNT(*) AS total_of_payment_type
  40:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  41:ORDER BY timestamp, step
  42:  );
  43:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [32:22]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:22:35.132645 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3545565-ed65-46f7-845f-b6b04f4e1dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2edf36a0>]}
2022-12-17 00:22:35.134693 (Thread-1): 00:22:35 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 1.64s]
2022-12-17 00:22:35.135006 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:22:35.136147 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:22:35.136358 (Thread-1): 00:22:35 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-17 00:22:35.136521 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:22:35.136768 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:22:35.137041 (Thread-1): 00:22:35 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-17 00:22:35.137193 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:22:35.137439 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:22:35.137754 (Thread-1): 00:22:35 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-17 00:22:35.137956 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:22:35.138168 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:22:35.138420 (Thread-1): 00:22:35 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-17 00:22:35.138602 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:22:35.191214 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:22:35.191804 (MainThread): 00:22:35 | 
2022-12-17 00:22:35.192002 (MainThread): 00:22:35 | Finished running 5 table models in 2.09s.
2022-12-17 00:22:35.192181 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:22:35.192263 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-17 00:22:35.245916 (MainThread): 
2022-12-17 00:22:35.246205 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:22:35.246433 (MainThread): 
2022-12-17 00:22:35.246633 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-17 00:22:35.246822 (MainThread):   Syntax error: Unexpected "," at [32:22]
2022-12-17 00:22:35.247003 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:22:35.247199 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-17 00:22:35.247562 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2eed82e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2eea5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2f009c50>]}
2022-12-17 00:22:35.247924 (MainThread): Flushing usage events
2022-12-17 00:24:06.158319 (MainThread): Running with dbt=0.19.0
2022-12-17 00:24:06.826361 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:24:06.827456 (MainThread): Tracking: tracking
2022-12-17 00:24:06.835560 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fa00be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fa00bf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fa00bfd0>]}
2022-12-17 00:24:06.886431 (MainThread): Partial parsing not enabled
2022-12-17 00:24:06.887813 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:24:06.893069 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:24:06.901821 (MainThread): Parsing macros/etc.sql
2022-12-17 00:24:06.904599 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:24:06.928473 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:24:06.932031 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:24:06.935463 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:24:06.951621 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:24:06.964093 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:24:06.969522 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:24:06.972708 (MainThread): Parsing macros/core.sql
2022-12-17 00:24:06.977599 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:24:07.030855 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:24:07.032163 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:24:07.043578 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:24:07.045723 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:24:07.047782 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:24:07.049128 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:24:07.051736 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:24:07.053905 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:24:07.056321 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:24:07.059752 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:24:07.061928 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:24:07.073249 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:24:07.081611 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:24:07.083966 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:24:07.091731 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:24:07.109110 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:24:07.111639 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:24:07.134039 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:24:07.172478 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:24:07.198373 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:24:07.206231 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:24:07.219677 (MainThread): Partial parsing not enabled
2022-12-17 00:24:07.281352 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:24:07.315698 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:24:07.332832 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:24:07.350156 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:24:07.367142 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:24:07.511714 (MainThread): WARNING: Found documentation for macro "add_id_payment" which was not found
2022-12-17 00:24:07.590037 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dab0b568-fd8b-4eb9-b6e4-fddd92f84fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f9c9fef0>]}
2022-12-17 00:24:07.642896 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 158 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:24:07.644129 (MainThread): 
2022-12-17 00:24:07.644594 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:24:07.653818 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:24:07.654143 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:24:07.814734 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:24:07.815073 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:24:07.820443 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:24:07.943486 (MainThread): 00:24:07 | Concurrency: 1 threads (target='dev')
2022-12-17 00:24:07.943725 (MainThread): 00:24:07 | 
2022-12-17 00:24:07.945755 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:24:07.947188 (Thread-1): 00:24:07 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:24:07.948456 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:24:07.948669 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:24:07.970555 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:24:07.971041 (Thread-1): finished collecting timing info
2022-12-17 00:24:07.997248 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:24:08.002401 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:24:08.171786 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:24:08.172345 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    CASE payment_type,
        WHEN "CASH_IN" THEN 1
        WHEN "CASH_OUT" THEN 2
        WHEN "DEBIT" THEN 3
        WHEN "PAYMENT" THEN 4
        WHEN "TRANSFER" THEN 5
    END AS id_payment_type,
    -- COUNT(*) AS total_of_payment_type
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:24:08.345769 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/01b51f2a-0bcf-4f86-9bb4-15231b28b772?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [32:22]',)
2022-12-17 00:24:09.583027 (Thread-1): finished collecting timing info
2022-12-17 00:24:09.584180 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [32:22]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/d85761ed-a2c4-48b9-9c73-31f960bd9411?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [32:22]

(job ID: d85761ed-a2c4-48b9-9c73-31f960bd9411)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    amount,
  18:    nameOrig as name_sender,
  19:    oldbalanceOrg as old_balance_sender,
  20:    newbalanceOrig as new_balance_sender,
  21:    nameDest as name_recipient,
  22:    oldbalanceDest as old_balance_recipient,
  23:    newbalanceDest as new_balance_recipient,
  24:    case isFraud
  25:        when 0 then "Not Fraud"
  26:        when 1 then "Fraud"
  27:    end as is_fraud,
  28:    case isFlaggedFraud
  29:        when 0 then "Not Fraud"
  30:        when 1 then "Fraud"
  31:    end as is_flagged_fraud,
  32:    CASE payment_type,
  33:        WHEN "CASH_IN" THEN 1
  34:        WHEN "CASH_OUT" THEN 2
  35:        WHEN "DEBIT" THEN 3
  36:        WHEN "PAYMENT" THEN 4
  37:        WHEN "TRANSFER" THEN 5
  38:    END AS id_payment_type,
  39:    -- COUNT(*) AS total_of_payment_type
  40:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  41:ORDER BY timestamp, step
  42:  );
  43:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [32:22]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:24:09.588035 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab0b568-fd8b-4eb9-b6e4-fddd92f84fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f9c70668>]}
2022-12-17 00:24:09.590017 (Thread-1): 00:24:09 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 1.64s]
2022-12-17 00:24:09.590322 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:24:09.591466 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:24:09.591702 (Thread-1): 00:24:09 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-17 00:24:09.591855 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:24:09.592081 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:24:09.592442 (Thread-1): 00:24:09 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-17 00:24:09.592667 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:24:09.592908 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:24:09.593237 (Thread-1): 00:24:09 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-17 00:24:09.593401 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:24:09.593619 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:24:09.593838 (Thread-1): 00:24:09 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-17 00:24:09.594032 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:24:09.650660 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:24:09.651417 (MainThread): 00:24:09 | 
2022-12-17 00:24:09.652248 (MainThread): 00:24:09 | Finished running 5 table models in 2.01s.
2022-12-17 00:24:09.652872 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:24:09.653032 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-17 00:24:09.713400 (MainThread): 
2022-12-17 00:24:09.713637 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:24:09.713770 (MainThread): 
2022-12-17 00:24:09.713877 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-17 00:24:09.714014 (MainThread):   Syntax error: Unexpected "," at [32:22]
2022-12-17 00:24:09.714171 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:24:09.714356 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-17 00:24:09.714702 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f9e7bba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f780b95f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f9c924a8>]}
2022-12-17 00:24:09.715025 (MainThread): Flushing usage events
2022-12-17 00:30:18.044609 (MainThread): Running with dbt=0.19.0
2022-12-17 00:30:18.728399 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 00:30:18.729690 (MainThread): Tracking: tracking
2022-12-17 00:30:18.738575 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e464a8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e464a8f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e464a8fd0>]}
2022-12-17 00:30:18.790669 (MainThread): Partial parsing not enabled
2022-12-17 00:30:18.792392 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:30:18.799061 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:30:18.806889 (MainThread): Parsing macros/etc.sql
2022-12-17 00:30:18.809782 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:30:18.833874 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:30:18.837765 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:30:18.841356 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:30:18.857620 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:30:18.869994 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:30:18.875481 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:30:18.878887 (MainThread): Parsing macros/core.sql
2022-12-17 00:30:18.883864 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:30:18.938049 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:30:18.939442 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:30:18.950631 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:30:18.952815 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:30:18.954863 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:30:18.956236 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:30:18.958810 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:30:18.961010 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:30:18.963524 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:30:18.966869 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:30:18.968858 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:30:18.980874 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:30:18.989671 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:30:18.992427 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:30:19.000433 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:30:19.017730 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:30:19.020059 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:30:19.042392 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:30:19.080600 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:30:19.107738 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:30:19.115655 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:30:19.129173 (MainThread): Partial parsing not enabled
2022-12-17 00:30:19.187392 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:30:19.221229 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:30:19.237858 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:30:19.254825 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:30:19.271818 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:30:19.416359 (MainThread): WARNING: Found documentation for macro "add_id_payment" which was not found
2022-12-17 00:30:19.492428 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81474ce8-1024-41ea-b870-9051043914f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e462b2048>]}
2022-12-17 00:30:19.544766 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:30:19.545995 (MainThread): 
2022-12-17 00:30:19.546450 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:30:19.554865 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:30:19.555164 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:30:19.561000 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:30:19.712120 (MainThread): 00:30:19 | Concurrency: 1 threads (target='dev')
2022-12-17 00:30:19.712380 (MainThread): 00:30:19 | 
2022-12-17 00:30:19.714746 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:30:19.715297 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:30:19.715560 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:30:19.737421 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:30:19.737989 (Thread-1): finished collecting timing info
2022-12-17 00:30:19.738448 (Thread-1): finished collecting timing info
2022-12-17 00:30:19.739054 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:30:19.739844 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:30:19.740259 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:30:19.740426 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:30:19.749915 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:30:19.750378 (Thread-1): finished collecting timing info
2022-12-17 00:30:19.750752 (Thread-1): finished collecting timing info
2022-12-17 00:30:19.751312 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:30:19.751612 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:30:19.752125 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:30:19.752326 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:30:19.761668 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:30:19.762187 (Thread-1): finished collecting timing info
2022-12-17 00:30:19.762593 (Thread-1): finished collecting timing info
2022-12-17 00:30:19.763181 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:30:19.763458 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:30:19.763952 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:30:19.764158 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:30:19.773771 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:30:19.774268 (Thread-1): finished collecting timing info
2022-12-17 00:30:19.774675 (Thread-1): finished collecting timing info
2022-12-17 00:30:19.775264 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:30:19.775544 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:30:19.776001 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:30:19.776199 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:30:19.786365 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:30:19.786846 (Thread-1): finished collecting timing info
2022-12-17 00:30:19.787255 (Thread-1): finished collecting timing info
2022-12-17 00:30:19.787901 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:30:19.814492 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:30:19.814692 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:30:19.864611 (MainThread): 00:30:19 | Done.
2022-12-17 00:30:19.864940 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e46131828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e461af208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e461af240>]}
2022-12-17 00:30:19.865556 (MainThread): Flushing usage events
2022-12-17 00:30:23.922585 (MainThread): Running with dbt=0.19.0
2022-12-17 00:30:24.593088 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:30:24.594140 (MainThread): Tracking: tracking
2022-12-17 00:30:24.602020 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c102ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c102af98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c102afd0>]}
2022-12-17 00:30:24.632644 (MainThread): Partial parsing not enabled
2022-12-17 00:30:24.633631 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:30:24.638278 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:30:24.645976 (MainThread): Parsing macros/etc.sql
2022-12-17 00:30:24.648685 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:30:24.672394 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:30:24.675907 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:30:24.679319 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:30:24.695221 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:30:24.707525 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:30:24.712955 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:30:24.716233 (MainThread): Parsing macros/core.sql
2022-12-17 00:30:24.721063 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:30:24.772985 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:30:24.774305 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:30:24.785425 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:30:24.787702 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:30:24.789728 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:30:24.791081 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:30:24.793657 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:30:24.795887 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:30:24.798290 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:30:24.801849 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:30:24.803850 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:30:24.815117 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:30:24.823200 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:30:24.825520 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:30:24.833068 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:30:24.849979 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:30:24.852227 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:30:24.873944 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:30:24.911591 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:30:24.936638 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:30:24.944211 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:30:24.957423 (MainThread): Partial parsing not enabled
2022-12-17 00:30:25.016267 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:30:25.049788 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:30:25.066653 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:30:25.083632 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:30:25.100180 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:30:25.242528 (MainThread): WARNING: Found documentation for macro "add_id_payment" which was not found
2022-12-17 00:30:25.317914 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44bd2e0d-eeda-45a8-8e67-a2b63726801b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c0cc9eb8>]}
2022-12-17 00:30:25.370470 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:30:25.371705 (MainThread): 
2022-12-17 00:30:25.372151 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:30:25.381009 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:30:25.381433 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:30:25.542310 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:30:25.542656 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:30:25.547907 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:30:25.682385 (MainThread): 00:30:25 | Concurrency: 1 threads (target='dev')
2022-12-17 00:30:25.682676 (MainThread): 00:30:25 | 
2022-12-17 00:30:25.684841 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:30:25.686389 (Thread-1): 00:30:25 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:30:25.686896 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:30:25.687127 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:30:25.708775 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:30:25.709288 (Thread-1): finished collecting timing info
2022-12-17 00:30:25.735552 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:30:25.740802 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:30:25.925308 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:30:25.926037 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    -- CASE payment_type,
    --     WHEN "CASH_IN" THEN 1
    --     WHEN "CASH_OUT" THEN 2
    --     WHEN "DEBIT" THEN 3
    --     WHEN "PAYMENT" THEN 4
    --     WHEN "TRANSFER" THEN 5
    -- END AS id_payment_type,
    -- COUNT(*) AS total_of_payment_type
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:30:38.268140 (Thread-1): finished collecting timing info
2022-12-17 00:30:38.269129 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44bd2e0d-eeda-45a8-8e67-a2b63726801b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c0e38860>]}
2022-12-17 00:30:38.270513 (Thread-1): 00:30:38 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 12.58s]
2022-12-17 00:30:38.270731 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:30:38.271563 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:30:38.273337 (Thread-1): 00:30:38 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 00:30:38.273803 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:30:38.274016 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:30:38.284391 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:30:38.284779 (Thread-1): finished collecting timing info
2022-12-17 00:30:38.290063 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:30:38.295168 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:30:38.479620 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:30:38.480345 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT
    payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_payment_type
  );
    
2022-12-17 00:30:42.225941 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 59300), raddr=('142.250.136.95', 443)>
2022-12-17 00:30:42.226278 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 59668), raddr=('173.194.192.95', 443)>
2022-12-17 00:30:42.226530 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 59308), raddr=('142.250.136.95', 443)>
2022-12-17 00:30:42.226732 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 59670), raddr=('173.194.192.95', 443)>
2022-12-17 00:30:42.226978 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 59322), raddr=('142.250.136.95', 443)>
2022-12-17 00:30:42.227181 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 59676), raddr=('173.194.192.95', 443)>
2022-12-17 00:30:42.229341 (Thread-1): finished collecting timing info
2022-12-17 00:30:42.230291 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44bd2e0d-eeda-45a8-8e67-a2b63726801b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c061b898>]}
2022-12-17 00:30:42.232272 (Thread-1): 00:30:42 | 2 of 5 OK created table model timestamp_fraud_complete.dim_payment_type [CREATE TABLE (6.4m rows, 57.2 MB processed) in 3.96s]
2022-12-17 00:30:42.232485 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:30:42.232710 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:30:42.234192 (Thread-1): 00:30:42 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 00:30:42.234600 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:30:42.234776 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:30:42.244835 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:30:42.245282 (Thread-1): finished collecting timing info
2022-12-17 00:30:42.250867 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:30:42.256023 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:30:42.397915 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:30:42.398535 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 00:30:48.903221 (Thread-1): finished collecting timing info
2022-12-17 00:30:48.904332 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44bd2e0d-eeda-45a8-8e67-a2b63726801b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c0c8d3c8>]}
2022-12-17 00:30:48.906066 (Thread-1): 00:30:48 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.67s]
2022-12-17 00:30:48.906293 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:30:48.906522 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:30:48.907940 (Thread-1): 00:30:48 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 00:30:48.908329 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:30:48.908495 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:30:48.918322 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:30:48.918760 (Thread-1): finished collecting timing info
2022-12-17 00:30:48.924010 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:30:48.929219 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:30:49.099158 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:30:49.099811 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 00:30:55.575847 (Thread-1): finished collecting timing info
2022-12-17 00:30:55.576847 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44bd2e0d-eeda-45a8-8e67-a2b63726801b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c05fa860>]}
2022-12-17 00:30:55.578255 (Thread-1): 00:30:55 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.67s]
2022-12-17 00:30:55.578479 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:30:55.578754 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:30:55.580424 (Thread-1): 00:30:55 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 00:30:55.580935 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:30:55.581143 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:30:55.591031 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:30:55.591456 (Thread-1): finished collecting timing info
2022-12-17 00:30:55.596837 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:30:55.602120 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:30:55.742049 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:30:55.742825 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 00:31:04.494183 (Thread-1): finished collecting timing info
2022-12-17 00:31:04.495340 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44bd2e0d-eeda-45a8-8e67-a2b63726801b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c061be80>]}
2022-12-17 00:31:04.496840 (Thread-1): 00:31:04 | 5 of 5 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 579.0 MB processed) in 8.91s]
2022-12-17 00:31:04.497108 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:31:04.564662 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:31:04.565207 (MainThread): 00:31:04 | 
2022-12-17 00:31:04.565398 (MainThread): 00:31:04 | Finished running 5 table models in 39.19s.
2022-12-17 00:31:04.565588 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:31:04.565721 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:31:04.617735 (MainThread): 
2022-12-17 00:31:04.617986 (MainThread): Completed successfully
2022-12-17 00:31:04.618220 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-12-17 00:31:04.618569 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c0e2a208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cd72a748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c0e2fe10>]}
2022-12-17 00:31:04.618851 (MainThread): Flushing usage events
2022-12-17 00:32:57.937164 (MainThread): Running with dbt=0.19.0
2022-12-17 00:32:58.592317 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 00:32:58.593425 (MainThread): Tracking: tracking
2022-12-17 00:32:58.601771 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563a024e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563a024fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563a0391d0>]}
2022-12-17 00:32:58.644079 (MainThread): Partial parsing not enabled
2022-12-17 00:32:58.645041 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:32:58.649636 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:32:58.657327 (MainThread): Parsing macros/etc.sql
2022-12-17 00:32:58.659946 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:32:58.683490 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:32:58.686908 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:32:58.690390 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:32:58.706087 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:32:58.718199 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:32:58.723975 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:32:58.727095 (MainThread): Parsing macros/core.sql
2022-12-17 00:32:58.731917 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:32:58.784002 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:32:58.785273 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:32:58.796639 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:32:58.798769 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:32:58.800793 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:32:58.802136 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:32:58.804680 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:32:58.806813 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:32:58.809189 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:32:58.812520 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:32:58.814460 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:32:58.826221 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:32:58.834353 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:32:58.836668 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:32:58.844232 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:32:58.861078 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:32:58.863314 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:32:58.885214 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:32:58.923063 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:32:58.948525 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:32:58.956004 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:32:58.969239 (MainThread): Partial parsing not enabled
2022-12-17 00:32:59.026998 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:32:59.060332 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:32:59.077196 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:32:59.096038 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:32:59.112537 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:32:59.255281 (MainThread): WARNING: Found documentation for macro "add_id_payment" which was not found
2022-12-17 00:32:59.331102 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c7251a0-2345-4043-98da-a71152d77496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5639cc0f98>]}
2022-12-17 00:32:59.384240 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:32:59.385637 (MainThread): 
2022-12-17 00:32:59.386181 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:32:59.394767 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:32:59.395102 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:32:59.401061 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:32:59.539044 (MainThread): 00:32:59 | Concurrency: 1 threads (target='dev')
2022-12-17 00:32:59.539300 (MainThread): 00:32:59 | 
2022-12-17 00:32:59.541579 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:32:59.542090 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:32:59.542316 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:32:59.564078 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:32:59.564555 (Thread-1): finished collecting timing info
2022-12-17 00:32:59.564970 (Thread-1): finished collecting timing info
2022-12-17 00:32:59.565513 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:32:59.566119 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:32:59.566456 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:32:59.566585 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:32:59.577266 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:32:59.577623 (Thread-1): finished collecting timing info
2022-12-17 00:32:59.577953 (Thread-1): finished collecting timing info
2022-12-17 00:32:59.578451 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:32:59.578655 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:32:59.579091 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:32:59.579234 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:32:59.588476 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:32:59.588809 (Thread-1): finished collecting timing info
2022-12-17 00:32:59.589141 (Thread-1): finished collecting timing info
2022-12-17 00:32:59.589637 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:32:59.589832 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:32:59.590278 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:32:59.590418 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:32:59.599867 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:32:59.600183 (Thread-1): finished collecting timing info
2022-12-17 00:32:59.600511 (Thread-1): finished collecting timing info
2022-12-17 00:32:59.601004 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:32:59.601198 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:32:59.601637 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:32:59.601777 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:32:59.611129 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:32:59.611486 (Thread-1): finished collecting timing info
2022-12-17 00:32:59.611832 (Thread-1): finished collecting timing info
2022-12-17 00:32:59.612322 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:32:59.641465 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:32:59.641610 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:32:59.692106 (MainThread): 00:32:59 | Done.
2022-12-17 00:32:59.692403 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5639cb9780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5639cb9a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5639d2f898>]}
2022-12-17 00:32:59.692641 (MainThread): Flushing usage events
2022-12-17 00:33:04.470649 (MainThread): Running with dbt=0.19.0
2022-12-17 00:33:05.123128 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:33:05.124262 (MainThread): Tracking: tracking
2022-12-17 00:33:05.132040 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ec0f6da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ec0f6f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ec0f6fd0>]}
2022-12-17 00:33:05.162515 (MainThread): Partial parsing not enabled
2022-12-17 00:33:05.163461 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:33:05.167909 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:33:05.175663 (MainThread): Parsing macros/etc.sql
2022-12-17 00:33:05.178313 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:33:05.202216 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:33:05.205664 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:33:05.209020 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:33:05.224835 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:33:05.237183 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:33:05.242457 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:33:05.245541 (MainThread): Parsing macros/core.sql
2022-12-17 00:33:05.250345 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:33:05.302124 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:33:05.303453 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:33:05.314414 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:33:05.316510 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:33:05.318520 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:33:05.319868 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:33:05.322385 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:33:05.324530 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:33:05.326860 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:33:05.330178 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:33:05.332172 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:33:05.343429 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:33:05.351954 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:33:05.354256 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:33:05.362094 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:33:05.379033 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:33:05.381389 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:33:05.403302 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:33:05.440851 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:33:05.465956 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:33:05.473507 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:33:05.486505 (MainThread): Partial parsing not enabled
2022-12-17 00:33:05.544824 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:33:05.577552 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:33:05.594206 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:33:05.613031 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:33:05.629583 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:33:05.771205 (MainThread): WARNING: Found documentation for macro "add_id_payment" which was not found
2022-12-17 00:33:05.846491 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '666d8512-7d83-49e2-ba8b-52b7cce8f671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ebd92e10>]}
2022-12-17 00:33:05.898281 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:33:05.899593 (MainThread): 
2022-12-17 00:33:05.900131 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:33:05.909256 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:33:05.909616 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:33:06.075243 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:33:06.075680 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:33:06.080977 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:33:06.213086 (MainThread): 00:33:06 | Concurrency: 1 threads (target='dev')
2022-12-17 00:33:06.213350 (MainThread): 00:33:06 | 
2022-12-17 00:33:06.215669 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:33:06.217153 (Thread-1): 00:33:06 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:33:06.217648 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:33:06.217897 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:33:06.239322 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:33:06.239799 (Thread-1): finished collecting timing info
2022-12-17 00:33:06.265829 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:33:06.271016 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:33:06.431582 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:33:06.432192 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    -- CASE payment_type,
    --     WHEN "CASH_IN" THEN 1
    --     WHEN "CASH_OUT" THEN 2
    --     WHEN "DEBIT" THEN 3
    --     WHEN "PAYMENT" THEN 4
    --     WHEN "TRANSFER" THEN 5
    -- END AS id_payment_type,
    -- COUNT(*) AS total_of_payment_type
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:33:22.378182 (Thread-1): finished collecting timing info
2022-12-17 00:33:22.379226 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '666d8512-7d83-49e2-ba8b-52b7cce8f671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ec0bf5f8>]}
2022-12-17 00:33:22.380682 (Thread-1): 00:33:22 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 16.16s]
2022-12-17 00:33:22.380906 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:33:22.381703 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:33:22.383277 (Thread-1): 00:33:22 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 00:33:22.383731 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:33:22.383935 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:33:22.394758 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:33:22.395240 (Thread-1): finished collecting timing info
2022-12-17 00:33:22.400784 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:33:22.406076 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:33:22.549743 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:33:22.550395 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT DISTINCT
    case payment_type
        when payment_type "CASH_IN" THEN 1
        when payment_type "CASH_OUT" THEN 2
        when payment_type "DEBIT" THEN 3
        when payment_type "PAYMENT" THEN 4
    end as id_payment_type as is_fraud,
        case 
        when  "CASH_IN" THEN 1
        when  "CASH_OUT" THEN 2
        when  "DEBIT" THEN 3
        when  "PAYMENT" THEN 4
    end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    payment_type
FROM 
    dim_payment_type
  );
    
2022-12-17 00:33:22.741914 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/a58b168d-d12f-4045-974b-89bfca6b3f5f?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [14:27]',)
2022-12-17 00:33:22.790833 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 32950), raddr=('142.250.136.95', 443)>
2022-12-17 00:33:22.791200 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 33822), raddr=('173.194.192.95', 443)>
2022-12-17 00:33:22.791469 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 32954), raddr=('142.250.136.95', 443)>
2022-12-17 00:33:22.791802 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 33824), raddr=('173.194.192.95', 443)>
2022-12-17 00:33:22.792204 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 32968), raddr=('142.250.136.95', 443)>
2022-12-17 00:33:22.792500 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 33840), raddr=('173.194.192.95', 443)>
2022-12-17 00:33:22.984406 (Thread-1): finished collecting timing info
2022-12-17 00:33:22.985270 (Thread-1): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [14:27]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/ea33b680-146c-489a-a8cc-326b4dc029f8?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [14:27]

(job ID: ea33b680-146c-489a-a8cc-326b4dc029f8)

                                                                     -----Query Job SQL Follows-----                                                                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:WITH dim_payment_type AS(
  12:    SELECT DISTINCT
  13:    case payment_type
  14:        when payment_type "CASH_IN" THEN 1
  15:        when payment_type "CASH_OUT" THEN 2
  16:        when payment_type "DEBIT" THEN 3
  17:        when payment_type "PAYMENT" THEN 4
  18:    end as id_payment_type as is_fraud,
  19:        case 
  20:        when  "CASH_IN" THEN 1
  21:        when  "CASH_OUT" THEN 2
  22:        when  "DEBIT" THEN 3
  23:        when  "PAYMENT" THEN 4
  24:    end as id_payment_type
  25:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  26:)
  27:
  28:SELECT 
  29:    payment_type
  30:FROM 
  31:    dim_payment_type
  32:  );
  33:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [14:27]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:33:22.989231 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '666d8512-7d83-49e2-ba8b-52b7cce8f671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4eaee2f98>]}
2022-12-17 00:33:22.990757 (Thread-1): 00:33:22 | 2 of 5 ERROR creating table model timestamp_fraud_complete.dim_payment_type [ERROR in 0.61s]
2022-12-17 00:33:22.990973 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:33:22.991223 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:33:22.992852 (Thread-1): 00:33:22 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 00:33:22.993352 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:33:22.993563 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:33:23.003927 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:33:23.004370 (Thread-1): finished collecting timing info
2022-12-17 00:33:23.009762 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:33:23.015009 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:33:23.153785 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:33:23.154419 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 00:33:29.554180 (Thread-1): finished collecting timing info
2022-12-17 00:33:29.555241 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '666d8512-7d83-49e2-ba8b-52b7cce8f671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ebd92c50>]}
2022-12-17 00:33:29.556730 (Thread-1): 00:33:29 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.56s]
2022-12-17 00:33:29.556971 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:33:29.557223 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:33:29.558561 (Thread-1): 00:33:29 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 00:33:29.559400 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:33:29.559615 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:33:29.569404 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:33:29.569956 (Thread-1): finished collecting timing info
2022-12-17 00:33:29.575279 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:33:29.580527 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:33:29.724061 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:33:29.724612 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 00:33:36.095544 (Thread-1): finished collecting timing info
2022-12-17 00:33:36.096538 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '666d8512-7d83-49e2-ba8b-52b7cce8f671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4eada5fd0>]}
2022-12-17 00:33:36.097952 (Thread-1): 00:33:36 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.54s]
2022-12-17 00:33:36.098163 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:33:36.098356 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:33:36.099772 (Thread-1): 00:33:36 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 00:33:36.100192 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:33:36.100357 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:33:36.101148 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 58354), raddr=('142.250.136.95', 443)>
2022-12-17 00:33:36.101349 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 58430), raddr=('173.194.192.95', 443)>
2022-12-17 00:33:36.110925 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:33:36.111299 (Thread-1): finished collecting timing info
2022-12-17 00:33:36.116457 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:33:36.121551 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:33:36.285718 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:33:36.286417 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 00:33:46.312179 (Thread-1): finished collecting timing info
2022-12-17 00:33:46.313287 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '666d8512-7d83-49e2-ba8b-52b7cce8f671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ead81908>]}
2022-12-17 00:33:46.314728 (Thread-1): 00:33:46 | 5 of 5 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 579.0 MB processed) in 10.21s]
2022-12-17 00:33:46.314963 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:33:46.408841 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:33:46.409402 (MainThread): 00:33:46 | 
2022-12-17 00:33:46.409596 (MainThread): 00:33:46 | Finished running 5 table models in 40.51s.
2022-12-17 00:33:46.409780 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:33:46.409915 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:33:46.462076 (MainThread): 
2022-12-17 00:33:46.462322 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:33:46.462539 (MainThread): 
2022-12-17 00:33:46.462737 (MainThread): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
2022-12-17 00:33:46.462916 (MainThread):   Syntax error: Unexpected string literal "CASH_IN" at [14:27]
2022-12-17 00:33:46.463092 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:33:46.463288 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-12-17 00:33:46.463644 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ebe24c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ebf63be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ead81908>]}
2022-12-17 00:33:46.463930 (MainThread): Flushing usage events
2022-12-17 00:34:08.932261 (MainThread): Running with dbt=0.19.0
2022-12-17 00:34:09.597994 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 00:34:09.599265 (MainThread): Tracking: tracking
2022-12-17 00:34:09.607794 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e2b1ceb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e2b1cf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e2b1cf98>]}
2022-12-17 00:34:09.658579 (MainThread): Partial parsing not enabled
2022-12-17 00:34:09.659975 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:34:09.667033 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:34:09.674760 (MainThread): Parsing macros/etc.sql
2022-12-17 00:34:09.677414 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:34:09.701041 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:34:09.704503 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:34:09.707975 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:34:09.724115 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:34:09.736161 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:34:09.741454 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:34:09.744638 (MainThread): Parsing macros/core.sql
2022-12-17 00:34:09.749404 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:34:09.802768 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:34:09.804080 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:34:09.815169 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:34:09.817314 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:34:09.819307 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:34:09.820644 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:34:09.823133 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:34:09.825305 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:34:09.827667 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:34:09.830960 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:34:09.833077 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:34:09.844433 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:34:09.852483 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:34:09.854878 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:34:09.862511 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:34:09.879974 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:34:09.882145 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:34:09.904975 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:34:09.942236 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:34:09.967506 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:34:09.975067 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:34:09.988134 (MainThread): Partial parsing not enabled
2022-12-17 00:34:10.047074 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:34:10.080281 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:34:10.096944 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:34:10.115761 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:34:10.132152 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:34:10.349805 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c395c87-7df6-4f0a-b13a-d5e93c943342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e298bf28>]}
2022-12-17 00:34:10.406515 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:34:10.407885 (MainThread): 
2022-12-17 00:34:10.408420 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:34:10.417012 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:34:10.417329 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:34:10.423143 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:34:10.538002 (MainThread): 00:34:10 | Concurrency: 1 threads (target='dev')
2022-12-17 00:34:10.538266 (MainThread): 00:34:10 | 
2022-12-17 00:34:10.540285 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:34:10.540808 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:34:10.541043 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:34:10.562278 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:34:10.562786 (Thread-1): finished collecting timing info
2022-12-17 00:34:10.563220 (Thread-1): finished collecting timing info
2022-12-17 00:34:10.563837 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:34:10.564456 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:34:10.564841 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:34:10.565006 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:34:10.576724 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:34:10.577217 (Thread-1): finished collecting timing info
2022-12-17 00:34:10.577602 (Thread-1): finished collecting timing info
2022-12-17 00:34:10.578173 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:34:10.578426 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:34:10.578891 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:34:10.579089 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:34:10.588490 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:34:10.588996 (Thread-1): finished collecting timing info
2022-12-17 00:34:10.589394 (Thread-1): finished collecting timing info
2022-12-17 00:34:10.589980 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:34:10.590262 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:34:10.590736 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:34:10.590936 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:34:10.600467 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:34:10.600954 (Thread-1): finished collecting timing info
2022-12-17 00:34:10.601347 (Thread-1): finished collecting timing info
2022-12-17 00:34:10.601916 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:34:10.602168 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:34:10.602621 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:34:10.602818 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:34:10.612231 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:34:10.612744 (Thread-1): finished collecting timing info
2022-12-17 00:34:10.613106 (Thread-1): finished collecting timing info
2022-12-17 00:34:10.613652 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:34:10.640288 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:34:10.640431 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:34:10.689997 (MainThread): 00:34:10 | Done.
2022-12-17 00:34:10.690291 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e293fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e27b0748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e27d7278>]}
2022-12-17 00:34:10.690523 (MainThread): Flushing usage events
2022-12-17 00:34:14.783087 (MainThread): Running with dbt=0.19.0
2022-12-17 00:34:15.445640 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:34:15.446776 (MainThread): Tracking: tracking
2022-12-17 00:34:15.455437 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d339d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d339f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d339f98>]}
2022-12-17 00:34:15.506376 (MainThread): Partial parsing not enabled
2022-12-17 00:34:15.507867 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:34:15.514757 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:34:15.522921 (MainThread): Parsing macros/etc.sql
2022-12-17 00:34:15.525631 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:34:15.549379 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:34:15.552903 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:34:15.556301 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:34:15.572095 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:34:15.584637 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:34:15.590211 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:34:15.593699 (MainThread): Parsing macros/core.sql
2022-12-17 00:34:15.598641 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:34:15.654168 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:34:15.655513 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:34:15.666711 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:34:15.669002 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:34:15.671008 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:34:15.672366 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:34:15.675003 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:34:15.677222 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:34:15.679850 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:34:15.683178 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:34:15.685171 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:34:15.696483 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:34:15.704605 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:34:15.706886 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:34:15.714655 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:34:15.732154 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:34:15.734354 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:34:15.756644 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:34:15.795002 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:34:15.820560 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:34:15.828285 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:34:15.841658 (MainThread): Partial parsing not enabled
2022-12-17 00:34:15.901521 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:34:15.935539 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:34:15.952290 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:34:15.971996 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:34:15.989167 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:34:16.207404 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1a2b70d-d729-4e22-9636-4ad146c81709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d1a72b0>]}
2022-12-17 00:34:16.260235 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:34:16.261655 (MainThread): 
2022-12-17 00:34:16.262195 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:34:16.271290 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:34:16.271787 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:34:16.430671 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:34:16.431081 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:34:16.436443 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:34:16.548396 (MainThread): 00:34:16 | Concurrency: 1 threads (target='dev')
2022-12-17 00:34:16.548673 (MainThread): 00:34:16 | 
2022-12-17 00:34:16.550945 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:34:16.552378 (Thread-1): 00:34:16 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:34:16.552861 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:34:16.553040 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:34:16.574352 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:34:16.574789 (Thread-1): finished collecting timing info
2022-12-17 00:34:16.601669 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:34:16.607431 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:34:16.759232 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:34:16.759789 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    -- CASE payment_type,
    --     WHEN "CASH_IN" THEN 1
    --     WHEN "CASH_OUT" THEN 2
    --     WHEN "DEBIT" THEN 3
    --     WHEN "PAYMENT" THEN 4
    --     WHEN "TRANSFER" THEN 5
    -- END AS id_payment_type,
    -- COUNT(*) AS total_of_payment_type
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:34:29.142636 (Thread-1): finished collecting timing info
2022-12-17 00:34:29.143726 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a2b70d-d729-4e22-9636-4ad146c81709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d32c828>]}
2022-12-17 00:34:29.145147 (Thread-1): 00:34:29 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 12.59s]
2022-12-17 00:34:29.145354 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:34:29.146035 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:34:29.147261 (Thread-1): 00:34:29 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 00:34:29.147653 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:34:29.147801 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:34:29.158435 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:34:29.158889 (Thread-1): finished collecting timing info
2022-12-17 00:34:29.164193 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:34:29.169360 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:34:29.310944 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:34:29.311524 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT DISTINCT
    case payment_type
        when payment_type "CASH_IN" THEN 1
        when payment_type "CASH_OUT" THEN 2
        when payment_type "DEBIT" THEN 3
        when payment_type "PAYMENT" THEN 4
    end as id_payment_type as is_fraud,
    --     case 
    --     when  "CASH_IN" THEN 1
    --     when  "CASH_OUT" THEN 2
    --     when  "DEBIT" THEN 3
    --     when  "PAYMENT" THEN 4
    -- end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    payment_type
FROM 
    dim_payment_type
  );
    
2022-12-17 00:34:29.538398 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/13f9beb6-6e32-4ec6-ac14-0f33f053e848?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [14:27]',)
2022-12-17 00:34:29.722158 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 39464), raddr=('142.250.136.95', 443)>
2022-12-17 00:34:29.722458 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 49738), raddr=('173.194.192.95', 443)>
2022-12-17 00:34:29.722630 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 39474), raddr=('142.250.136.95', 443)>
2022-12-17 00:34:29.722772 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 49742), raddr=('173.194.192.95', 443)>
2022-12-17 00:34:29.722952 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 38272), raddr=('142.250.136.95', 443)>
2022-12-17 00:34:29.723080 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 45486), raddr=('173.194.192.95', 443)>
2022-12-17 00:34:29.939140 (Thread-1): finished collecting timing info
2022-12-17 00:34:29.939997 (Thread-1): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [14:27]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/c64853eb-685b-453d-b626-b66186120d37?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [14:27]

(job ID: c64853eb-685b-453d-b626-b66186120d37)

                                                                     -----Query Job SQL Follows-----                                                                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:WITH dim_payment_type AS(
  12:    SELECT DISTINCT
  13:    case payment_type
  14:        when payment_type "CASH_IN" THEN 1
  15:        when payment_type "CASH_OUT" THEN 2
  16:        when payment_type "DEBIT" THEN 3
  17:        when payment_type "PAYMENT" THEN 4
  18:    end as id_payment_type as is_fraud,
  19:    --     case 
  20:    --     when  "CASH_IN" THEN 1
  21:    --     when  "CASH_OUT" THEN 2
  22:    --     when  "DEBIT" THEN 3
  23:    --     when  "PAYMENT" THEN 4
  24:    -- end as id_payment_type
  25:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  26:)
  27:
  28:SELECT 
  29:    payment_type
  30:FROM 
  31:    dim_payment_type
  32:  );
  33:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [14:27]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:34:29.944063 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a2b70d-d729-4e22-9636-4ad146c81709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92c11bef0>]}
2022-12-17 00:34:29.945576 (Thread-1): 00:34:29 | 2 of 5 ERROR creating table model timestamp_fraud_complete.dim_payment_type [ERROR in 0.80s]
2022-12-17 00:34:29.945791 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:34:29.946050 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:34:29.947844 (Thread-1): 00:34:29 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 00:34:29.948329 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:34:29.948540 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:34:29.959532 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:34:29.960064 (Thread-1): finished collecting timing info
2022-12-17 00:34:29.965368 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:34:29.970856 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:34:30.107026 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:34:30.107622 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 00:34:35.816295 (Thread-1): finished collecting timing info
2022-12-17 00:34:35.817271 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a2b70d-d729-4e22-9636-4ad146c81709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d194518>]}
2022-12-17 00:34:35.818627 (Thread-1): 00:34:35 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 5.87s]
2022-12-17 00:34:35.818838 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:34:35.819053 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:34:35.820478 (Thread-1): 00:34:35 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 00:34:35.820882 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:34:35.821027 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:34:35.831104 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:34:35.831578 (Thread-1): finished collecting timing info
2022-12-17 00:34:35.837106 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:34:35.842253 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:34:35.985482 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:34:35.986106 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 00:34:42.383042 (Thread-1): finished collecting timing info
2022-12-17 00:34:42.384133 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a2b70d-d729-4e22-9636-4ad146c81709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa91ff89908>]}
2022-12-17 00:34:42.385559 (Thread-1): 00:34:42 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.56s]
2022-12-17 00:34:42.385782 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:34:42.386037 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:34:42.387420 (Thread-1): 00:34:42 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 00:34:42.388087 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:34:42.388294 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:34:42.389046 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 46224), raddr=('142.250.136.95', 443)>
2022-12-17 00:34:42.389294 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 32986), raddr=('173.194.192.95', 443)>
2022-12-17 00:34:42.399347 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:34:42.399788 (Thread-1): finished collecting timing info
2022-12-17 00:34:42.404948 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:34:42.410360 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:34:42.541300 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:34:42.541948 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 00:34:50.466927 (Thread-1): finished collecting timing info
2022-12-17 00:34:50.467986 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a2b70d-d729-4e22-9636-4ad146c81709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa91ff89710>]}
2022-12-17 00:34:50.469430 (Thread-1): 00:34:50 | 5 of 5 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 579.0 MB processed) in 8.08s]
2022-12-17 00:34:50.469654 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:34:50.527080 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:34:50.527612 (MainThread): 00:34:50 | 
2022-12-17 00:34:50.527783 (MainThread): 00:34:50 | Finished running 5 table models in 34.27s.
2022-12-17 00:34:50.527899 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:34:50.527975 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:34:50.577957 (MainThread): 
2022-12-17 00:34:50.578192 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:34:50.578320 (MainThread): 
2022-12-17 00:34:50.578432 (MainThread): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
2022-12-17 00:34:50.578527 (MainThread):   Syntax error: Unexpected string literal "CASH_IN" at [14:27]
2022-12-17 00:34:50.578605 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:34:50.578701 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-12-17 00:34:50.578897 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa91ff89da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92c10def0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa91ff99b38>]}
2022-12-17 00:34:50.579105 (MainThread): Flushing usage events
2022-12-17 00:35:03.998298 (MainThread): Running with dbt=0.19.0
2022-12-17 00:35:04.662595 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:35:04.663765 (MainThread): Tracking: tracking
2022-12-17 00:35:04.672172 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0b569da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0b569fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0b569f60>]}
2022-12-17 00:35:04.724543 (MainThread): Partial parsing not enabled
2022-12-17 00:35:04.725918 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:35:04.732528 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:35:04.740402 (MainThread): Parsing macros/etc.sql
2022-12-17 00:35:04.743102 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:35:04.766790 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:35:04.770313 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:35:04.773826 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:35:04.791046 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:35:04.803476 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:35:04.808926 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:35:04.812276 (MainThread): Parsing macros/core.sql
2022-12-17 00:35:04.817173 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:35:04.870189 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:35:04.871549 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:35:04.883647 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:35:04.885782 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:35:04.887814 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:35:04.889157 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:35:04.891696 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:35:04.893938 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:35:04.896317 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:35:04.899776 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:35:04.901737 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:35:04.913017 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:35:04.921220 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:35:04.923584 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:35:04.931414 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:35:04.948489 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:35:04.950728 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:35:04.972366 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:35:05.010949 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:35:05.036325 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:35:05.043896 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:35:05.057057 (MainThread): Partial parsing not enabled
2022-12-17 00:35:05.116632 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:35:05.149994 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:35:05.166721 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:35:05.186564 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:35:05.203643 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:35:05.424481 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48576b3a-8e35-437c-b2e1-64227ad08f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0b3d70b8>]}
2022-12-17 00:35:05.478203 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:35:05.479684 (MainThread): 
2022-12-17 00:35:05.480218 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:35:05.489082 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:35:05.489433 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:35:05.641810 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:35:05.642186 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:35:05.647504 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:35:05.772624 (MainThread): 00:35:05 | Concurrency: 1 threads (target='dev')
2022-12-17 00:35:05.772887 (MainThread): 00:35:05 | 
2022-12-17 00:35:05.775076 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:35:05.776544 (Thread-1): 00:35:05 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:35:05.777324 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:35:05.777522 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:35:05.799474 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:35:05.799992 (Thread-1): finished collecting timing info
2022-12-17 00:35:05.827302 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:35:05.832762 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:35:05.992217 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:35:05.992801 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    -- CASE payment_type,
    --     WHEN "CASH_IN" THEN 1
    --     WHEN "CASH_OUT" THEN 2
    --     WHEN "DEBIT" THEN 3
    --     WHEN "PAYMENT" THEN 4
    --     WHEN "TRANSFER" THEN 5
    -- END AS id_payment_type,
    -- COUNT(*) AS total_of_payment_type
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:35:19.442735 (Thread-1): finished collecting timing info
2022-12-17 00:35:19.443766 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48576b3a-8e35-437c-b2e1-64227ad08f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0b55cfd0>]}
2022-12-17 00:35:19.445186 (Thread-1): 00:35:19 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 13.67s]
2022-12-17 00:35:19.445379 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:35:19.446292 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:35:19.447939 (Thread-1): 00:35:19 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 00:35:19.448352 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:35:19.448543 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:35:19.459487 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:35:19.459911 (Thread-1): finished collecting timing info
2022-12-17 00:35:19.465247 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:35:19.470397 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:35:19.610925 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:35:19.611725 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT DISTINCT
    case payment_type
        when payment_type "CASH_IN" THEN 1
        when payment_type "CASH_OUT" THEN 2
        when payment_type "DEBIT" THEN 3
        when payment_type "PAYMENT" THEN 4
    end as id_payment_type
    --     case 
    --     when  "CASH_IN" THEN 1
    --     when  "CASH_OUT" THEN 2
    --     when  "DEBIT" THEN 3
    --     when  "PAYMENT" THEN 4
    -- end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    payment_type
FROM 
    dim_payment_type
  );
    
2022-12-17 00:35:19.830131 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/7b82de85-c70c-4cd1-b4c2-fdeded4bc129?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [14:27]',)
2022-12-17 00:35:20.834222 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 35688), raddr=('142.250.136.95', 443)>
2022-12-17 00:35:20.834534 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 39284), raddr=('173.194.192.95', 443)>
2022-12-17 00:35:20.834695 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 35692), raddr=('142.250.136.95', 443)>
2022-12-17 00:35:20.834825 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 39288), raddr=('173.194.192.95', 443)>
2022-12-17 00:35:20.835082 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 35706), raddr=('142.250.136.95', 443)>
2022-12-17 00:35:20.835347 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 39302), raddr=('173.194.192.95', 443)>
2022-12-17 00:35:21.016850 (Thread-1): finished collecting timing info
2022-12-17 00:35:21.017752 (Thread-1): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [14:27]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/ac91c87a-261e-41f9-a750-6e5576d81bed?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [14:27]

(job ID: ac91c87a-261e-41f9-a750-6e5576d81bed)

                                                                     -----Query Job SQL Follows-----                                                                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:WITH dim_payment_type AS(
  12:    SELECT DISTINCT
  13:    case payment_type
  14:        when payment_type "CASH_IN" THEN 1
  15:        when payment_type "CASH_OUT" THEN 2
  16:        when payment_type "DEBIT" THEN 3
  17:        when payment_type "PAYMENT" THEN 4
  18:    end as id_payment_type
  19:    --     case 
  20:    --     when  "CASH_IN" THEN 1
  21:    --     when  "CASH_OUT" THEN 2
  22:    --     when  "DEBIT" THEN 3
  23:    --     when  "PAYMENT" THEN 4
  24:    -- end as id_payment_type
  25:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  26:)
  27:
  28:SELECT 
  29:    payment_type
  30:FROM 
  31:    dim_payment_type
  32:  );
  33:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [14:27]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:35:21.021865 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48576b3a-8e35-437c-b2e1-64227ad08f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0a34ceb8>]}
2022-12-17 00:35:21.023438 (Thread-1): 00:35:21 | 2 of 5 ERROR creating table model timestamp_fraud_complete.dim_payment_type [ERROR in 1.57s]
2022-12-17 00:35:21.023681 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:35:21.023974 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:35:21.025577 (Thread-1): 00:35:21 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 00:35:21.026070 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:35:21.026257 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:35:21.036848 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:35:21.037358 (Thread-1): finished collecting timing info
2022-12-17 00:35:21.042876 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:35:21.048095 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:35:21.176788 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:35:21.177398 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 00:35:27.194213 (Thread-1): finished collecting timing info
2022-12-17 00:35:27.195199 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48576b3a-8e35-437c-b2e1-64227ad08f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0b243438>]}
2022-12-17 00:35:27.196609 (Thread-1): 00:35:27 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.17s]
2022-12-17 00:35:27.196803 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:35:27.197091 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:35:27.198599 (Thread-1): 00:35:27 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 00:35:27.199042 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:35:27.199210 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:35:27.209497 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:35:27.209966 (Thread-1): finished collecting timing info
2022-12-17 00:35:27.215484 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:35:27.220722 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:35:27.369418 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:35:27.369987 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 00:35:34.070904 (Thread-1): finished collecting timing info
2022-12-17 00:35:34.071965 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48576b3a-8e35-437c-b2e1-64227ad08f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0a215f60>]}
2022-12-17 00:35:34.073355 (Thread-1): 00:35:34 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.87s]
2022-12-17 00:35:34.073555 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:35:34.073823 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:35:34.075342 (Thread-1): 00:35:34 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 00:35:34.075891 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:35:34.076090 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:35:34.076852 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 56292), raddr=('108.177.112.95', 443)>
2022-12-17 00:35:34.077103 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 44476), raddr=('142.250.128.95', 443)>
2022-12-17 00:35:34.086966 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:35:34.087474 (Thread-1): finished collecting timing info
2022-12-17 00:35:34.092869 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:35:34.098054 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:35:34.252738 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:35:34.253294 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 00:35:46.082221 (Thread-1): finished collecting timing info
2022-12-17 00:35:46.083249 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48576b3a-8e35-437c-b2e1-64227ad08f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0a1ce668>]}
2022-12-17 00:35:46.084680 (Thread-1): 00:35:46 | 5 of 5 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 579.0 MB processed) in 12.01s]
2022-12-17 00:35:46.084896 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:35:46.165308 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:35:46.165819 (MainThread): 00:35:46 | 
2022-12-17 00:35:46.165985 (MainThread): 00:35:46 | Finished running 5 table models in 40.69s.
2022-12-17 00:35:46.166103 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:35:46.166177 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:35:46.218004 (MainThread): 
2022-12-17 00:35:46.218229 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:35:46.218346 (MainThread): 
2022-12-17 00:35:46.218452 (MainThread): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
2022-12-17 00:35:46.218544 (MainThread):   Syntax error: Unexpected string literal "CASH_IN" at [14:27]
2022-12-17 00:35:46.218630 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:35:46.218738 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-12-17 00:35:46.218935 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0a34cb38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0a205ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0b38ba58>]}
2022-12-17 00:35:46.219146 (MainThread): Flushing usage events
2022-12-17 00:42:27.475870 (MainThread): Running with dbt=0.19.0
2022-12-17 00:42:28.222331 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:42:28.223214 (MainThread): Tracking: tracking
2022-12-17 00:42:28.231857 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8ab61e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8ab61fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8ab761d0>]}
2022-12-17 00:42:28.282693 (MainThread): Partial parsing not enabled
2022-12-17 00:42:28.284231 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:42:28.290937 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:42:28.299077 (MainThread): Parsing macros/etc.sql
2022-12-17 00:42:28.301815 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:42:28.326330 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:42:28.330081 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:42:28.333723 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:42:28.350405 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:42:28.362547 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:42:28.368074 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:42:28.371384 (MainThread): Parsing macros/core.sql
2022-12-17 00:42:28.376369 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:42:28.430784 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:42:28.432238 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:42:28.443656 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:42:28.445884 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:42:28.448041 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:42:28.449438 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:42:28.452048 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:42:28.454268 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:42:28.456742 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:42:28.460198 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:42:28.462239 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:42:28.473901 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:42:28.482252 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:42:28.484627 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:42:28.492464 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:42:28.510128 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:42:28.512548 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:42:28.536470 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:42:28.574618 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:42:28.600375 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:42:28.608092 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:42:28.621801 (MainThread): Partial parsing not enabled
2022-12-17 00:42:28.684762 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:42:28.719104 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:42:28.735763 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:42:28.755609 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:42:28.773011 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:42:29.001775 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0063d487-cc98-483c-8d3f-770e7190c2e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8a9d0748>]}
2022-12-17 00:42:29.055449 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:42:29.056744 (MainThread): 
2022-12-17 00:42:29.057275 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:42:29.068049 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:42:29.068381 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:42:29.240515 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:42:29.240891 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:42:29.246439 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:42:29.377642 (MainThread): 00:42:29 | Concurrency: 1 threads (target='dev')
2022-12-17 00:42:29.377950 (MainThread): 00:42:29 | 
2022-12-17 00:42:29.380251 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:42:29.381775 (Thread-1): 00:42:29 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:42:29.382201 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:42:29.382367 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:42:29.406163 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:42:29.406741 (Thread-1): finished collecting timing info
2022-12-17 00:42:29.434413 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:42:29.439695 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:42:29.611793 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:42:29.612405 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type,
        CASE type,
         WHEN "CASH_IN" THEN 1
         WHEN "CASH_OUT" THEN 2
         WHEN "DEBIT" THEN 3
         WHEN "PAYMENT" THEN 4
         WHEN "TRANSFER" THEN 5
     END AS id_payment_type,
    -- COUNT(*) AS total_of_payment_type
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:42:29.784498 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/0e333216-43d6-462f-9b71-6fc3f32f5a74?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [17:18]',)
2022-12-17 00:42:30.981168 (Thread-1): finished collecting timing info
2022-12-17 00:42:30.982255 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [17:18]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/b0d3d70e-0d7d-4c16-9071-b285dccd953b?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [17:18]

(job ID: b0d3d70e-0d7d-4c16-9071-b285dccd953b)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type,
  17:        CASE type,
  18:         WHEN "CASH_IN" THEN 1
  19:         WHEN "CASH_OUT" THEN 2
  20:         WHEN "DEBIT" THEN 3
  21:         WHEN "PAYMENT" THEN 4
  22:         WHEN "TRANSFER" THEN 5
  23:     END AS id_payment_type,
  24:    -- COUNT(*) AS total_of_payment_type
  25:    amount,
  26:    nameOrig as name_sender,
  27:    oldbalanceOrg as old_balance_sender,
  28:    newbalanceOrig as new_balance_sender,
  29:    nameDest as name_recipient,
  30:    oldbalanceDest as old_balance_recipient,
  31:    newbalanceDest as new_balance_recipient,
  32:    case isFraud
  33:        when 0 then "Not Fraud"
  34:        when 1 then "Fraud"
  35:    end as is_fraud,
  36:    case isFlaggedFraud
  37:        when 0 then "Not Fraud"
  38:        when 1 then "Fraud"
  39:    end as is_flagged_fraud,
  40:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  41:ORDER BY timestamp, step
  42:  );
  43:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [17:18]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:42:30.988353 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0063d487-cc98-483c-8d3f-770e7190c2e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8a7c8080>]}
2022-12-17 00:42:30.989948 (Thread-1): 00:42:30 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 1.61s]
2022-12-17 00:42:30.990211 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:42:30.991357 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:42:30.991684 (Thread-1): 00:42:30 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-17 00:42:30.992642 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:42:30.992931 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:42:30.993243 (Thread-1): 00:42:30 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-17 00:42:30.993546 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:42:30.994326 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:42:30.994619 (Thread-1): 00:42:30 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-17 00:42:30.994835 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:42:30.995051 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:42:30.995448 (Thread-1): 00:42:30 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-17 00:42:30.995743 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:42:31.083943 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:42:31.084683 (MainThread): 00:42:31 | 
2022-12-17 00:42:31.085060 (MainThread): 00:42:31 | Finished running 5 table models in 2.03s.
2022-12-17 00:42:31.085254 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:42:31.085356 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-17 00:42:31.145312 (MainThread): 
2022-12-17 00:42:31.145588 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:42:31.145782 (MainThread): 
2022-12-17 00:42:31.145999 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-17 00:42:31.146198 (MainThread):   Syntax error: Unexpected "," at [17:18]
2022-12-17 00:42:31.146380 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:42:31.146596 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-17 00:42:31.146928 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8ab4ac18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8a9bd908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8a8d4d30>]}
2022-12-17 00:42:31.147288 (MainThread): Flushing usage events
2022-12-17 00:43:15.597479 (MainThread): Running with dbt=0.19.0
2022-12-17 00:43:16.279533 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:43:16.280736 (MainThread): Tracking: tracking
2022-12-17 00:43:16.289356 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4339a09e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4339a09fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4339a1e1d0>]}
2022-12-17 00:43:16.342504 (MainThread): Partial parsing not enabled
2022-12-17 00:43:16.344039 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:43:16.350551 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:43:16.358502 (MainThread): Parsing macros/etc.sql
2022-12-17 00:43:16.361301 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:43:16.386213 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:43:16.390881 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:43:16.394765 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:43:16.410857 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:43:16.423144 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:43:16.428628 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:43:16.431938 (MainThread): Parsing macros/core.sql
2022-12-17 00:43:16.436943 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:43:16.491129 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:43:16.492579 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:43:16.504011 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:43:16.506234 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:43:16.508340 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:43:16.509737 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:43:16.512567 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:43:16.514779 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:43:16.517277 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:43:16.520702 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:43:16.522703 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:43:16.533985 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:43:16.542459 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:43:16.544876 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:43:16.552712 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:43:16.569907 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:43:16.572315 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:43:16.595047 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:43:16.633205 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:43:16.658707 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:43:16.666441 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:43:16.680829 (MainThread): Partial parsing not enabled
2022-12-17 00:43:16.744308 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:43:16.778910 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:43:16.796606 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:43:16.816629 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:43:16.834644 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:43:17.066800 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ee39caa-9fd6-43b2-8749-7b0802b44c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43396a6fd0>]}
2022-12-17 00:43:17.121942 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:43:17.123484 (MainThread): 
2022-12-17 00:43:17.124032 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:43:17.132775 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:43:17.133205 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:43:17.324258 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:43:17.324684 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:43:17.330015 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:43:17.457281 (MainThread): 00:43:17 | Concurrency: 1 threads (target='dev')
2022-12-17 00:43:17.457666 (MainThread): 00:43:17 | 
2022-12-17 00:43:17.460468 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:43:17.462018 (Thread-1): 00:43:17 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:43:17.462554 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:43:17.462799 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:43:17.485316 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:43:17.485767 (Thread-1): finished collecting timing info
2022-12-17 00:43:17.515505 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:43:17.520727 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:43:17.704427 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:43:17.704982 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    -- COUNT(*) AS total_of_payment_type
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    type,
        CASE type,
         WHEN "CASH_IN" THEN 1
         WHEN "CASH_OUT" THEN 2
         WHEN "DEBIT" THEN 3
         WHEN "PAYMENT" THEN 4
         WHEN "TRANSFER" THEN 5
     END AS id_payment_type,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:43:17.910392 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/744efa4c-9432-4eeb-a308-51140cca38ae?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [33:18]',)
2022-12-17 00:43:18.712789 (Thread-1): finished collecting timing info
2022-12-17 00:43:18.713907 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [33:18]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/8a816a4c-8c57-49d4-a32e-583aeebc4d7a?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [33:18]

(job ID: 8a816a4c-8c57-49d4-a32e-583aeebc4d7a)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    -- COUNT(*) AS total_of_payment_type
  17:    amount,
  18:    nameOrig as name_sender,
  19:    oldbalanceOrg as old_balance_sender,
  20:    newbalanceOrig as new_balance_sender,
  21:    nameDest as name_recipient,
  22:    oldbalanceDest as old_balance_recipient,
  23:    newbalanceDest as new_balance_recipient,
  24:    case isFraud
  25:        when 0 then "Not Fraud"
  26:        when 1 then "Fraud"
  27:    end as is_fraud,
  28:    case isFlaggedFraud
  29:        when 0 then "Not Fraud"
  30:        when 1 then "Fraud"
  31:    end as is_flagged_fraud,
  32:    type,
  33:        CASE type,
  34:         WHEN "CASH_IN" THEN 1
  35:         WHEN "CASH_OUT" THEN 2
  36:         WHEN "DEBIT" THEN 3
  37:         WHEN "PAYMENT" THEN 4
  38:         WHEN "TRANSFER" THEN 5
  39:     END AS id_payment_type,
  40:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  41:ORDER BY timestamp, step
  42:  );
  43:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [33:18]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:43:18.718961 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee39caa-9fd6-43b2-8749-7b0802b44c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f433966f518>]}
2022-12-17 00:43:18.720597 (Thread-1): 00:43:18 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 1.26s]
2022-12-17 00:43:18.720858 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:43:18.721638 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:43:18.721945 (Thread-1): 00:43:18 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-17 00:43:18.722212 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:43:18.722480 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:43:18.722843 (Thread-1): 00:43:18 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-17 00:43:18.723163 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:43:18.723471 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:43:18.723833 (Thread-1): 00:43:18 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-17 00:43:18.724067 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:43:18.724296 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:43:18.724643 (Thread-1): 00:43:18 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-17 00:43:18.725386 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:43:18.762711 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:43:18.763217 (MainThread): 00:43:18 | 
2022-12-17 00:43:18.763431 (MainThread): 00:43:18 | Finished running 5 table models in 1.64s.
2022-12-17 00:43:18.763604 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:43:18.763755 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-17 00:43:18.814160 (MainThread): 
2022-12-17 00:43:18.814401 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:43:18.814573 (MainThread): 
2022-12-17 00:43:18.814770 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-17 00:43:18.814972 (MainThread):   Syntax error: Unexpected "," at [33:18]
2022-12-17 00:43:18.815149 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:43:18.815356 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-17 00:43:18.815726 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f433972b5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4339685128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43399e4940>]}
2022-12-17 00:43:18.816087 (MainThread): Flushing usage events
2022-12-17 00:44:12.148846 (MainThread): Running with dbt=0.19.0
2022-12-17 00:44:12.828337 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:44:12.829450 (MainThread): Tracking: tracking
2022-12-17 00:44:12.837982 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc594deae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc594deaf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc594deafd0>]}
2022-12-17 00:44:12.869248 (MainThread): Partial parsing not enabled
2022-12-17 00:44:12.870320 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:44:12.875071 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:44:12.882898 (MainThread): Parsing macros/etc.sql
2022-12-17 00:44:12.885621 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:44:12.910459 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:44:12.914237 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:44:12.917808 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:44:12.933878 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:44:12.946092 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:44:12.951672 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:44:12.955144 (MainThread): Parsing macros/core.sql
2022-12-17 00:44:12.960110 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:44:13.015852 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:44:13.017297 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:44:13.028461 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:44:13.030710 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:44:13.032888 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:44:13.034305 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:44:13.037010 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:44:13.039258 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:44:13.041783 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:44:13.045292 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:44:13.047413 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:44:13.059027 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:44:13.067299 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:44:13.069851 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:44:13.077552 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:44:13.094579 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:44:13.096886 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:44:13.119343 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:44:13.157329 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:44:13.182837 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:44:13.190553 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:44:13.204187 (MainThread): Partial parsing not enabled
2022-12-17 00:44:13.263601 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:44:13.297816 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:44:13.314675 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:44:13.333870 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:44:13.350450 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:44:13.572915 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd12a0bef-a2ba-44c5-b5d3-d24af7bbca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc594a85b38>]}
2022-12-17 00:44:13.626253 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:44:13.627587 (MainThread): 
2022-12-17 00:44:13.628089 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:44:13.636916 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:44:13.637303 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:44:13.797043 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:44:13.797486 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:44:13.802900 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:44:13.914707 (MainThread): 00:44:13 | Concurrency: 1 threads (target='dev')
2022-12-17 00:44:13.915004 (MainThread): 00:44:13 | 
2022-12-17 00:44:13.917350 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:44:13.918826 (Thread-1): 00:44:13 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:44:13.919431 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:44:13.919675 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:44:13.941426 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:44:13.942040 (Thread-1): finished collecting timing info
2022-12-17 00:44:13.968297 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:44:13.973957 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:44:14.134130 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:44:14.134802 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    -- COUNT(*) AS total_of_payment_type
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    type,
        CASE type,
         WHEN "CASH_IN" THEN 1
         WHEN "CASH_OUT" THEN 2
         WHEN "DEBIT" THEN 3
         WHEN "PAYMENT" THEN 4
         WHEN "TRANSFER" THEN 5
     END AS id_payment_type,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:44:14.345924 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/bdbaff6d-07b0-4de5-9ccc-c5950075fec6?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [33:18]',)
2022-12-17 00:44:15.548709 (Thread-1): finished collecting timing info
2022-12-17 00:44:15.549873 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [33:18]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/7f1cf639-09c2-45ee-bf5c-3c9ee9bc258f?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [33:18]

(job ID: 7f1cf639-09c2-45ee-bf5c-3c9ee9bc258f)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    -- COUNT(*) AS total_of_payment_type
  17:    amount,
  18:    nameOrig as name_sender,
  19:    oldbalanceOrg as old_balance_sender,
  20:    newbalanceOrig as new_balance_sender,
  21:    nameDest as name_recipient,
  22:    oldbalanceDest as old_balance_recipient,
  23:    newbalanceDest as new_balance_recipient,
  24:    case isFraud
  25:        when 0 then "Not Fraud"
  26:        when 1 then "Fraud"
  27:    end as is_fraud,
  28:    case isFlaggedFraud
  29:        when 0 then "Not Fraud"
  30:        when 1 then "Fraud"
  31:    end as is_flagged_fraud,
  32:    type,
  33:        CASE type,
  34:         WHEN "CASH_IN" THEN 1
  35:         WHEN "CASH_OUT" THEN 2
  36:         WHEN "DEBIT" THEN 3
  37:         WHEN "PAYMENT" THEN 4
  38:         WHEN "TRANSFER" THEN 5
  39:     END AS id_payment_type,
  40:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  41:ORDER BY timestamp, step
  42:  );
  43:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Unexpected "," at [33:18]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:44:15.553799 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12a0bef-a2ba-44c5-b5d3-d24af7bbca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc594a514e0>]}
2022-12-17 00:44:15.555458 (Thread-1): 00:44:15 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 1.63s]
2022-12-17 00:44:15.555713 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:44:15.556347 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:44:15.556582 (Thread-1): 00:44:15 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-17 00:44:15.556783 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:44:15.556996 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:44:15.557351 (Thread-1): 00:44:15 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-17 00:44:15.557614 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:44:15.557821 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:44:15.558143 (Thread-1): 00:44:15 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-17 00:44:15.558345 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:44:15.558532 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:44:15.558877 (Thread-1): 00:44:15 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-17 00:44:15.559090 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:44:15.625908 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:44:15.626529 (MainThread): 00:44:15 | 
2022-12-17 00:44:15.626763 (MainThread): 00:44:15 | Finished running 5 table models in 2.00s.
2022-12-17 00:44:15.626937 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:44:15.627050 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-17 00:44:15.682282 (MainThread): 
2022-12-17 00:44:15.682591 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:44:15.682786 (MainThread): 
2022-12-17 00:44:15.682948 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-17 00:44:15.683092 (MainThread):   Syntax error: Unexpected "," at [33:18]
2022-12-17 00:44:15.683227 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:44:15.683390 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-17 00:44:15.683689 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc594dcfbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc594dd37b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc594da0978>]}
2022-12-17 00:44:15.683961 (MainThread): Flushing usage events
2022-12-17 00:44:37.510247 (MainThread): Running with dbt=0.19.0
2022-12-17 00:44:38.188409 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:44:38.189673 (MainThread): Tracking: tracking
2022-12-17 00:44:38.198416 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc89bae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc89baf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc89bafd0>]}
2022-12-17 00:44:38.249909 (MainThread): Partial parsing not enabled
2022-12-17 00:44:38.251297 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:44:38.258459 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:44:38.266208 (MainThread): Parsing macros/etc.sql
2022-12-17 00:44:38.268861 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:44:38.292906 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:44:38.296465 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:44:38.299943 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:44:38.316145 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:44:38.328192 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:44:38.333581 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:44:38.336765 (MainThread): Parsing macros/core.sql
2022-12-17 00:44:38.341632 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:44:38.394815 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:44:38.396198 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:44:38.407750 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:44:38.410079 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:44:38.412192 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:44:38.413586 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:44:38.416273 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:44:38.418448 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:44:38.420832 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:44:38.424199 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:44:38.426147 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:44:38.437527 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:44:38.445904 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:44:38.448222 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:44:38.456356 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:44:38.474459 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:44:38.476761 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:44:38.498531 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:44:38.538711 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:44:38.565802 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:44:38.573548 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:44:38.586967 (MainThread): Partial parsing not enabled
2022-12-17 00:44:38.646250 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:44:38.680150 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:44:38.696829 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:44:38.716354 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:44:38.733035 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:44:38.951964 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a84ee116-14b5-43a2-843d-977e81ed2923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc8655e48>]}
2022-12-17 00:44:39.005106 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:44:39.006347 (MainThread): 
2022-12-17 00:44:39.006808 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:44:39.015741 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:44:39.016015 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:44:39.172747 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:44:39.173184 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:44:39.178442 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:44:39.335408 (MainThread): 00:44:39 | Concurrency: 1 threads (target='dev')
2022-12-17 00:44:39.335796 (MainThread): 00:44:39 | 
2022-12-17 00:44:39.338362 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:44:39.340507 (Thread-1): 00:44:39 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:44:39.341083 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:44:39.341319 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:44:39.363300 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:44:39.363800 (Thread-1): finished collecting timing info
2022-12-17 00:44:39.391884 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:44:39.397273 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:44:39.569054 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:44:39.569849 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:44:52.185650 (Thread-1): finished collecting timing info
2022-12-17 00:44:52.186745 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84ee116-14b5-43a2-843d-977e81ed2923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc8935390>]}
2022-12-17 00:44:52.188271 (Thread-1): 00:44:52 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 645.5 MB processed) in 12.85s]
2022-12-17 00:44:52.188572 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:44:52.189311 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:44:52.191025 (Thread-1): 00:44:52 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 00:44:52.191567 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:44:52.191823 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:44:52.203090 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:44:52.203589 (Thread-1): finished collecting timing info
2022-12-17 00:44:52.208832 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:44:52.213958 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:44:52.361392 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:44:52.362162 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT DISTINCT
    case 
        when  "CASH_IN" THEN 1
        when  "CASH_OUT" THEN 2
        when  "DEBIT" THEN 3
        when  "PAYMENT" THEN 4
    end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    payment_type,
    case 
        when  "CASH_IN" THEN 1
        when  "CASH_OUT" THEN 2
        when  "DEBIT" THEN 3
        when  "PAYMENT" THEN 4
    end as id_payment_type
FROM 
    dim_payment_type
  );
    
2022-12-17 00:44:52.856340 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/6a6adc51-e7a5-4891-b849-108aad06e566?maxResults=0&location=US&prettyPrint=false: No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [13:5]',)
2022-12-17 00:44:53.860531 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44680), raddr=('172.217.219.95', 443)>
2022-12-17 00:44:53.860857 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 41812), raddr=('172.253.119.95', 443)>
2022-12-17 00:44:53.861049 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44692), raddr=('172.217.219.95', 443)>
2022-12-17 00:44:53.861272 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 41820), raddr=('172.253.119.95', 443)>
2022-12-17 00:44:53.861534 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44698), raddr=('172.217.219.95', 443)>
2022-12-17 00:44:53.861746 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 41834), raddr=('172.253.119.95', 443)>
2022-12-17 00:44:54.380427 (Thread-1): finished collecting timing info
2022-12-17 00:44:54.381360 (Thread-1): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [13:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/87120f6d-9179-44e7-ae18-e1c10c2a6cc9?maxResults=0&location=US&prettyPrint=false: No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [13:5]

(job ID: 87120f6d-9179-44e7-ae18-e1c10c2a6cc9)

                                                                     -----Query Job SQL Follows-----                                                                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:WITH dim_payment_type AS(
  12:    SELECT DISTINCT
  13:    case 
  14:        when  "CASH_IN" THEN 1
  15:        when  "CASH_OUT" THEN 2
  16:        when  "DEBIT" THEN 3
  17:        when  "PAYMENT" THEN 4
  18:    end as id_payment_type
  19:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  20:)
  21:
  22:SELECT 
  23:    payment_type,
  24:    case 
  25:        when  "CASH_IN" THEN 1
  26:        when  "CASH_OUT" THEN 2
  27:        when  "DEBIT" THEN 3
  28:        when  "PAYMENT" THEN 4
  29:    end as id_payment_type
  30:FROM 
  31:    dim_payment_type
  32:  );
  33:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [13:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:44:54.385302 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84ee116-14b5-43a2-843d-977e81ed2923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc81d3ef0>]}
2022-12-17 00:44:54.386932 (Thread-1): 00:44:54 | 2 of 5 ERROR creating table model timestamp_fraud_complete.dim_payment_type [ERROR in 2.19s]
2022-12-17 00:44:54.387239 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:44:54.387511 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:44:54.389215 (Thread-1): 00:44:54 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 00:44:54.389711 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:44:54.389931 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:44:54.399948 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:44:54.400463 (Thread-1): finished collecting timing info
2022-12-17 00:44:54.405694 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:44:54.410838 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:44:54.570802 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:44:54.571492 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 00:45:00.952224 (Thread-1): finished collecting timing info
2022-12-17 00:45:00.953298 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84ee116-14b5-43a2-843d-977e81ed2923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc8161278>]}
2022-12-17 00:45:00.954767 (Thread-1): 00:45:00 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.56s]
2022-12-17 00:45:00.954998 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:45:00.955201 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:45:00.956464 (Thread-1): 00:45:00 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 00:45:00.957166 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:45:00.957436 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:45:00.967713 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:45:00.968245 (Thread-1): finished collecting timing info
2022-12-17 00:45:00.973580 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:45:00.978805 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:45:01.151271 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:45:01.152049 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 00:45:07.284662 (Thread-1): finished collecting timing info
2022-12-17 00:45:07.285801 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84ee116-14b5-43a2-843d-977e81ed2923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc8094668>]}
2022-12-17 00:45:07.287664 (Thread-1): 00:45:07 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.33s]
2022-12-17 00:45:07.287926 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:45:07.288180 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:45:07.289568 (Thread-1): 00:45:07 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 00:45:07.290027 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:45:07.290254 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:45:07.300244 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:45:07.300804 (Thread-1): finished collecting timing info
2022-12-17 00:45:07.306156 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:45:07.311562 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:45:07.453212 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:45:07.453968 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 00:45:08.128328 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/5772656a-a804-4b80-a80c-955fc0805ab4?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]',)
2022-12-17 00:45:08.787307 (Thread-1): finished collecting timing info
2022-12-17 00:45:08.788159 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/4455a26b-72f9-4cc9-bc84-bbdda14790eb?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]

(job ID: 4455a26b-72f9-4cc9-bc84-bbdda14790eb)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    id_transaction,
  18:    step,
  19:    timestamp,
  20:    payment_type,
  21:    amount,
  22:    old_balance_sender,
  23:    new_balance_sender,
  24:    old_balance_recipient,
  25:    new_balance_recipient,
  26:    is_fraud,
  27:    is_flagged_fraud
  28:FROM
  29:    fact_raw_fraud
  30:  );
  31:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 00:45:08.789024 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84ee116-14b5-43a2-843d-977e81ed2923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc8033cc0>]}
2022-12-17 00:45:08.790545 (Thread-1): 00:45:08 | 5 of 5 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 1.50s]
2022-12-17 00:45:08.790780 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:45:08.802147 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:45:08.802596 (MainThread): 00:45:08 | 
2022-12-17 00:45:08.802759 (MainThread): 00:45:08 | Finished running 5 table models in 29.80s.
2022-12-17 00:45:08.802878 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:45:08.802960 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:45:08.853796 (MainThread): 
2022-12-17 00:45:08.854033 (MainThread): Completed with 2 errors and 0 warnings:
2022-12-17 00:45:08.854176 (MainThread): 
2022-12-17 00:45:08.854324 (MainThread): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
2022-12-17 00:45:08.854435 (MainThread):   No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [13:5]
2022-12-17 00:45:08.854527 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:45:08.854617 (MainThread): 
2022-12-17 00:45:08.854716 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-17 00:45:08.854805 (MainThread):   Unrecognized name: amount at [21:5]
2022-12-17 00:45:08.854885 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 00:45:08.854986 (MainThread): 
Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
2022-12-17 00:45:08.855207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc81b9668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc8061d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdc81abeb8>]}
2022-12-17 00:45:08.855481 (MainThread): Flushing usage events
2022-12-17 00:45:36.133024 (MainThread): Running with dbt=0.19.0
2022-12-17 00:45:36.812570 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:45:36.813861 (MainThread): Tracking: tracking
2022-12-17 00:45:36.822911 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b7bd3e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b7bd3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b7be81d0>]}
2022-12-17 00:45:36.854464 (MainThread): Partial parsing not enabled
2022-12-17 00:45:36.855942 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:45:36.861395 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:45:36.869378 (MainThread): Parsing macros/etc.sql
2022-12-17 00:45:36.872317 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:45:36.896078 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:45:36.899796 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:45:36.903476 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:45:36.919449 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:45:36.931601 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:45:36.937024 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:45:36.940296 (MainThread): Parsing macros/core.sql
2022-12-17 00:45:36.945215 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:45:36.997826 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:45:36.999277 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:45:37.010659 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:45:37.013100 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:45:37.015239 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:45:37.016727 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:45:37.019391 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:45:37.021640 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:45:37.024146 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:45:37.027569 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:45:37.029626 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:45:37.040946 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:45:37.049182 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:45:37.051647 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:45:37.059340 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:45:37.076981 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:45:37.079348 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:45:37.101330 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:45:37.139248 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:45:37.164494 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:45:37.172351 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:45:37.185908 (MainThread): Partial parsing not enabled
2022-12-17 00:45:37.244931 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:45:37.278704 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:45:37.295571 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:45:37.313329 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:45:37.330296 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:45:37.551225 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ead5c4b-c7bc-4fcd-8229-e48e6a81d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b79df710>]}
2022-12-17 00:45:37.604199 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:45:37.605665 (MainThread): 
2022-12-17 00:45:37.606152 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:45:37.615119 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:45:37.615520 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:45:37.784394 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:45:37.784853 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:45:37.790208 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:45:37.943527 (MainThread): 00:45:37 | Concurrency: 1 threads (target='dev')
2022-12-17 00:45:37.943787 (MainThread): 00:45:37 | 
2022-12-17 00:45:37.946220 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:45:37.947749 (Thread-1): 00:45:37 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:45:37.948577 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:45:37.948797 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:45:37.970882 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:45:37.971512 (Thread-1): finished collecting timing info
2022-12-17 00:45:37.999246 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:45:38.004636 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:45:38.169676 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:45:38.170237 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:45:52.033057 (Thread-1): finished collecting timing info
2022-12-17 00:45:52.034042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ead5c4b-c7bc-4fcd-8229-e48e6a81d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87c9607860>]}
2022-12-17 00:45:52.035435 (Thread-1): 00:45:52 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 645.5 MB processed) in 14.09s]
2022-12-17 00:45:52.035634 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:45:52.036238 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:45:52.037626 (Thread-1): 00:45:52 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 00:45:52.038105 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:45:52.038262 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:45:52.048413 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:45:52.048833 (Thread-1): finished collecting timing info
2022-12-17 00:45:52.054181 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:45:52.059385 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:45:52.204422 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:45:52.205206 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT 
    payment_type,
    case 
        when  "CASH_IN" THEN 1
        when  "CASH_OUT" THEN 2
        when  "DEBIT" THEN 3
        when  "PAYMENT" THEN 4
    end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 

FROM 
    dim_payment_type
  );
    
2022-12-17 00:45:52.425227 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/9bf08b11-2364-472d-bc0d-71706d3640dc?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [25:1]',)
2022-12-17 00:45:53.113922 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 58240), raddr=('172.217.219.95', 443)>
2022-12-17 00:45:53.114321 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 56054), raddr=('172.253.119.95', 443)>
2022-12-17 00:45:53.114587 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 58250), raddr=('172.217.219.95', 443)>
2022-12-17 00:45:53.114803 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 56060), raddr=('172.253.119.95', 443)>
2022-12-17 00:45:53.115099 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 58252), raddr=('172.217.219.95', 443)>
2022-12-17 00:45:53.115316 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 56066), raddr=('172.253.119.95', 443)>
2022-12-17 00:45:53.339995 (Thread-1): finished collecting timing info
2022-12-17 00:45:53.340885 (Thread-1): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: SELECT list must not be empty at [25:1]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/45ca86c1-731e-41a2-a740-87463a4f7466?maxResults=0&location=US&prettyPrint=false: Syntax error: SELECT list must not be empty at [25:1]

(job ID: 45ca86c1-731e-41a2-a740-87463a4f7466)

                                                                     -----Query Job SQL Follows-----                                                                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:WITH dim_payment_type AS(
  12:    SELECT 
  13:    payment_type,
  14:    case 
  15:        when  "CASH_IN" THEN 1
  16:        when  "CASH_OUT" THEN 2
  17:        when  "DEBIT" THEN 3
  18:        when  "PAYMENT" THEN 4
  19:    end as id_payment_type
  20:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  21:)
  22:
  23:SELECT 
  24:
  25:FROM 
  26:    dim_payment_type
  27:  );
  28:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: SELECT list must not be empty at [25:1]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:45:53.344777 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ead5c4b-c7bc-4fcd-8229-e48e6a81d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b69b50f0>]}
2022-12-17 00:45:53.346302 (Thread-1): 00:45:53 | 2 of 5 ERROR creating table model timestamp_fraud_complete.dim_payment_type [ERROR in 1.31s]
2022-12-17 00:45:53.347294 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:45:53.347585 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:45:53.349100 (Thread-1): 00:45:53 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 00:45:53.349871 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:45:53.350052 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:45:53.360798 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:45:53.361273 (Thread-1): finished collecting timing info
2022-12-17 00:45:53.366517 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:45:53.371668 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:45:53.533982 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:45:53.534701 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 00:45:59.624325 (Thread-1): finished collecting timing info
2022-12-17 00:45:59.625435 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ead5c4b-c7bc-4fcd-8229-e48e6a81d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b695c828>]}
2022-12-17 00:45:59.626867 (Thread-1): 00:45:59 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.28s]
2022-12-17 00:45:59.627112 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:45:59.627362 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:45:59.629633 (Thread-1): 00:45:59 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 00:45:59.630098 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:45:59.630364 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:45:59.640527 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:45:59.641045 (Thread-1): finished collecting timing info
2022-12-17 00:45:59.646406 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:45:59.651602 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:45:59.816265 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:45:59.816993 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 00:46:05.634905 (Thread-1): finished collecting timing info
2022-12-17 00:46:05.636026 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ead5c4b-c7bc-4fcd-8229-e48e6a81d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b685df28>]}
2022-12-17 00:46:05.637804 (Thread-1): 00:46:05 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.01s]
2022-12-17 00:46:05.638063 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:46:05.638414 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:46:05.639876 (Thread-1): 00:46:05 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 00:46:05.640403 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:46:05.640625 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:46:05.650578 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:46:05.650976 (Thread-1): finished collecting timing info
2022-12-17 00:46:05.656078 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:46:05.661254 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:46:05.864267 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:46:05.864816 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 00:46:06.176294 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/cc18e30f-7b93-4cc2-87e8-6d2d60a80bf8?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]',)
2022-12-17 00:46:07.794700 (Thread-1): finished collecting timing info
2022-12-17 00:46:07.795570 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/efbebffb-4b91-422c-b0c2-62797b38b826?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]

(job ID: efbebffb-4b91-422c-b0c2-62797b38b826)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    id_transaction,
  18:    step,
  19:    timestamp,
  20:    payment_type,
  21:    amount,
  22:    old_balance_sender,
  23:    new_balance_sender,
  24:    old_balance_recipient,
  25:    new_balance_recipient,
  26:    is_fraud,
  27:    is_flagged_fraud
  28:FROM
  29:    fact_raw_fraud
  30:  );
  31:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 00:46:07.796439 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ead5c4b-c7bc-4fcd-8229-e48e6a81d9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b6829e48>]}
2022-12-17 00:46:07.797971 (Thread-1): 00:46:07 | 5 of 5 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 2.16s]
2022-12-17 00:46:07.798193 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:46:07.809063 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:46:07.809507 (MainThread): 00:46:07 | 
2022-12-17 00:46:07.809716 (MainThread): 00:46:07 | Finished running 5 table models in 30.20s.
2022-12-17 00:46:07.809910 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:46:07.810044 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:46:07.860917 (MainThread): 
2022-12-17 00:46:07.861180 (MainThread): Completed with 2 errors and 0 warnings:
2022-12-17 00:46:07.861387 (MainThread): 
2022-12-17 00:46:07.861571 (MainThread): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
2022-12-17 00:46:07.861770 (MainThread):   Syntax error: SELECT list must not be empty at [25:1]
2022-12-17 00:46:07.861940 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:46:07.862126 (MainThread): 
2022-12-17 00:46:07.862323 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-17 00:46:07.862496 (MainThread):   Unrecognized name: amount at [21:5]
2022-12-17 00:46:07.862652 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 00:46:07.862831 (MainThread): 
Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
2022-12-17 00:46:07.863143 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b785c4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87c9545550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b69ccef0>]}
2022-12-17 00:46:07.863548 (MainThread): Flushing usage events
2022-12-17 00:46:28.712635 (MainThread): Running with dbt=0.19.0
2022-12-17 00:46:29.389091 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:46:29.390153 (MainThread): Tracking: tracking
2022-12-17 00:46:29.398420 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45332950b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4533295f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4533295f98>]}
2022-12-17 00:46:29.439253 (MainThread): Partial parsing not enabled
2022-12-17 00:46:29.440270 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:46:29.444892 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:46:29.452680 (MainThread): Parsing macros/etc.sql
2022-12-17 00:46:29.455292 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:46:29.479261 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:46:29.483039 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:46:29.486476 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:46:29.502696 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:46:29.514817 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:46:29.520268 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:46:29.523471 (MainThread): Parsing macros/core.sql
2022-12-17 00:46:29.528403 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:46:29.580847 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:46:29.582365 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:46:29.593461 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:46:29.595631 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:46:29.597653 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:46:29.599031 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:46:29.601681 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:46:29.603881 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:46:29.606224 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:46:29.609577 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:46:29.611683 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:46:29.622828 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:46:29.631097 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:46:29.633401 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:46:29.640953 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:46:29.658046 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:46:29.660309 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:46:29.682295 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:46:29.720333 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:46:29.745778 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:46:29.753465 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:46:29.766818 (MainThread): Partial parsing not enabled
2022-12-17 00:46:29.826774 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:46:29.859917 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:46:29.876510 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:46:29.893302 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:46:29.910269 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:46:30.130346 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29cbfb1e-76db-43c1-a4ce-4e2d8a8dd0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f453309f320>]}
2022-12-17 00:46:30.183477 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:46:30.184943 (MainThread): 
2022-12-17 00:46:30.185543 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:46:30.194653 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:46:30.194999 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:46:30.369957 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:46:30.370343 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:46:30.375825 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:46:30.498919 (MainThread): 00:46:30 | Concurrency: 1 threads (target='dev')
2022-12-17 00:46:30.499221 (MainThread): 00:46:30 | 
2022-12-17 00:46:30.501864 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:46:30.503393 (Thread-1): 00:46:30 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:46:30.504022 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:46:30.504281 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:46:30.525715 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:46:30.526362 (Thread-1): finished collecting timing info
2022-12-17 00:46:30.552651 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:46:30.557940 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:46:30.736105 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:46:30.736672 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:46:42.423087 (Thread-1): finished collecting timing info
2022-12-17 00:46:42.424140 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29cbfb1e-76db-43c1-a4ce-4e2d8a8dd0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4544cb4828>]}
2022-12-17 00:46:42.425606 (Thread-1): 00:46:42 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 645.5 MB processed) in 11.92s]
2022-12-17 00:46:42.425908 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:46:42.426553 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:46:42.428255 (Thread-1): 00:46:42 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 00:46:42.428659 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:46:42.428838 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:46:42.438431 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:46:42.438901 (Thread-1): finished collecting timing info
2022-12-17 00:46:42.444194 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:46:42.449358 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:46:42.586217 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:46:42.586911 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT 
    payment_type,
    case payment_type
        when payment_type "CASH_IN" THEN 1
        when payment_type "CASH_OUT" THEN 2
        when payment_type "DEBIT" THEN 3
        when payment_type "PAYMENT" THEN 4
    end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 

FROM 
    dim_payment_type
  );
    
2022-12-17 00:46:42.729633 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/80d50dd1-4855-43ad-8b9f-bcff64165870?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [15:27]',)
2022-12-17 00:46:43.733679 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 52694), raddr=('172.217.219.95', 443)>
2022-12-17 00:46:43.733988 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 36230), raddr=('172.253.119.95', 443)>
2022-12-17 00:46:43.734181 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 52704), raddr=('172.217.219.95', 443)>
2022-12-17 00:46:43.734319 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 36244), raddr=('172.253.119.95', 443)>
2022-12-17 00:46:43.734511 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 52712), raddr=('172.217.219.95', 443)>
2022-12-17 00:46:43.734643 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 36256), raddr=('172.253.119.95', 443)>
2022-12-17 00:46:43.904149 (Thread-1): finished collecting timing info
2022-12-17 00:46:43.904927 (Thread-1): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [15:27]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/5d52fb65-22b4-406c-9bde-426adc1c4aec?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [15:27]

(job ID: 5d52fb65-22b4-406c-9bde-426adc1c4aec)

                                                                     -----Query Job SQL Follows-----                                                                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:WITH dim_payment_type AS(
  12:    SELECT 
  13:    payment_type,
  14:    case payment_type
  15:        when payment_type "CASH_IN" THEN 1
  16:        when payment_type "CASH_OUT" THEN 2
  17:        when payment_type "DEBIT" THEN 3
  18:        when payment_type "PAYMENT" THEN 4
  19:    end as id_payment_type
  20:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  21:)
  22:
  23:SELECT 
  24:
  25:FROM 
  26:    dim_payment_type
  27:  );
  28:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [15:27]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:46:43.908966 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29cbfb1e-76db-43c1-a4ce-4e2d8a8dd0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f453207e0f0>]}
2022-12-17 00:46:43.910730 (Thread-1): 00:46:43 | 2 of 5 ERROR creating table model timestamp_fraud_complete.dim_payment_type [ERROR in 1.48s]
2022-12-17 00:46:43.910936 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:46:43.911130 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:46:43.912665 (Thread-1): 00:46:43 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 00:46:43.913157 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:46:43.913323 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:46:43.923534 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:46:43.923984 (Thread-1): finished collecting timing info
2022-12-17 00:46:43.929312 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:46:43.934608 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:46:44.082885 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:46:44.083563 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 00:46:54.181431 (Thread-1): finished collecting timing info
2022-12-17 00:46:54.182598 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29cbfb1e-76db-43c1-a4ce-4e2d8a8dd0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4531f27128>]}
2022-12-17 00:46:54.184084 (Thread-1): 00:46:54 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 10.27s]
2022-12-17 00:46:54.185001 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:46:54.185301 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:46:54.186888 (Thread-1): 00:46:54 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 00:46:54.187723 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:46:54.187953 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:46:54.198302 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:46:54.198858 (Thread-1): finished collecting timing info
2022-12-17 00:46:54.204129 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:46:54.209288 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:46:54.346273 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:46:54.346851 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 00:47:00.355701 (Thread-1): finished collecting timing info
2022-12-17 00:47:00.356686 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29cbfb1e-76db-43c1-a4ce-4e2d8a8dd0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4532f45a90>]}
2022-12-17 00:47:00.358176 (Thread-1): 00:47:00 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.17s]
2022-12-17 00:47:00.358383 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:47:00.358578 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:47:00.360062 (Thread-1): 00:47:00 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 00:47:00.360514 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:47:00.360735 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:47:00.370928 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:47:00.371354 (Thread-1): finished collecting timing info
2022-12-17 00:47:00.376629 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:47:00.381861 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:47:00.513226 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:47:00.514087 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 00:47:00.805558 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/e1d327c0-78d9-435b-950d-3cb946635ba7?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]',)
2022-12-17 00:47:02.252291 (Thread-1): finished collecting timing info
2022-12-17 00:47:02.253399 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/e6ca719d-0f15-4061-bb4d-c0286435a5ab?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]

(job ID: e6ca719d-0f15-4061-bb4d-c0286435a5ab)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    id_transaction,
  18:    step,
  19:    timestamp,
  20:    payment_type,
  21:    amount,
  22:    old_balance_sender,
  23:    new_balance_sender,
  24:    old_balance_recipient,
  25:    new_balance_recipient,
  26:    is_fraud,
  27:    is_flagged_fraud
  28:FROM
  29:    fact_raw_fraud
  30:  );
  31:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 00:47:02.254335 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29cbfb1e-76db-43c1-a4ce-4e2d8a8dd0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4531ef2f60>]}
2022-12-17 00:47:02.255956 (Thread-1): 00:47:02 | 5 of 5 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 1.89s]
2022-12-17 00:47:02.256276 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:47:02.272916 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:47:02.273320 (MainThread): 00:47:02 | 
2022-12-17 00:47:02.273643 (MainThread): 00:47:02 | Finished running 5 table models in 32.09s.
2022-12-17 00:47:02.273955 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:47:02.274109 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:47:02.326159 (MainThread): 
2022-12-17 00:47:02.326447 (MainThread): Completed with 2 errors and 0 warnings:
2022-12-17 00:47:02.326678 (MainThread): 
2022-12-17 00:47:02.326880 (MainThread): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
2022-12-17 00:47:02.327173 (MainThread):   Syntax error: Unexpected string literal "CASH_IN" at [15:27]
2022-12-17 00:47:02.327383 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:47:02.327605 (MainThread): 
2022-12-17 00:47:02.327825 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-17 00:47:02.328034 (MainThread):   Unrecognized name: amount at [21:5]
2022-12-17 00:47:02.328223 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 00:47:02.328437 (MainThread): 
Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
2022-12-17 00:47:02.328796 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45332fa198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4533108630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4532084f98>]}
2022-12-17 00:47:02.329134 (MainThread): Flushing usage events
2022-12-17 00:53:23.387921 (MainThread): Running with dbt=0.19.0
2022-12-17 00:53:24.053445 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 00:53:24.054554 (MainThread): Tracking: tracking
2022-12-17 00:53:24.063185 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe65b7dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe65b7f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe65b7f98>]}
2022-12-17 00:53:24.113563 (MainThread): Partial parsing not enabled
2022-12-17 00:53:24.115345 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:53:24.122361 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:53:24.130632 (MainThread): Parsing macros/etc.sql
2022-12-17 00:53:24.133327 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:53:24.156978 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:53:24.160823 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:53:24.164308 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:53:24.180495 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:53:24.192627 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:53:24.198066 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:53:24.201405 (MainThread): Parsing macros/core.sql
2022-12-17 00:53:24.206398 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:53:24.260619 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:53:24.262013 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:53:24.273285 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:53:24.275499 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:53:24.277620 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:53:24.279050 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:53:24.281767 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:53:24.284138 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:53:24.286591 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:53:24.290090 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:53:24.292174 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:53:24.303785 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:53:24.312262 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:53:24.314632 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:53:24.322273 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:53:24.339562 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:53:24.341855 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:53:24.364313 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:53:24.403342 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:53:24.429127 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:53:24.436743 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:53:24.449961 (MainThread): Partial parsing not enabled
2022-12-17 00:53:24.510066 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:53:24.543912 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:53:24.560543 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:53:24.577336 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:53:24.594128 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:53:24.812814 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f30019b9-a6e4-449b-a4c1-7835c38d7736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe63c0908>]}
2022-12-17 00:53:24.866135 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:53:24.867439 (MainThread): 
2022-12-17 00:53:24.867947 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:53:24.876583 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:53:24.876919 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:53:24.882721 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:53:25.026865 (MainThread): 00:53:25 | Concurrency: 1 threads (target='dev')
2022-12-17 00:53:25.027136 (MainThread): 00:53:25 | 
2022-12-17 00:53:25.029377 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:53:25.029898 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:53:25.030175 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:53:25.051704 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:53:25.052344 (Thread-1): finished collecting timing info
2022-12-17 00:53:25.052823 (Thread-1): finished collecting timing info
2022-12-17 00:53:25.053510 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:53:25.054269 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:53:25.054716 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:53:25.054929 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:53:25.064727 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:53:25.065277 (Thread-1): finished collecting timing info
2022-12-17 00:53:25.065691 (Thread-1): finished collecting timing info
2022-12-17 00:53:25.066287 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:53:25.066551 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:53:25.067044 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:53:25.067262 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:53:25.076921 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:53:25.077490 (Thread-1): finished collecting timing info
2022-12-17 00:53:25.077905 (Thread-1): finished collecting timing info
2022-12-17 00:53:25.078503 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:53:25.078770 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:53:25.079257 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:53:25.079484 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:53:25.088854 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:53:25.089384 (Thread-1): finished collecting timing info
2022-12-17 00:53:25.089792 (Thread-1): finished collecting timing info
2022-12-17 00:53:25.090377 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:53:25.090663 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:53:25.091136 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:53:25.091353 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:53:25.100956 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:53:25.101510 (Thread-1): finished collecting timing info
2022-12-17 00:53:25.101925 (Thread-1): finished collecting timing info
2022-12-17 00:53:25.102560 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:53:25.129579 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:53:25.129800 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:53:25.181723 (MainThread): 00:53:25 | Done.
2022-12-17 00:53:25.182096 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe6302198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe6580a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe6212eb8>]}
2022-12-17 00:53:25.182467 (MainThread): Flushing usage events
2022-12-17 00:53:29.668412 (MainThread): Running with dbt=0.19.0
2022-12-17 00:53:30.332145 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:53:30.333244 (MainThread): Tracking: tracking
2022-12-17 00:53:30.342122 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d05641e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d05641fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d056571d0>]}
2022-12-17 00:53:30.393640 (MainThread): Partial parsing not enabled
2022-12-17 00:53:30.395239 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:53:30.402285 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:53:30.410614 (MainThread): Parsing macros/etc.sql
2022-12-17 00:53:30.413428 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:53:30.437256 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:53:30.440947 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:53:30.444462 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:53:30.460439 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:53:30.472704 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:53:30.478239 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:53:30.481512 (MainThread): Parsing macros/core.sql
2022-12-17 00:53:30.486431 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:53:30.539045 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:53:30.540505 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:53:30.551743 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:53:30.553999 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:53:30.556122 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:53:30.557608 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:53:30.560249 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:53:30.562541 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:53:30.565090 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:53:30.568528 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:53:30.570544 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:53:30.581890 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:53:30.590098 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:53:30.592464 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:53:30.600398 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:53:30.617916 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:53:30.620280 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:53:30.642378 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:53:30.680392 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:53:30.705928 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:53:30.713756 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:53:30.727120 (MainThread): Partial parsing not enabled
2022-12-17 00:53:30.786482 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:53:30.820339 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:53:30.837252 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:53:30.854288 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:53:30.871700 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:53:31.093246 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5dd1451-e243-4d1d-bd92-42bb2a6067e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d16f98550>]}
2022-12-17 00:53:31.146576 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:53:31.148100 (MainThread): 
2022-12-17 00:53:31.148691 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:53:31.157860 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:53:31.158272 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:53:31.341834 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:53:31.342377 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:53:31.347884 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:53:31.473793 (MainThread): 00:53:31 | Concurrency: 1 threads (target='dev')
2022-12-17 00:53:31.474135 (MainThread): 00:53:31 | 
2022-12-17 00:53:31.476455 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:53:31.478161 (Thread-1): 00:53:31 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:53:31.478732 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:53:31.478989 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:53:31.501368 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:53:31.501976 (Thread-1): finished collecting timing info
2022-12-17 00:53:31.528895 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:53:31.534405 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:53:31.714363 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:53:31.715143 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:53:38.189744 (MainThread): 00:53:38 | The bigquery adapter does not support query cancellation. Some queries may still be running!
2022-12-17 00:53:41.998067 (MainThread): Running with dbt=0.19.0
2022-12-17 00:53:42.766946 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 00:53:42.768062 (MainThread): Tracking: tracking
2022-12-17 00:53:42.776555 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688cb2add8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688cb2ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688cb2af98>]}
2022-12-17 00:53:42.817916 (MainThread): Partial parsing not enabled
2022-12-17 00:53:42.818965 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:53:42.823667 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:53:42.831484 (MainThread): Parsing macros/etc.sql
2022-12-17 00:53:42.834128 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:53:42.858241 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:53:42.861990 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:53:42.865469 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:53:42.881723 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:53:42.894300 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:53:42.899761 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:53:42.902992 (MainThread): Parsing macros/core.sql
2022-12-17 00:53:42.908006 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:53:42.961502 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:53:42.962855 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:53:42.974444 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:53:42.976615 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:53:42.978724 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:53:42.980156 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:53:42.982745 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:53:42.984963 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:53:42.987474 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:53:42.991122 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:53:42.993582 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:53:43.004970 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:53:43.013146 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:53:43.015501 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:53:43.023460 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:53:43.040647 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:53:43.042914 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:53:43.065756 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:53:43.106818 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:53:43.133658 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:53:43.143022 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:53:43.159701 (MainThread): Partial parsing not enabled
2022-12-17 00:53:43.222073 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:53:43.262983 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:53:43.280043 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:53:43.297884 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:53:43.314585 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:53:43.543870 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ad1876e-4d18-4a7e-9377-bd1dcfaacbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688c935390>]}
2022-12-17 00:53:43.598301 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:53:43.599847 (MainThread): 
2022-12-17 00:53:43.600407 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:53:43.609343 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:53:43.609630 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:53:43.615426 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:53:43.744934 (MainThread): 00:53:43 | Concurrency: 1 threads (target='dev')
2022-12-17 00:53:43.745266 (MainThread): 00:53:43 | 
2022-12-17 00:53:43.747615 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:53:43.748272 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:53:43.748544 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:53:43.770613 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:53:43.771230 (Thread-1): finished collecting timing info
2022-12-17 00:53:43.771727 (Thread-1): finished collecting timing info
2022-12-17 00:53:43.772367 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:53:43.773024 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:53:43.773473 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:53:43.773690 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:53:43.783231 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:53:43.783810 (Thread-1): finished collecting timing info
2022-12-17 00:53:43.784239 (Thread-1): finished collecting timing info
2022-12-17 00:53:43.784839 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:53:43.785124 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:53:43.785665 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:53:43.785883 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:53:43.795982 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:53:43.796546 (Thread-1): finished collecting timing info
2022-12-17 00:53:43.797083 (Thread-1): finished collecting timing info
2022-12-17 00:53:43.797683 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:53:43.797963 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:53:43.798494 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:53:43.798711 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:53:43.808030 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:53:43.808559 (Thread-1): finished collecting timing info
2022-12-17 00:53:43.808971 (Thread-1): finished collecting timing info
2022-12-17 00:53:43.809572 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:53:43.809853 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:53:43.810377 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:53:43.810593 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:53:43.819851 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:53:43.820380 (Thread-1): finished collecting timing info
2022-12-17 00:53:43.820792 (Thread-1): finished collecting timing info
2022-12-17 00:53:43.821497 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:53:43.847469 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:53:43.847628 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:53:43.899168 (MainThread): 00:53:43 | Done.
2022-12-17 00:53:43.899544 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688caecda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688c9c6128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f689e4a15c0>]}
2022-12-17 00:53:43.899861 (MainThread): Flushing usage events
2022-12-17 00:53:49.443267 (MainThread): Running with dbt=0.19.0
2022-12-17 00:53:50.106741 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:53:50.108018 (MainThread): Tracking: tracking
2022-12-17 00:53:50.116394 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3832184e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3832184f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3832184f98>]}
2022-12-17 00:53:50.166884 (MainThread): Partial parsing not enabled
2022-12-17 00:53:50.168276 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:53:50.175104 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:53:50.183275 (MainThread): Parsing macros/etc.sql
2022-12-17 00:53:50.185945 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:53:50.209862 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:53:50.213385 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:53:50.216905 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:53:50.232552 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:53:50.244436 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:53:50.249863 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:53:50.253134 (MainThread): Parsing macros/core.sql
2022-12-17 00:53:50.258071 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:53:50.310503 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:53:50.311911 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:53:50.322860 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:53:50.325007 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:53:50.327028 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:53:50.328406 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:53:50.330959 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:53:50.333199 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:53:50.335590 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:53:50.338943 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:53:50.340931 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:53:50.352211 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:53:50.360340 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:53:50.362646 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:53:50.370174 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:53:50.387945 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:53:50.390276 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:53:50.412888 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:53:50.450275 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:53:50.475562 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:53:50.483463 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:53:50.496543 (MainThread): Partial parsing not enabled
2022-12-17 00:53:50.555554 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:53:50.589164 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:53:50.606107 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:53:50.623134 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:53:50.639614 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:53:50.861796 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97cb6179-455d-4f0e-87a8-4986009f5f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3831f8f630>]}
2022-12-17 00:53:50.914973 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:53:50.916200 (MainThread): 
2022-12-17 00:53:50.916647 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:53:50.925407 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:53:50.925747 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:53:51.075520 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:53:51.075999 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:53:51.081652 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:53:51.209450 (MainThread): 00:53:51 | Concurrency: 1 threads (target='dev')
2022-12-17 00:53:51.209709 (MainThread): 00:53:51 | 
2022-12-17 00:53:51.212401 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:53:51.213787 (Thread-1): 00:53:51 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:53:51.214746 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:53:51.214958 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:53:51.236883 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:53:51.237444 (Thread-1): finished collecting timing info
2022-12-17 00:53:51.266374 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:53:51.271580 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:53:51.431392 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:53:51.431950 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:54:01.890586 (Thread-1): finished collecting timing info
2022-12-17 00:54:01.891692 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cb6179-455d-4f0e-87a8-4986009f5f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3831e78908>]}
2022-12-17 00:54:01.893215 (Thread-1): 00:54:01 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 645.5 MB processed) in 10.68s]
2022-12-17 00:54:01.893488 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:54:01.894357 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:54:01.896198 (Thread-1): 00:54:01 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 00:54:01.896689 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:54:01.896898 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:54:01.907017 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:54:01.907539 (Thread-1): finished collecting timing info
2022-12-17 00:54:01.912888 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:54:01.918059 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:54:02.069668 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:54:02.070334 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT 
    payment_type,
    case payment_type
        when payment_type "CASH_IN" THEN 1
        when payment_type "CASH_OUT" THEN 2
        when payment_type "DEBIT" THEN 3
        when payment_type "PAYMENT" THEN 4
    end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 

FROM 
    dim_payment_type
  );
    
2022-12-17 00:54:02.306610 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/12aa6697-951e-43bf-aa44-b6a5a8bfc722?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [15:27]',)
2022-12-17 00:54:03.426286 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44242), raddr=('74.125.132.95', 443)>
2022-12-17 00:54:03.426782 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 57592), raddr=('173.194.198.95', 443)>
2022-12-17 00:54:03.427149 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44244), raddr=('74.125.132.95', 443)>
2022-12-17 00:54:03.427477 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 57600), raddr=('173.194.198.95', 443)>
2022-12-17 00:54:03.427836 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 44256), raddr=('74.125.132.95', 443)>
2022-12-17 00:54:03.428078 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 57604), raddr=('173.194.198.95', 443)>
2022-12-17 00:54:03.677799 (Thread-1): finished collecting timing info
2022-12-17 00:54:03.678667 (Thread-1): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [15:27]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/3c9b6879-0c33-4784-b261-1e53b92a6fef?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [15:27]

(job ID: 3c9b6879-0c33-4784-b261-1e53b92a6fef)

                                                                     -----Query Job SQL Follows-----                                                                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:WITH dim_payment_type AS(
  12:    SELECT 
  13:    payment_type,
  14:    case payment_type
  15:        when payment_type "CASH_IN" THEN 1
  16:        when payment_type "CASH_OUT" THEN 2
  17:        when payment_type "DEBIT" THEN 3
  18:        when payment_type "PAYMENT" THEN 4
  19:    end as id_payment_type
  20:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  21:)
  22:
  23:SELECT 
  24:
  25:FROM 
  26:    dim_payment_type
  27:  );
  28:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [15:27]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:54:03.682850 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cb6179-455d-4f0e-87a8-4986009f5f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3830f732e8>]}
2022-12-17 00:54:03.684401 (Thread-1): 00:54:03 | 2 of 5 ERROR creating table model timestamp_fraud_complete.dim_payment_type [ERROR in 1.79s]
2022-12-17 00:54:03.684633 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:54:03.684859 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:54:03.686353 (Thread-1): 00:54:03 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 00:54:03.686794 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:54:03.687028 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:54:03.697079 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:54:03.697628 (Thread-1): finished collecting timing info
2022-12-17 00:54:03.703072 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:54:03.708297 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:54:03.837631 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:54:03.838431 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 00:54:09.560121 (Thread-1): finished collecting timing info
2022-12-17 00:54:09.561281 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cb6179-455d-4f0e-87a8-4986009f5f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3830f09160>]}
2022-12-17 00:54:09.562822 (Thread-1): 00:54:09 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 5.87s]
2022-12-17 00:54:09.563705 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:54:09.564081 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:54:09.565503 (Thread-1): 00:54:09 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 00:54:09.566025 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:54:09.566246 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:54:09.576444 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:54:09.577020 (Thread-1): finished collecting timing info
2022-12-17 00:54:09.582531 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:54:09.587747 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:54:09.764321 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:54:09.764979 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 00:54:16.227354 (Thread-1): finished collecting timing info
2022-12-17 00:54:16.228436 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cb6179-455d-4f0e-87a8-4986009f5f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3830dd0080>]}
2022-12-17 00:54:16.229828 (Thread-1): 00:54:16 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.66s]
2022-12-17 00:54:16.230025 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:54:16.230214 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:54:16.231676 (Thread-1): 00:54:16 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 00:54:16.232035 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:54:16.232175 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:54:16.242308 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:54:16.242733 (Thread-1): finished collecting timing info
2022-12-17 00:54:16.248119 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:54:16.253334 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:54:16.397978 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:54:16.398549 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 00:54:16.672580 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/fd6535c6-a91a-4d74-a844-1b47b4aef2b7?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]',)
2022-12-17 00:54:18.085853 (Thread-1): finished collecting timing info
2022-12-17 00:54:18.086706 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/0141f2cb-3a34-45a5-be56-0d12eb1c407c?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]

(job ID: 0141f2cb-3a34-45a5-be56-0d12eb1c407c)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    id_transaction,
  18:    step,
  19:    timestamp,
  20:    payment_type,
  21:    amount,
  22:    old_balance_sender,
  23:    new_balance_sender,
  24:    old_balance_recipient,
  25:    new_balance_recipient,
  26:    is_fraud,
  27:    is_flagged_fraud
  28:FROM
  29:    fact_raw_fraud
  30:  );
  31:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 00:54:18.087615 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cb6179-455d-4f0e-87a8-4986009f5f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3830de1e10>]}
2022-12-17 00:54:18.089168 (Thread-1): 00:54:18 | 5 of 5 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 1.86s]
2022-12-17 00:54:18.089369 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:54:18.171698 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:54:18.172236 (MainThread): 00:54:18 | 
2022-12-17 00:54:18.172407 (MainThread): 00:54:18 | Finished running 5 table models in 27.26s.
2022-12-17 00:54:18.172531 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:54:18.172610 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:54:18.224566 (MainThread): 
2022-12-17 00:54:18.224806 (MainThread): Completed with 2 errors and 0 warnings:
2022-12-17 00:54:18.224932 (MainThread): 
2022-12-17 00:54:18.225047 (MainThread): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
2022-12-17 00:54:18.225148 (MainThread):   Syntax error: Unexpected string literal "CASH_IN" at [15:27]
2022-12-17 00:54:18.225237 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:54:18.225328 (MainThread): 
2022-12-17 00:54:18.225423 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-17 00:54:18.225514 (MainThread):   Unrecognized name: amount at [21:5]
2022-12-17 00:54:18.225595 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 00:54:18.225699 (MainThread): 
Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
2022-12-17 00:54:18.225907 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3832109cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3831e0c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3831e34198>]}
2022-12-17 00:54:18.226118 (MainThread): Flushing usage events
2022-12-17 00:54:43.541696 (MainThread): Running with dbt=0.19.0
2022-12-17 00:54:44.208456 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 00:54:44.209657 (MainThread): Tracking: tracking
2022-12-17 00:54:44.218205 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecfa93e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecfa93fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecfaa81d0>]}
2022-12-17 00:54:44.260840 (MainThread): Partial parsing not enabled
2022-12-17 00:54:44.261942 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:54:44.266701 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:54:44.274560 (MainThread): Parsing macros/etc.sql
2022-12-17 00:54:44.277428 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:54:44.301527 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:54:44.305079 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:54:44.308580 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:54:44.324733 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:54:44.336742 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:54:44.342224 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:54:44.345448 (MainThread): Parsing macros/core.sql
2022-12-17 00:54:44.350321 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:54:44.403526 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:54:44.404965 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:54:44.416183 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:54:44.418398 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:54:44.420518 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:54:44.421924 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:54:44.424556 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:54:44.426812 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:54:44.429438 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:54:44.432869 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:54:44.434883 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:54:44.445997 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:54:44.454216 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:54:44.456618 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:54:44.464514 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:54:44.481648 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:54:44.483969 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:54:44.505806 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:54:44.543411 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:54:44.568699 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:54:44.576514 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:54:44.589539 (MainThread): Partial parsing not enabled
2022-12-17 00:54:44.647949 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:54:44.683331 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:54:44.700058 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:54:44.716941 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:54:44.733652 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:54:44.951308 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d75b3c4-257f-43f7-abd4-d65e2d0d2dfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecf906b38>]}
2022-12-17 00:54:45.004257 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:54:45.005563 (MainThread): 
2022-12-17 00:54:45.006080 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:54:45.014787 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:54:45.015088 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:54:45.021012 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:54:45.143689 (MainThread): 00:54:45 | Concurrency: 1 threads (target='dev')
2022-12-17 00:54:45.143963 (MainThread): 00:54:45 | 
2022-12-17 00:54:45.146202 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:54:45.146765 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:54:45.147034 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:54:45.169666 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:54:45.170388 (Thread-1): finished collecting timing info
2022-12-17 00:54:45.171050 (Thread-1): finished collecting timing info
2022-12-17 00:54:45.172000 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:54:45.172882 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:54:45.173399 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:54:45.173688 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:54:45.185529 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:54:45.186080 (Thread-1): finished collecting timing info
2022-12-17 00:54:45.186487 (Thread-1): finished collecting timing info
2022-12-17 00:54:45.187072 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:54:45.187320 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:54:45.187841 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:54:45.188040 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:54:45.197918 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:54:45.198429 (Thread-1): finished collecting timing info
2022-12-17 00:54:45.198837 (Thread-1): finished collecting timing info
2022-12-17 00:54:45.199432 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:54:45.199701 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:54:45.200187 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:54:45.200381 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:54:45.209865 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:54:45.210391 (Thread-1): finished collecting timing info
2022-12-17 00:54:45.210799 (Thread-1): finished collecting timing info
2022-12-17 00:54:45.211352 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:54:45.211664 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:54:45.212231 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:54:45.212427 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:54:45.222082 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:54:45.222509 (Thread-1): finished collecting timing info
2022-12-17 00:54:45.222860 (Thread-1): finished collecting timing info
2022-12-17 00:54:45.223413 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:54:45.246226 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:54:45.246426 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:54:45.296800 (MainThread): 00:54:45 | Done.
2022-12-17 00:54:45.299613 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecf92f128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecf787e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecf7ff4e0>]}
2022-12-17 00:54:45.299952 (MainThread): Flushing usage events
2022-12-17 00:54:49.092332 (MainThread): Running with dbt=0.19.0
2022-12-17 00:54:49.744058 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:54:49.745256 (MainThread): Tracking: tracking
2022-12-17 00:54:49.753130 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ac638ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ac638f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ac638fd0>]}
2022-12-17 00:54:49.803996 (MainThread): Partial parsing not enabled
2022-12-17 00:54:49.805286 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:54:49.810112 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:54:49.818002 (MainThread): Parsing macros/etc.sql
2022-12-17 00:54:49.820678 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:54:49.844439 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:54:49.848014 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:54:49.851457 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:54:49.867195 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:54:49.879325 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:54:49.884745 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:54:49.887981 (MainThread): Parsing macros/core.sql
2022-12-17 00:54:49.892813 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:54:49.945801 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:54:49.947177 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:54:49.958198 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:54:49.960376 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:54:49.962563 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:54:49.964036 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:54:49.966642 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:54:49.968918 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:54:49.971360 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:54:49.974854 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:54:49.977072 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:54:49.988669 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:54:49.996983 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:54:49.999348 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:54:50.007069 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:54:50.023946 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:54:50.026338 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:54:50.048155 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:54:50.085777 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:54:50.111209 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:54:50.118887 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:54:50.132128 (MainThread): Partial parsing not enabled
2022-12-17 00:54:50.191019 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:54:50.225960 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:54:50.242830 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:54:50.259523 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:54:50.276254 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:54:50.493240 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fddaece-5acf-4ffe-b3f2-90853380d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ac2d6f98>]}
2022-12-17 00:54:50.545944 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:54:50.547247 (MainThread): 
2022-12-17 00:54:50.547821 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:54:50.556455 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:54:50.556786 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:54:50.712158 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:54:50.712636 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:54:50.718140 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:54:50.850418 (MainThread): 00:54:50 | Concurrency: 1 threads (target='dev')
2022-12-17 00:54:50.850684 (MainThread): 00:54:50 | 
2022-12-17 00:54:50.852929 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:54:50.854372 (Thread-1): 00:54:50 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:54:50.855004 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:54:50.855256 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:54:50.876729 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:54:50.877335 (Thread-1): finished collecting timing info
2022-12-17 00:54:50.902940 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:54:50.908382 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:54:51.091274 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:54:51.092098 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    case 
        when  "CASH_IN" THEN 1
        when  "CASH_OUT" THEN 2
        when  "DEBIT" THEN 3
        when  "PAYMENT" THEN 4
    end as id_payment_type
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:54:51.581866 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/22e24f2a-2f23-433f-aca7-de0654355e92?maxResults=0&location=US&prettyPrint=false: No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [40:5]',)
2022-12-17 00:54:53.048434 (Thread-1): finished collecting timing info
2022-12-17 00:54:53.049599 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [40:5]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/959df21e-7fde-475f-9a5d-2c1aa17dad4b?maxResults=0&location=US&prettyPrint=false: No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [40:5]

(job ID: 959df21e-7fde-475f-9a5d-2c1aa17dad4b)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    --     -- CASE payment_type,
  18:    -- --     WHEN "CASH_IN" THEN 1
  19:    -- --     WHEN "CASH_OUT" THEN 2
  20:    -- --     WHEN "DEBIT" THEN 3
  21:    -- --     WHEN "PAYMENT" THEN 4
  22:    -- --     WHEN "TRANSFER" THEN 5
  23:    -- -- END AS id_payment_type,
  24:    -- -- COUNT(*) AS total_of_payment_type
  25:    -- amount,
  26:    nameOrig as name_sender,
  27:    oldbalanceOrg as old_balance_sender,
  28:    newbalanceOrig as new_balance_sender,
  29:    nameDest as name_recipient,
  30:    oldbalanceDest as old_balance_recipient,
  31:    newbalanceDest as new_balance_recipient,
  32:    case isFraud
  33:        when 0 then "Not Fraud"
  34:        when 1 then "Fraud"
  35:    end as is_fraud,
  36:    case isFlaggedFraud
  37:        when 0 then "Not Fraud"
  38:        when 1 then "Fraud"
  39:    end as is_flagged_fraud,
  40:    case 
  41:        when  "CASH_IN" THEN 1
  42:        when  "CASH_OUT" THEN 2
  43:        when  "DEBIT" THEN 3
  44:        when  "PAYMENT" THEN 4
  45:    end as id_payment_type
  46:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  47:ORDER BY timestamp, step
  48:  );
  49:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [40:5]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:54:53.053604 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fddaece-5acf-4ffe-b3f2-90853380d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ac29e080>]}
2022-12-17 00:54:53.055252 (Thread-1): 00:54:53 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 2.20s]
2022-12-17 00:54:53.055567 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:54:53.056492 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:54:53.056732 (Thread-1): 00:54:53 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-17 00:54:53.056920 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:54:53.057273 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:54:53.057599 (Thread-1): 00:54:53 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-17 00:54:53.057837 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:54:53.058082 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:54:53.058372 (Thread-1): 00:54:53 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-17 00:54:53.058604 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:54:53.058839 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:54:53.059184 (Thread-1): 00:54:53 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-17 00:54:53.059442 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:54:53.158189 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:54:53.158725 (MainThread): 00:54:53 | 
2022-12-17 00:54:53.158902 (MainThread): 00:54:53 | Finished running 5 table models in 2.61s.
2022-12-17 00:54:53.159099 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:54:53.159253 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-17 00:54:53.209471 (MainThread): 
2022-12-17 00:54:53.209729 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:54:53.209915 (MainThread): 
2022-12-17 00:54:53.210133 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-17 00:54:53.210322 (MainThread):   No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [40:5]
2022-12-17 00:54:53.210495 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:54:53.210694 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-17 00:54:53.211048 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ac48dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ac61fc18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ac3148d0>]}
2022-12-17 00:54:53.211440 (MainThread): Flushing usage events
2022-12-17 00:58:30.821255 (MainThread): Running with dbt=0.19.0
2022-12-17 00:58:31.481795 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 00:58:31.482892 (MainThread): Tracking: tracking
2022-12-17 00:58:31.491016 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff414cd1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff414cd1f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff414cd1fd0>]}
2022-12-17 00:58:31.539441 (MainThread): Partial parsing not enabled
2022-12-17 00:58:31.540484 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:58:31.545138 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:58:31.552985 (MainThread): Parsing macros/etc.sql
2022-12-17 00:58:31.555748 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:58:31.579581 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:58:31.583138 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:58:31.586638 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:58:31.602861 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:58:31.614947 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:58:31.620444 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:58:31.623686 (MainThread): Parsing macros/core.sql
2022-12-17 00:58:31.628581 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:58:31.681425 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:58:31.682822 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:58:31.694001 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:58:31.696223 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:58:31.698332 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:58:31.699769 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:58:31.702437 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:58:31.704711 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:58:31.707156 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:58:31.710646 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:58:31.712743 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:58:31.724606 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:58:31.732996 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:58:31.735481 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:58:31.743150 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:58:31.760181 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:58:31.762468 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:58:31.784428 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:58:31.821858 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:58:31.847007 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:58:31.854671 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:58:31.868009 (MainThread): Partial parsing not enabled
2022-12-17 00:58:31.926164 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:58:31.960430 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:58:31.977163 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:58:31.994080 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:58:32.010786 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:58:32.224909 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b85159d-b3d9-4810-a0af-d508de968112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff414970fd0>]}
2022-12-17 00:58:32.277204 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:58:32.278461 (MainThread): 
2022-12-17 00:58:32.278928 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:58:32.287216 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:58:32.287535 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:58:32.293526 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:58:32.433249 (MainThread): 00:58:32 | Concurrency: 1 threads (target='dev')
2022-12-17 00:58:32.433547 (MainThread): 00:58:32 | 
2022-12-17 00:58:32.435612 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:58:32.436524 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:58:32.436858 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:58:32.459015 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:58:32.459572 (Thread-1): finished collecting timing info
2022-12-17 00:58:32.460031 (Thread-1): finished collecting timing info
2022-12-17 00:58:32.460603 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:58:32.461178 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:58:32.461499 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:58:32.461630 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:58:32.471584 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:58:32.471955 (Thread-1): finished collecting timing info
2022-12-17 00:58:32.472303 (Thread-1): finished collecting timing info
2022-12-17 00:58:32.472800 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:58:32.473005 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:58:32.473477 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:58:32.473670 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:58:32.483072 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:58:32.483582 (Thread-1): finished collecting timing info
2022-12-17 00:58:32.483966 (Thread-1): finished collecting timing info
2022-12-17 00:58:32.484523 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:58:32.484756 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:58:32.485230 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:58:32.485409 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:58:32.494833 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:58:32.495274 (Thread-1): finished collecting timing info
2022-12-17 00:58:32.495695 (Thread-1): finished collecting timing info
2022-12-17 00:58:32.496254 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:58:32.496484 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:58:32.496935 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:58:32.497141 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:58:32.506854 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:58:32.507293 (Thread-1): finished collecting timing info
2022-12-17 00:58:32.507688 (Thread-1): finished collecting timing info
2022-12-17 00:58:32.508290 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:58:32.535541 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:58:32.535699 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:58:32.585331 (MainThread): 00:58:32 | Done.
2022-12-17 00:58:32.585637 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4149c6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4149f67b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff414cb65c0>]}
2022-12-17 00:58:32.585943 (MainThread): Flushing usage events
2022-12-17 00:58:36.291479 (MainThread): Running with dbt=0.19.0
2022-12-17 00:58:36.948058 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:58:36.949031 (MainThread): Tracking: tracking
2022-12-17 00:58:36.956982 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1027a93da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1027a93f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1027a93f60>]}
2022-12-17 00:58:37.008915 (MainThread): Partial parsing not enabled
2022-12-17 00:58:37.010602 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:58:37.017329 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:58:37.025178 (MainThread): Parsing macros/etc.sql
2022-12-17 00:58:37.027911 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:58:37.051721 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:58:37.055352 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:58:37.058941 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:58:37.075097 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:58:37.087074 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:58:37.092539 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:58:37.095762 (MainThread): Parsing macros/core.sql
2022-12-17 00:58:37.101314 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:58:37.154673 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:58:37.156138 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:58:37.167452 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:58:37.169715 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:58:37.171820 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:58:37.173241 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:58:37.176083 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:58:37.178329 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:58:37.180774 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:58:37.184202 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:58:37.186218 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:58:37.197538 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:58:37.205741 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:58:37.208190 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:58:37.216105 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:58:37.233021 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:58:37.235305 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:58:37.257177 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:58:37.296275 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:58:37.322741 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:58:37.331201 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:58:37.344648 (MainThread): Partial parsing not enabled
2022-12-17 00:58:37.404104 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:58:37.439794 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:58:37.456428 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:58:37.473143 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:58:37.490741 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:58:37.714676 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c848d6da-9ebc-4e2d-9060-1193d5a06e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1027900a20>]}
2022-12-17 00:58:37.767617 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:58:37.768907 (MainThread): 
2022-12-17 00:58:37.769413 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:58:37.778613 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:58:37.778938 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:58:37.944035 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:58:37.944366 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:58:37.949680 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:58:38.070024 (MainThread): 00:58:38 | Concurrency: 1 threads (target='dev')
2022-12-17 00:58:38.070284 (MainThread): 00:58:38 | 
2022-12-17 00:58:38.072630 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:58:38.076777 (Thread-1): 00:58:38 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:58:38.077436 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:58:38.077733 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:58:38.099424 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:58:38.100103 (Thread-1): finished collecting timing info
2022-12-17 00:58:38.126124 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:58:38.131406 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:58:38.299117 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:58:38.300036 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
    case 
        when  "CASH_IN" THEN 1
        when  "CASH_OUT" THEN 2
        when  "DEBIT" THEN 3
        when  "PAYMENT" THEN 4
    end as id_payment_type
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:58:38.720021 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/76df8de3-be74-4efe-96cd-dcf52be59f6a?maxResults=0&location=US&prettyPrint=false: No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [40:5]',)
2022-12-17 00:58:40.171633 (Thread-1): finished collecting timing info
2022-12-17 00:58:40.172659 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [40:5]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/884846bc-ec66-456f-8b6f-7645ec8f70e8?maxResults=0&location=US&prettyPrint=false: No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [40:5]

(job ID: 884846bc-ec66-456f-8b6f-7645ec8f70e8)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    --     -- CASE payment_type,
  18:    -- --     WHEN "CASH_IN" THEN 1
  19:    -- --     WHEN "CASH_OUT" THEN 2
  20:    -- --     WHEN "DEBIT" THEN 3
  21:    -- --     WHEN "PAYMENT" THEN 4
  22:    -- --     WHEN "TRANSFER" THEN 5
  23:    -- -- END AS id_payment_type,
  24:    -- -- COUNT(*) AS total_of_payment_type
  25:    -- amount,
  26:    nameOrig as name_sender,
  27:    oldbalanceOrg as old_balance_sender,
  28:    newbalanceOrig as new_balance_sender,
  29:    nameDest as name_recipient,
  30:    oldbalanceDest as old_balance_recipient,
  31:    newbalanceDest as new_balance_recipient,
  32:    case isFraud
  33:        when 0 then "Not Fraud"
  34:        when 1 then "Fraud"
  35:    end as is_fraud,
  36:    case isFlaggedFraud
  37:        when 0 then "Not Fraud"
  38:        when 1 then "Fraud"
  39:    end as is_flagged_fraud,
  40:    case 
  41:        when  "CASH_IN" THEN 1
  42:        when  "CASH_OUT" THEN 2
  43:        when  "DEBIT" THEN 3
  44:        when  "PAYMENT" THEN 4
  45:    end as id_payment_type
  46:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  47:ORDER BY timestamp, step
  48:  );
  49:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [40:5]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:58:40.176734 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c848d6da-9ebc-4e2d-9060-1193d5a06e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1026876400>]}
2022-12-17 00:58:40.178413 (Thread-1): 00:58:40 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 2.10s]
2022-12-17 00:58:40.179935 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:58:40.181055 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:58:40.181324 (Thread-1): 00:58:40 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-17 00:58:40.182176 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:58:40.182437 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:58:40.182736 (Thread-1): 00:58:40 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-17 00:58:40.183867 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:58:40.184132 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:58:40.184404 (Thread-1): 00:58:40 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-17 00:58:40.185343 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:58:40.185629 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:58:40.185904 (Thread-1): 00:58:40 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-17 00:58:40.186467 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:58:40.277126 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:58:40.277653 (MainThread): 00:58:40 | 
2022-12-17 00:58:40.279548 (MainThread): 00:58:40 | Finished running 5 table models in 2.51s.
2022-12-17 00:58:40.279824 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:58:40.279968 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-17 00:58:40.333232 (MainThread): 
2022-12-17 00:58:40.333503 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 00:58:40.333725 (MainThread): 
2022-12-17 00:58:40.333945 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-17 00:58:40.334152 (MainThread):   No matching signature for operator CASE; all WHEN argument types must be BOOL but found: STRING; actual argument types (WHEN THEN) ELSE: (STRING INT64) (STRING INT64) (STRING INT64) (STRING INT64) NULL at [40:5]
2022-12-17 00:58:40.334325 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 00:58:40.334506 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-17 00:58:40.334830 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10393c27f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102772acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102772a828>]}
2022-12-17 00:58:40.335203 (MainThread): Flushing usage events
2022-12-17 00:58:57.589018 (MainThread): Running with dbt=0.19.0
2022-12-17 00:58:58.260949 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:58:58.262166 (MainThread): Tracking: tracking
2022-12-17 00:58:58.270517 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed8579e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed8579f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed8579fd0>]}
2022-12-17 00:58:58.321795 (MainThread): Partial parsing not enabled
2022-12-17 00:58:58.323512 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:58:58.330308 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:58:58.338368 (MainThread): Parsing macros/etc.sql
2022-12-17 00:58:58.341304 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:58:58.366108 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:58:58.369645 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:58:58.373111 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:58:58.389107 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:58:58.401216 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:58:58.407128 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:58:58.410571 (MainThread): Parsing macros/core.sql
2022-12-17 00:58:58.415659 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:58:58.469051 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:58:58.470399 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:58:58.481789 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:58:58.483963 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:58:58.486244 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:58:58.487677 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:58:58.490242 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:58:58.492480 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:58:58.494857 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:58:58.498260 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:58:58.500280 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:58:58.511835 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:58:58.520013 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:58:58.522346 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:58:58.530162 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:58:58.547541 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:58:58.549820 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:58:58.572903 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:58:58.611878 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:58:58.637646 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:58:58.646033 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:58:58.659631 (MainThread): Partial parsing not enabled
2022-12-17 00:58:58.719914 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:58:58.752877 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:58:58.770211 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:58:58.786958 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:58:58.804068 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:58:59.021709 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5e5f5ee-8c26-477c-8bca-4b62aa9856d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed8383278>]}
2022-12-17 00:58:59.074817 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:58:59.076281 (MainThread): 
2022-12-17 00:58:59.076886 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:58:59.086653 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:58:59.087074 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:58:59.268266 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:58:59.268595 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:58:59.273853 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:58:59.400972 (MainThread): 00:58:59 | Concurrency: 1 threads (target='dev')
2022-12-17 00:58:59.401362 (MainThread): 00:58:59 | 
2022-12-17 00:58:59.403720 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:58:59.405112 (Thread-1): 00:58:59 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 00:58:59.405610 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:58:59.405848 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:58:59.429306 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:58:59.429873 (Thread-1): finished collecting timing info
2022-12-17 00:58:59.456474 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:58:59.461817 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:58:59.632796 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 00:58:59.633426 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 00:59:12.793792 (Thread-1): finished collecting timing info
2022-12-17 00:59:12.794898 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5f5ee-8c26-477c-8bca-4b62aa9856d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed81f6eb8>]}
2022-12-17 00:59:12.796326 (Thread-1): 00:59:12 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 645.5 MB processed) in 13.39s]
2022-12-17 00:59:12.797123 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 00:59:12.797832 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:59:12.799349 (Thread-1): 00:59:12 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 00:59:12.800162 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:59:12.800338 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 00:59:12.810649 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:59:12.811096 (Thread-1): finished collecting timing info
2022-12-17 00:59:12.816400 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:59:12.821601 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:59:12.968147 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 00:59:12.968825 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT 
    payment_type
    -- case payment_type
    --     when payment_type "CASH_IN" THEN 1
    --     when payment_type "CASH_OUT" THEN 2
    --     when payment_type "DEBIT" THEN 3
    --     when payment_type "PAYMENT" THEN 4
    -- end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    payment_type
    case payment_type
        when payment_type "CASH_IN" THEN 1
        when payment_type "CASH_OUT" THEN 2
        when payment_type "DEBIT" THEN 3
        when payment_type "PAYMENT" THEN 4
    end as id_payment_type

FROM 
    dim_payment_type
  );
    
2022-12-17 00:59:13.154358 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/bc8f72b0-6aa4-484b-b824-ad6ed3e62d35?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword CASE at [25:5]',)
2022-12-17 00:59:14.158464 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 46788), raddr=('142.250.159.95', 443)>
2022-12-17 00:59:14.158768 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 53696), raddr=('172.217.214.95', 443)>
2022-12-17 00:59:14.158947 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 46804), raddr=('142.250.159.95', 443)>
2022-12-17 00:59:14.159081 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 53702), raddr=('172.217.214.95', 443)>
2022-12-17 00:59:14.159298 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 46816), raddr=('142.250.159.95', 443)>
2022-12-17 00:59:14.159518 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 53718), raddr=('172.217.214.95', 443)>
2022-12-17 00:59:14.353200 (Thread-1): finished collecting timing info
2022-12-17 00:59:14.354033 (Thread-1): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Expected ")" but got keyword CASE at [25:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/071ddc53-2b2c-4ef9-9433-2959ffe899d7?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword CASE at [25:5]

(job ID: 071ddc53-2b2c-4ef9-9433-2959ffe899d7)

                                                                     -----Query Job SQL Follows-----                                                                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:WITH dim_payment_type AS(
  12:    SELECT 
  13:    payment_type
  14:    -- case payment_type
  15:    --     when payment_type "CASH_IN" THEN 1
  16:    --     when payment_type "CASH_OUT" THEN 2
  17:    --     when payment_type "DEBIT" THEN 3
  18:    --     when payment_type "PAYMENT" THEN 4
  19:    -- end as id_payment_type
  20:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  21:)
  22:
  23:SELECT 
  24:    payment_type
  25:    case payment_type
  26:        when payment_type "CASH_IN" THEN 1
  27:        when payment_type "CASH_OUT" THEN 2
  28:        when payment_type "DEBIT" THEN 3
  29:        when payment_type "PAYMENT" THEN 4
  30:    end as id_payment_type
  31:
  32:FROM 
  33:    dim_payment_type
  34:  );
  35:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Expected ")" but got keyword CASE at [25:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:59:14.360005 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5f5ee-8c26-477c-8bca-4b62aa9856d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed81836a0>]}
2022-12-17 00:59:14.362033 (Thread-1): 00:59:14 | 2 of 5 ERROR creating table model timestamp_fraud_complete.dim_payment_type [ERROR in 1.56s]
2022-12-17 00:59:14.362278 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 00:59:14.362579 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 00:59:14.364203 (Thread-1): 00:59:14 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 00:59:14.364722 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:59:14.364913 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 00:59:14.375809 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:59:14.376286 (Thread-1): finished collecting timing info
2022-12-17 00:59:14.381845 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:59:14.387051 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:59:14.535229 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 00:59:14.535899 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 00:59:31.017982 (Thread-1): finished collecting timing info
2022-12-17 00:59:31.019042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5f5ee-8c26-477c-8bca-4b62aa9856d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed8042eb8>]}
2022-12-17 00:59:31.020497 (Thread-1): 00:59:31 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 16.65s]
2022-12-17 00:59:31.020729 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 00:59:31.021009 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 00:59:31.022726 (Thread-1): 00:59:31 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 00:59:31.023230 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:59:31.023442 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 00:59:31.033243 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:59:31.033710 (Thread-1): finished collecting timing info
2022-12-17 00:59:31.039014 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:59:31.044214 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:59:31.199640 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 00:59:31.200290 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 00:59:37.557940 (Thread-1): finished collecting timing info
2022-12-17 00:59:37.559051 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5f5ee-8c26-477c-8bca-4b62aa9856d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed80648d0>]}
2022-12-17 00:59:37.560512 (Thread-1): 00:59:37 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.54s]
2022-12-17 00:59:37.560789 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 00:59:37.561051 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 00:59:37.562328 (Thread-1): 00:59:37 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 00:59:37.562962 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:59:37.563203 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 00:59:37.573273 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:59:37.573855 (Thread-1): finished collecting timing info
2022-12-17 00:59:37.579287 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 00:59:37.584572 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 00:59:37.746943 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 00:59:37.747694 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 00:59:38.293184 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/dbe5d5f2-54e5-4842-ac60-03abfd684dd3?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]',)
2022-12-17 00:59:39.725279 (Thread-1): finished collecting timing info
2022-12-17 00:59:39.726148 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/aeca5c61-4493-4f4b-8465-0fff0324bfb1?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]

(job ID: aeca5c61-4493-4f4b-8465-0fff0324bfb1)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    id_transaction,
  18:    step,
  19:    timestamp,
  20:    payment_type,
  21:    amount,
  22:    old_balance_sender,
  23:    new_balance_sender,
  24:    old_balance_recipient,
  25:    new_balance_recipient,
  26:    is_fraud,
  27:    is_flagged_fraud
  28:FROM
  29:    fact_raw_fraud
  30:  );
  31:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 00:59:39.727033 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5f5ee-8c26-477c-8bca-4b62aa9856d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed31ad400>]}
2022-12-17 00:59:39.728653 (Thread-1): 00:59:39 | 5 of 5 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 2.16s]
2022-12-17 00:59:39.728881 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 00:59:39.784758 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:59:39.785341 (MainThread): 00:59:39 | 
2022-12-17 00:59:39.785524 (MainThread): 00:59:39 | Finished running 5 table models in 40.71s.
2022-12-17 00:59:39.785645 (MainThread): Connection 'master' was properly closed.
2022-12-17 00:59:39.785722 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 00:59:39.839886 (MainThread): 
2022-12-17 00:59:39.840124 (MainThread): Completed with 2 errors and 0 warnings:
2022-12-17 00:59:39.840253 (MainThread): 
2022-12-17 00:59:39.840360 (MainThread): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
2022-12-17 00:59:39.840508 (MainThread):   Syntax error: Expected ")" but got keyword CASE at [25:5]
2022-12-17 00:59:39.840674 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 00:59:39.840860 (MainThread): 
2022-12-17 00:59:39.841079 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-17 00:59:39.841274 (MainThread):   Unrecognized name: amount at [21:5]
2022-12-17 00:59:39.841434 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 00:59:39.841646 (MainThread): 
Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
2022-12-17 00:59:39.841984 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed839dac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed832c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed81dbdd8>]}
2022-12-17 00:59:39.842360 (MainThread): Flushing usage events
2022-12-17 00:59:58.244969 (MainThread): Running with dbt=0.19.0
2022-12-17 00:59:58.926138 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 00:59:58.927347 (MainThread): Tracking: tracking
2022-12-17 00:59:58.935555 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6733cb3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6733cb3f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6733cb3fd0>]}
2022-12-17 00:59:58.987088 (MainThread): Partial parsing not enabled
2022-12-17 00:59:58.988529 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 00:59:58.995694 (MainThread): Parsing macros/catalog.sql
2022-12-17 00:59:59.003861 (MainThread): Parsing macros/etc.sql
2022-12-17 00:59:59.006572 (MainThread): Parsing macros/adapters.sql
2022-12-17 00:59:59.030436 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 00:59:59.034019 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 00:59:59.037505 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 00:59:59.053823 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 00:59:59.065902 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 00:59:59.071565 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 00:59:59.074772 (MainThread): Parsing macros/core.sql
2022-12-17 00:59:59.079704 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 00:59:59.132985 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 00:59:59.134319 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 00:59:59.145788 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 00:59:59.148060 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 00:59:59.150075 (MainThread): Parsing macros/etc/query.sql
2022-12-17 00:59:59.151783 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 00:59:59.154310 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 00:59:59.156491 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 00:59:59.158871 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 00:59:59.162222 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 00:59:59.164199 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 00:59:59.175808 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 00:59:59.184018 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 00:59:59.186321 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 00:59:59.194153 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 00:59:59.211564 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 00:59:59.213859 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 00:59:59.237445 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 00:59:59.276393 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 00:59:59.302091 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 00:59:59.309907 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 00:59:59.323703 (MainThread): Partial parsing not enabled
2022-12-17 00:59:59.383948 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 00:59:59.417738 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 00:59:59.434869 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 00:59:59.452649 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 00:59:59.470390 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 00:59:59.690504 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79ebc28d-cd3b-480c-a755-18a077cc4872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6733abd400>]}
2022-12-17 00:59:59.742509 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 00:59:59.743899 (MainThread): 
2022-12-17 00:59:59.744438 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 00:59:59.753921 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 00:59:59.754375 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 00:59:59.905257 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 00:59:59.905680 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 00:59:59.911410 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:00:00.045821 (MainThread): 01:00:00 | Concurrency: 1 threads (target='dev')
2022-12-17 01:00:00.046087 (MainThread): 01:00:00 | 
2022-12-17 01:00:00.048263 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:00:00.049692 (Thread-1): 01:00:00 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 01:00:00.050174 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:00:00.050378 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:00:00.072264 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:00:00.072948 (Thread-1): finished collecting timing info
2022-12-17 01:00:00.099935 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:00:00.105298 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:00:00.360679 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:00:00.361410 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 01:00:13.556844 (Thread-1): finished collecting timing info
2022-12-17 01:00:13.557996 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ebc28d-cd3b-480c-a755-18a077cc4872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674038d1d0>]}
2022-12-17 01:00:13.559474 (Thread-1): 01:00:13 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 645.5 MB processed) in 13.51s]
2022-12-17 01:00:13.559733 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:00:13.560566 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:00:13.562033 (Thread-1): 01:00:13 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 01:00:13.562523 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:00:13.562798 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:00:13.572791 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:00:13.573358 (Thread-1): finished collecting timing info
2022-12-17 01:00:13.579027 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:00:13.584848 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:00:13.722910 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:00:13.723712 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT 
    payment_type
    case payment_type
        when payment_type "CASH_IN" THEN 1
        when payment_type "CASH_OUT" THEN 2
        when payment_type "DEBIT" THEN 3
        when payment_type "PAYMENT" THEN 4
    end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_payment_type
  );
    
2022-12-17 01:00:13.926838 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/4fd7b988-f599-48fc-842c-d960d1854b63?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword CASE at [14:5]',)
2022-12-17 01:00:14.931005 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 50284), raddr=('142.250.159.95', 443)>
2022-12-17 01:00:14.931417 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 56286), raddr=('172.217.214.95', 443)>
2022-12-17 01:00:14.931691 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 50292), raddr=('142.250.159.95', 443)>
2022-12-17 01:00:14.931895 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 56294), raddr=('172.217.214.95', 443)>
2022-12-17 01:00:14.932167 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 50298), raddr=('142.250.159.95', 443)>
2022-12-17 01:00:14.932357 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 56302), raddr=('172.217.214.95', 443)>
2022-12-17 01:00:15.128419 (Thread-1): finished collecting timing info
2022-12-17 01:00:15.129322 (Thread-1): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Expected ")" but got keyword CASE at [14:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/bce0cbed-1820-4894-b305-7635d6e6d28e?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword CASE at [14:5]

(job ID: bce0cbed-1820-4894-b305-7635d6e6d28e)

                                                                     -----Query Job SQL Follows-----                                                                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:WITH dim_payment_type AS(
  12:    SELECT 
  13:    payment_type
  14:    case payment_type
  15:        when payment_type "CASH_IN" THEN 1
  16:        when payment_type "CASH_OUT" THEN 2
  17:        when payment_type "DEBIT" THEN 3
  18:        when payment_type "PAYMENT" THEN 4
  19:    end as id_payment_type
  20:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  21:)
  22:
  23:SELECT 
  24:    *
  25:FROM 
  26:    dim_payment_type
  27:  );
  28:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Expected ")" but got keyword CASE at [14:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 01:00:15.133241 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ebc28d-cd3b-480c-a755-18a077cc4872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6732a990f0>]}
2022-12-17 01:00:15.134826 (Thread-1): 01:00:15 | 2 of 5 ERROR creating table model timestamp_fraud_complete.dim_payment_type [ERROR in 1.57s]
2022-12-17 01:00:15.135059 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:00:15.135301 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:00:15.137417 (Thread-1): 01:00:15 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 01:00:15.137867 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:00:15.138044 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:00:15.148211 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:00:15.148745 (Thread-1): finished collecting timing info
2022-12-17 01:00:15.154293 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:00:15.159658 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:00:15.318084 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:00:15.318885 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 01:00:20.729482 (Thread-1): finished collecting timing info
2022-12-17 01:00:20.730668 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ebc28d-cd3b-480c-a755-18a077cc4872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673293f128>]}
2022-12-17 01:00:20.732213 (Thread-1): 01:00:20 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 5.59s]
2022-12-17 01:00:20.732522 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:00:20.732821 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:00:20.734398 (Thread-1): 01:00:20 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 01:00:20.735007 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:00:20.735291 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:00:20.746006 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:00:20.746557 (Thread-1): finished collecting timing info
2022-12-17 01:00:20.752424 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:00:20.757782 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:00:20.898845 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:00:20.899607 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 01:00:27.781657 (Thread-1): finished collecting timing info
2022-12-17 01:00:27.782761 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ebc28d-cd3b-480c-a755-18a077cc4872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673293b550>]}
2022-12-17 01:00:27.784563 (Thread-1): 01:00:27 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 7.05s]
2022-12-17 01:00:27.784831 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:00:27.785179 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:00:27.786806 (Thread-1): 01:00:27 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 01:00:27.787298 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:00:27.787561 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:00:27.797943 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:00:27.798542 (Thread-1): finished collecting timing info
2022-12-17 01:00:27.803978 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:00:27.809770 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:00:27.960902 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:00:27.961548 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 01:00:28.297832 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/068ea33d-96b5-411e-aa69-c294e675a4b3?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]',)
2022-12-17 01:00:29.729623 (Thread-1): finished collecting timing info
2022-12-17 01:00:29.730493 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/bf96f5e2-05be-4852-afc9-68b3104257cd?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]

(job ID: bf96f5e2-05be-4852-afc9-68b3104257cd)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    id_transaction,
  18:    step,
  19:    timestamp,
  20:    payment_type,
  21:    amount,
  22:    old_balance_sender,
  23:    new_balance_sender,
  24:    old_balance_recipient,
  25:    new_balance_recipient,
  26:    is_fraud,
  27:    is_flagged_fraud
  28:FROM
  29:    fact_raw_fraud
  30:  );
  31:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 01:00:29.731365 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ebc28d-cd3b-480c-a755-18a077cc4872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67328f5ac8>]}
2022-12-17 01:00:29.732964 (Thread-1): 01:00:29 | 5 of 5 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 1.94s]
2022-12-17 01:00:29.733197 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:00:29.815401 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:00:29.815961 (MainThread): 01:00:29 | 
2022-12-17 01:00:29.816131 (MainThread): 01:00:29 | Finished running 5 table models in 30.07s.
2022-12-17 01:00:29.816267 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:00:29.816349 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:00:29.868182 (MainThread): 
2022-12-17 01:00:29.868397 (MainThread): Completed with 2 errors and 0 warnings:
2022-12-17 01:00:29.868522 (MainThread): 
2022-12-17 01:00:29.868642 (MainThread): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
2022-12-17 01:00:29.868749 (MainThread):   Syntax error: Expected ")" but got keyword CASE at [14:5]
2022-12-17 01:00:29.868899 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 01:00:29.869065 (MainThread): 
2022-12-17 01:00:29.869281 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-17 01:00:29.869476 (MainThread):   Unrecognized name: amount at [21:5]
2022-12-17 01:00:29.869625 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 01:00:29.869821 (MainThread): 
Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
2022-12-17 01:00:29.870179 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673293ceb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6732937b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6733b21e80>]}
2022-12-17 01:00:29.870534 (MainThread): Flushing usage events
2022-12-17 01:11:59.340627 (MainThread): Running with dbt=0.19.0
2022-12-17 01:11:59.989733 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 01:11:59.990760 (MainThread): Tracking: tracking
2022-12-17 01:11:59.998838 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc60a6ae48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc60a6afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc60a7f1d0>]}
2022-12-17 01:12:00.045571 (MainThread): Partial parsing not enabled
2022-12-17 01:12:00.046604 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:12:00.051166 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:12:00.058973 (MainThread): Parsing macros/etc.sql
2022-12-17 01:12:00.061807 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:12:00.085519 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:12:00.089096 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:12:00.092673 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:12:00.109215 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:12:00.122042 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:12:00.127558 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:12:00.130705 (MainThread): Parsing macros/core.sql
2022-12-17 01:12:00.135743 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:12:00.188092 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:12:00.189565 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:12:00.200849 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:12:00.203010 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:12:00.205089 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:12:00.206675 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:12:00.209285 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:12:00.211629 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:12:00.214148 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:12:00.217665 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:12:00.219689 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:12:00.230831 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:12:00.239014 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:12:00.241353 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:12:00.248902 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:12:00.265874 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:12:00.268153 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:12:00.290189 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:12:00.327940 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:12:00.353272 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:12:00.361348 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:12:00.374739 (MainThread): Partial parsing not enabled
2022-12-17 01:12:00.435073 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:12:00.468319 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:12:00.484873 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:12:00.503910 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:12:00.520931 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:12:00.738184 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a66221f-bcce-41ba-a6df-2812cb14268b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc608d5c88>]}
2022-12-17 01:12:00.790215 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:12:00.791502 (MainThread): 
2022-12-17 01:12:00.792003 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:12:00.800423 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:12:00.800762 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:12:00.806674 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:12:00.949522 (MainThread): 01:12:00 | Concurrency: 1 threads (target='dev')
2022-12-17 01:12:00.949853 (MainThread): 01:12:00 | 
2022-12-17 01:12:00.952213 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:12:00.952667 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:12:00.952884 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:12:00.974264 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:12:00.974757 (Thread-1): finished collecting timing info
2022-12-17 01:12:00.975201 (Thread-1): finished collecting timing info
2022-12-17 01:12:00.975852 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:12:00.976486 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:12:00.976868 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:12:00.977058 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:12:00.986808 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:12:00.987246 (Thread-1): finished collecting timing info
2022-12-17 01:12:00.987661 (Thread-1): finished collecting timing info
2022-12-17 01:12:00.988233 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:12:00.988455 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:12:00.988946 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:12:00.989115 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:12:00.998345 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:12:00.998747 (Thread-1): finished collecting timing info
2022-12-17 01:12:00.999114 (Thread-1): finished collecting timing info
2022-12-17 01:12:00.999691 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:12:00.999913 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:12:01.000415 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:12:01.000583 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:12:01.009789 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:12:01.010187 (Thread-1): finished collecting timing info
2022-12-17 01:12:01.010619 (Thread-1): finished collecting timing info
2022-12-17 01:12:01.011179 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:12:01.011426 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:12:01.011899 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:12:01.012064 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:12:01.021472 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:12:01.021854 (Thread-1): finished collecting timing info
2022-12-17 01:12:01.022230 (Thread-1): finished collecting timing info
2022-12-17 01:12:01.022780 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:12:01.052099 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:12:01.052277 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:12:01.102545 (MainThread): 01:12:01 | Done.
2022-12-17 01:12:01.102938 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc607d54e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6081bf28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc60906128>]}
2022-12-17 01:12:01.103280 (MainThread): Flushing usage events
2022-12-17 01:12:04.248930 (MainThread): Running with dbt=0.19.0
2022-12-17 01:12:04.906574 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 01:12:04.907887 (MainThread): Tracking: tracking
2022-12-17 01:12:04.915936 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab5dd8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab5dd8f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab5dd8f60>]}
2022-12-17 01:12:04.958579 (MainThread): Partial parsing not enabled
2022-12-17 01:12:04.959669 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:12:04.964344 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:12:04.972146 (MainThread): Parsing macros/etc.sql
2022-12-17 01:12:04.974806 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:12:04.998400 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:12:05.001941 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:12:05.005510 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:12:05.021467 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:12:05.033526 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:12:05.038932 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:12:05.042192 (MainThread): Parsing macros/core.sql
2022-12-17 01:12:05.047105 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:12:05.100209 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:12:05.101566 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:12:05.112853 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:12:05.115030 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:12:05.117207 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:12:05.118687 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:12:05.121310 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:12:05.123631 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:12:05.126063 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:12:05.129502 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:12:05.131549 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:12:05.143004 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:12:05.151068 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:12:05.153419 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:12:05.161115 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:12:05.178072 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:12:05.180365 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:12:05.202207 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:12:05.240223 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:12:05.265574 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:12:05.273218 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:12:05.286352 (MainThread): Partial parsing not enabled
2022-12-17 01:12:05.345408 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:12:05.378819 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:12:05.395456 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:12:05.414064 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:12:05.431232 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:12:05.648356 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '571e2db4-6aa6-452c-ae9b-39d4dc370bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab5c46048>]}
2022-12-17 01:12:05.701032 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:12:05.702261 (MainThread): 
2022-12-17 01:12:05.702788 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:12:05.711489 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 01:12:05.711827 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:12:05.883497 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:12:05.883860 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 01:12:05.889095 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:12:06.015540 (MainThread): 01:12:06 | Concurrency: 1 threads (target='dev')
2022-12-17 01:12:06.015799 (MainThread): 01:12:06 | 
2022-12-17 01:12:06.018524 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:12:06.020123 (Thread-1): 01:12:06 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 01:12:06.020571 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:12:06.020815 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:12:06.043036 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:12:06.043651 (Thread-1): finished collecting timing info
2022-12-17 01:12:06.069876 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:12:06.075492 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:12:06.283982 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:12:06.284544 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 01:12:16.524017 (Thread-1): finished collecting timing info
2022-12-17 01:12:16.525048 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '571e2db4-6aa6-452c-ae9b-39d4dc370bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ac7800668>]}
2022-12-17 01:12:16.526429 (Thread-1): 01:12:16 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 645.5 MB processed) in 10.50s]
2022-12-17 01:12:16.526629 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:12:16.527395 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:12:16.528784 (Thread-1): 01:12:16 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 01:12:16.529327 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:12:16.529516 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:12:16.539900 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:12:16.540425 (Thread-1): finished collecting timing info
2022-12-17 01:12:16.545960 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:12:16.551312 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:12:16.698476 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:12:16.699229 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT 
    case id_payment_type
        when id_payment_type "CASH_IN" THEN 1
        when id_payment_type "CASH_OUT" THEN 2
        when id_payment_type "DEBIT" THEN 3
        when id_payment_type "PAYMENT" THEN 4
    end as id_payment_type
    -- payment_type
    -- case payment_type
    --     when payment_type "CASH_IN" THEN 1
    --     when payment_type "CASH_OUT" THEN 2
    --     when payment_type "DEBIT" THEN 3
    --     when payment_type "PAYMENT" THEN 4
    -- end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_payment_type
  );
    
2022-12-17 01:12:16.938681 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/2db1caec-ec73-4051-991b-fdfda193d56a?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [14:30]',)
2022-12-17 01:12:17.636323 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 32776), raddr=('142.250.159.95', 443)>
2022-12-17 01:12:17.636656 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 58540), raddr=('173.194.194.95', 443)>
2022-12-17 01:12:17.636891 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 32778), raddr=('142.250.159.95', 443)>
2022-12-17 01:12:17.637096 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 58554), raddr=('173.194.194.95', 443)>
2022-12-17 01:12:17.637346 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 32788), raddr=('142.250.159.95', 443)>
2022-12-17 01:12:17.637522 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 58568), raddr=('173.194.194.95', 443)>
2022-12-17 01:12:17.707577 (Thread-1): finished collecting timing info
2022-12-17 01:12:17.708409 (Thread-1): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [14:30]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/d75bd4d2-5d64-433b-b831-568be49184d3?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected string literal "CASH_IN" at [14:30]

(job ID: d75bd4d2-5d64-433b-b831-568be49184d3)

                                                                     -----Query Job SQL Follows-----                                                                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:WITH dim_payment_type AS(
  12:    SELECT 
  13:    case id_payment_type
  14:        when id_payment_type "CASH_IN" THEN 1
  15:        when id_payment_type "CASH_OUT" THEN 2
  16:        when id_payment_type "DEBIT" THEN 3
  17:        when id_payment_type "PAYMENT" THEN 4
  18:    end as id_payment_type
  19:    -- payment_type
  20:    -- case payment_type
  21:    --     when payment_type "CASH_IN" THEN 1
  22:    --     when payment_type "CASH_OUT" THEN 2
  23:    --     when payment_type "DEBIT" THEN 3
  24:    --     when payment_type "PAYMENT" THEN 4
  25:    -- end as id_payment_type
  26:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  27:)
  28:
  29:SELECT 
  30:    *
  31:FROM 
  32:    dim_payment_type
  33:  );
  34:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
  Syntax error: Unexpected string literal "CASH_IN" at [14:30]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 01:12:17.712344 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '571e2db4-6aa6-452c-ae9b-39d4dc370bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab4bbb2b0>]}
2022-12-17 01:12:17.713852 (Thread-1): 01:12:17 | 2 of 5 ERROR creating table model timestamp_fraud_complete.dim_payment_type [ERROR in 1.18s]
2022-12-17 01:12:17.714058 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:12:17.714283 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:12:17.715913 (Thread-1): 01:12:17 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 01:12:17.716334 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:12:17.716486 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:12:17.726680 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:12:17.727126 (Thread-1): finished collecting timing info
2022-12-17 01:12:17.732442 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:12:17.737615 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:12:17.896049 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:12:17.896741 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 01:12:23.453378 (Thread-1): finished collecting timing info
2022-12-17 01:12:23.454538 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '571e2db4-6aa6-452c-ae9b-39d4dc370bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab4a65fd0>]}
2022-12-17 01:12:23.456016 (Thread-1): 01:12:23 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 5.74s]
2022-12-17 01:12:23.456275 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:12:23.456517 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:12:23.458977 (Thread-1): 01:12:23 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 01:12:23.459546 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:12:23.459810 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:12:23.469874 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:12:23.470458 (Thread-1): finished collecting timing info
2022-12-17 01:12:23.475814 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:12:23.480993 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:12:23.655486 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:12:23.656156 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 01:12:29.047225 (Thread-1): finished collecting timing info
2022-12-17 01:12:29.048404 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '571e2db4-6aa6-452c-ae9b-39d4dc370bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab4a6e1d0>]}
2022-12-17 01:12:29.050213 (Thread-1): 01:12:29 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 5.59s]
2022-12-17 01:12:29.050511 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:12:29.050813 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:12:29.052245 (Thread-1): 01:12:29 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 01:12:29.052703 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:12:29.052927 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:12:29.062538 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:12:29.063067 (Thread-1): finished collecting timing info
2022-12-17 01:12:29.068878 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:12:29.074063 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:12:29.230957 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:12:29.231652 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 01:12:29.627299 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/2e3ee8dc-077a-4631-89e7-0676610a0b0c?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]',)
2022-12-17 01:12:30.244601 (Thread-1): finished collecting timing info
2022-12-17 01:12:30.245493 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/c337d86b-9be8-46ee-8e82-f70b29b63be6?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]

(job ID: c337d86b-9be8-46ee-8e82-f70b29b63be6)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    id_transaction,
  18:    step,
  19:    timestamp,
  20:    payment_type,
  21:    amount,
  22:    old_balance_sender,
  23:    new_balance_sender,
  24:    old_balance_recipient,
  25:    new_balance_recipient,
  26:    is_fraud,
  27:    is_flagged_fraud
  28:FROM
  29:    fact_raw_fraud
  30:  );
  31:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 01:12:30.246587 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '571e2db4-6aa6-452c-ae9b-39d4dc370bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab4a21828>]}
2022-12-17 01:12:30.248165 (Thread-1): 01:12:30 | 5 of 5 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 1.19s]
2022-12-17 01:12:30.248384 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:12:30.272195 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:12:30.272670 (MainThread): 01:12:30 | 
2022-12-17 01:12:30.272874 (MainThread): 01:12:30 | Finished running 5 table models in 24.57s.
2022-12-17 01:12:30.273075 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:12:30.273213 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:12:30.324206 (MainThread): 
2022-12-17 01:12:30.324479 (MainThread): Completed with 2 errors and 0 warnings:
2022-12-17 01:12:30.324712 (MainThread): 
2022-12-17 01:12:30.324928 (MainThread): Database Error in model dim_payment_type (models/warehouse/dim_payment_type.sql)
2022-12-17 01:12:30.325142 (MainThread):   Syntax error: Unexpected string literal "CASH_IN" at [14:30]
2022-12-17 01:12:30.325501 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/dim_payment_type.sql
2022-12-17 01:12:30.325754 (MainThread): 
2022-12-17 01:12:30.325974 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-17 01:12:30.326192 (MainThread):   Unrecognized name: amount at [21:5]
2022-12-17 01:12:30.326393 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 01:12:30.326635 (MainThread): 
Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
2022-12-17 01:12:30.326970 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab5aede80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab5adb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab4b5df28>]}
2022-12-17 01:12:30.327274 (MainThread): Flushing usage events
2022-12-17 01:15:23.363198 (MainThread): Running with dbt=0.19.0
2022-12-17 01:15:24.039464 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 01:15:24.040554 (MainThread): Tracking: tracking
2022-12-17 01:15:24.048513 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833632bdd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833632bf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f833632bf98>]}
2022-12-17 01:15:24.092930 (MainThread): Partial parsing not enabled
2022-12-17 01:15:24.093979 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:15:24.098722 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:15:24.106820 (MainThread): Parsing macros/etc.sql
2022-12-17 01:15:24.109784 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:15:24.133479 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:15:24.137083 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:15:24.140553 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:15:24.156248 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:15:24.168312 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:15:24.173729 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:15:24.177007 (MainThread): Parsing macros/core.sql
2022-12-17 01:15:24.182017 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:15:24.234563 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:15:24.235978 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:15:24.246955 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:15:24.249161 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:15:24.251212 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:15:24.252592 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:15:24.255158 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:15:24.257376 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:15:24.259912 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:15:24.263285 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:15:24.265294 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:15:24.276676 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:15:24.284894 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:15:24.287240 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:15:24.294820 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:15:24.312216 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:15:24.314538 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:15:24.337158 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:15:24.374933 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:15:24.400839 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:15:24.408792 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:15:24.422204 (MainThread): Partial parsing not enabled
2022-12-17 01:15:24.481408 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:15:24.516217 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:15:24.533498 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:15:24.552346 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:15:24.569332 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:15:24.787449 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c33dff0-cc39-4fc3-9bd2-7fbdc40f98f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8336199588>]}
2022-12-17 01:15:24.839748 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:15:24.841005 (MainThread): 
2022-12-17 01:15:24.841491 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:15:24.849922 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:15:24.850205 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:15:24.856017 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:15:24.988968 (MainThread): 01:15:24 | Concurrency: 1 threads (target='dev')
2022-12-17 01:15:24.989283 (MainThread): 01:15:24 | 
2022-12-17 01:15:24.991419 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:15:24.991922 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:15:24.992154 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:15:25.015309 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:15:25.015852 (Thread-1): finished collecting timing info
2022-12-17 01:15:25.016283 (Thread-1): finished collecting timing info
2022-12-17 01:15:25.016880 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:15:25.017538 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:15:25.017916 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:15:25.018081 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:15:25.028140 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:15:25.028578 (Thread-1): finished collecting timing info
2022-12-17 01:15:25.028958 (Thread-1): finished collecting timing info
2022-12-17 01:15:25.029510 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:15:25.029736 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:15:25.030240 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:15:25.030407 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:15:25.039900 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:15:25.040333 (Thread-1): finished collecting timing info
2022-12-17 01:15:25.040704 (Thread-1): finished collecting timing info
2022-12-17 01:15:25.041260 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:15:25.041480 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:15:25.041976 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:15:25.042143 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:15:25.051474 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:15:25.051924 (Thread-1): finished collecting timing info
2022-12-17 01:15:25.052298 (Thread-1): finished collecting timing info
2022-12-17 01:15:25.052853 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:15:25.053073 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:15:25.053584 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:15:25.053758 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:15:25.063235 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:15:25.063689 (Thread-1): finished collecting timing info
2022-12-17 01:15:25.064060 (Thread-1): finished collecting timing info
2022-12-17 01:15:25.064616 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:15:25.091447 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:15:25.091639 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:15:25.141990 (MainThread): 01:15:25 | Done.
2022-12-17 01:15:25.142294 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83361c70b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8336196f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8335f894e0>]}
2022-12-17 01:15:25.142540 (MainThread): Flushing usage events
2022-12-17 01:15:29.956365 (MainThread): Running with dbt=0.19.0
2022-12-17 01:15:30.627684 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 01:15:30.628880 (MainThread): Tracking: tracking
2022-12-17 01:15:30.637081 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc37669e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc37669f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc37669fd0>]}
2022-12-17 01:15:30.688390 (MainThread): Partial parsing not enabled
2022-12-17 01:15:30.689803 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:15:30.696743 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:15:30.704541 (MainThread): Parsing macros/etc.sql
2022-12-17 01:15:30.707173 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:15:30.731446 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:15:30.734994 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:15:30.738792 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:15:30.755109 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:15:30.767590 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:15:30.773219 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:15:30.776482 (MainThread): Parsing macros/core.sql
2022-12-17 01:15:30.781651 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:15:30.834969 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:15:30.836374 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:15:30.847771 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:15:30.849931 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:15:30.852033 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:15:30.853382 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:15:30.855961 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:15:30.858131 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:15:30.860570 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:15:30.863987 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:15:30.865948 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:15:30.877517 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:15:30.885803 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:15:30.888257 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:15:30.896060 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:15:30.914000 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:15:30.916408 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:15:30.939856 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:15:30.978058 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:15:31.003884 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:15:31.011647 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:15:31.025743 (MainThread): Partial parsing not enabled
2022-12-17 01:15:31.085980 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:15:31.120701 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:15:31.137807 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:15:31.157254 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:15:31.174437 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:15:31.397619 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67cd8470-89da-419f-bd13-1434ad1b956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc374d7198>]}
2022-12-17 01:15:31.450760 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:15:31.452098 (MainThread): 
2022-12-17 01:15:31.452596 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:15:31.461490 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 01:15:31.461930 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:15:31.618082 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:15:31.618466 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 01:15:31.623870 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:15:31.748267 (MainThread): 01:15:31 | Concurrency: 1 threads (target='dev')
2022-12-17 01:15:31.748561 (MainThread): 01:15:31 | 
2022-12-17 01:15:31.750690 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:15:31.752174 (Thread-1): 01:15:31 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 01:15:31.752648 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:15:31.752849 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:15:31.774805 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:15:31.775509 (Thread-1): finished collecting timing info
2022-12-17 01:15:31.802375 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:15:31.807734 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:15:31.973907 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:15:31.974569 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
     case id_payment_type
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 01:15:32.192714 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/234e4e1b-20bf-4d05-8f77-371452deaf1a?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword CASE at [36:5]',)
2022-12-17 01:15:32.674322 (Thread-1): finished collecting timing info
2022-12-17 01:15:32.675506 (Thread-1): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Expected ")" but got keyword CASE at [36:5]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/88642686-1bf0-4228-a169-375961c609bb?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword CASE at [36:5]

(job ID: 88642686-1bf0-4228-a169-375961c609bb)

                                                                    -----Query Job SQL Follows-----                                                                    

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:
  12:SELECT     
  13:    transactionID as id_transaction,
  14:    step,
  15:    timestamp,
  16:    type as payment_type,
  17:    --     -- CASE payment_type,
  18:    -- --     WHEN "CASH_IN" THEN 1
  19:    -- --     WHEN "CASH_OUT" THEN 2
  20:    -- --     WHEN "DEBIT" THEN 3
  21:    -- --     WHEN "PAYMENT" THEN 4
  22:    -- --     WHEN "TRANSFER" THEN 5
  23:    -- -- END AS id_payment_type,
  24:    -- -- COUNT(*) AS total_of_payment_type
  25:    -- amount,
  26:    nameOrig as name_sender,
  27:    oldbalanceOrg as old_balance_sender,
  28:    newbalanceOrig as new_balance_sender,
  29:    nameDest as name_recipient,
  30:    oldbalanceDest as old_balance_recipient,
  31:    newbalanceDest as new_balance_recipient,
  32:     case id_payment_type
  33:        when 0 then "Not Fraud"
  34:        when 1 then "Fraud"
  35:    end
  36:    case isFraud
  37:        when 0 then "Not Fraud"
  38:        when 1 then "Fraud"
  39:    end as is_fraud,
  40:    case isFlaggedFraud
  41:        when 0 then "Not Fraud"
  42:        when 1 then "Fraud"
  43:    end as is_flagged_fraud,
  44:FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
  45:ORDER BY timestamp, step
  46:  );
  47:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
  Syntax error: Expected ")" but got keyword CASE at [36:5]
  compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 01:15:32.679513 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67cd8470-89da-419f-bd13-1434ad1b956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc372d14e0>]}
2022-12-17 01:15:32.681097 (Thread-1): 01:15:32 | 1 of 5 ERROR creating table model timestamp_fraud_complete.stg_raw_fraud [ERROR in 0.93s]
2022-12-17 01:15:32.681333 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:15:32.681956 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:15:32.682187 (Thread-1): 01:15:32 | 2 of 5 SKIP relation timestamp_fraud_complete.dim_payment_type....... [SKIP]
2022-12-17 01:15:32.682378 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:15:32.682579 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:15:32.682837 (Thread-1): 01:15:32 | 3 of 5 SKIP relation timestamp_fraud_complete.dim_recipient.......... [SKIP]
2022-12-17 01:15:32.683016 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:15:32.683214 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:15:32.683468 (Thread-1): 01:15:32 | 4 of 5 SKIP relation timestamp_fraud_complete.dim_sender............. [SKIP]
2022-12-17 01:15:32.683646 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:15:32.684009 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:15:32.684341 (Thread-1): 01:15:32 | 5 of 5 SKIP relation timestamp_fraud_complete.fact_tables............ [SKIP]
2022-12-17 01:15:32.684540 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:15:32.752944 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:15:32.753521 (MainThread): 01:15:32 | 
2022-12-17 01:15:32.753741 (MainThread): 01:15:32 | Finished running 5 table models in 1.30s.
2022-12-17 01:15:32.753915 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:15:32.754048 (MainThread): Connection 'model.online_payment_fraud.stg_raw_fraud' was properly closed.
2022-12-17 01:15:32.805551 (MainThread): 
2022-12-17 01:15:32.805809 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 01:15:32.805983 (MainThread): 
2022-12-17 01:15:32.806179 (MainThread): Database Error in model stg_raw_fraud (models/staging/stg_raw_fraud.sql)
2022-12-17 01:15:32.806362 (MainThread):   Syntax error: Expected ")" but got keyword CASE at [36:5]
2022-12-17 01:15:32.806617 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/staging/stg_raw_fraud.sql
2022-12-17 01:15:32.806838 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
2022-12-17 01:15:32.807194 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc373bf6d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc37697c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc374b86d8>]}
2022-12-17 01:15:32.807570 (MainThread): Flushing usage events
2022-12-17 01:17:48.967472 (MainThread): Running with dbt=0.19.0
2022-12-17 01:17:49.655923 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 01:17:49.657285 (MainThread): Tracking: tracking
2022-12-17 01:17:49.665669 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b36d3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b36d3f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b36d3fd0>]}
2022-12-17 01:17:49.719988 (MainThread): Partial parsing not enabled
2022-12-17 01:17:49.721444 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:17:49.727822 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:17:49.735976 (MainThread): Parsing macros/etc.sql
2022-12-17 01:17:49.738688 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:17:49.763529 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:17:49.767122 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:17:49.770587 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:17:49.787414 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:17:49.800104 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:17:49.805615 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:17:49.808922 (MainThread): Parsing macros/core.sql
2022-12-17 01:17:49.814331 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:17:49.867439 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:17:49.868797 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:17:49.880106 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:17:49.882305 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:17:49.884368 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:17:49.885817 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:17:49.888398 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:17:49.890568 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:17:49.893022 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:17:49.896445 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:17:49.898712 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:17:49.910043 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:17:49.918957 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:17:49.921432 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:17:49.929119 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:17:49.946454 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:17:49.949091 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:17:49.971445 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:17:50.009860 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:17:50.035743 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:17:50.043553 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:17:50.057725 (MainThread): Partial parsing not enabled
2022-12-17 01:17:50.118120 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:17:50.152304 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:17:50.169815 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:17:50.187394 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:17:50.205534 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:17:50.429564 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '921867f5-780f-4a8c-a937-ed6663d361d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c50425f8>]}
2022-12-17 01:17:50.481964 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:17:50.483185 (MainThread): 
2022-12-17 01:17:50.483677 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:17:50.495787 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:17:50.496147 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:17:50.502538 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:17:50.639153 (MainThread): 01:17:50 | Concurrency: 1 threads (target='dev')
2022-12-17 01:17:50.639457 (MainThread): 01:17:50 | 
2022-12-17 01:17:50.641888 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:17:50.642429 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:17:50.642701 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:17:50.664395 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:17:50.665011 (Thread-1): finished collecting timing info
2022-12-17 01:17:50.665468 (Thread-1): finished collecting timing info
2022-12-17 01:17:50.666083 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:17:50.666725 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:17:50.667121 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:17:50.667290 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:17:50.676888 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:17:50.677325 (Thread-1): finished collecting timing info
2022-12-17 01:17:50.677700 (Thread-1): finished collecting timing info
2022-12-17 01:17:50.678246 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:17:50.678466 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:17:50.678906 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:17:50.679081 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:17:50.688257 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:17:50.688660 (Thread-1): finished collecting timing info
2022-12-17 01:17:50.689038 (Thread-1): finished collecting timing info
2022-12-17 01:17:50.689570 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:17:50.689817 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:17:50.690244 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:17:50.690408 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:17:50.699890 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:17:50.700278 (Thread-1): finished collecting timing info
2022-12-17 01:17:50.700646 (Thread-1): finished collecting timing info
2022-12-17 01:17:50.701191 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:17:50.701411 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:17:50.701843 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:17:50.702011 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:17:50.711345 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:17:50.711761 (Thread-1): finished collecting timing info
2022-12-17 01:17:50.712124 (Thread-1): finished collecting timing info
2022-12-17 01:17:50.712653 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:17:50.741537 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:17:50.741712 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:17:50.792205 (MainThread): 01:17:50 | Done.
2022-12-17 01:17:50.795696 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b34f77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b34127f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b3412630>]}
2022-12-17 01:17:50.796054 (MainThread): Flushing usage events
2022-12-17 01:17:55.667461 (MainThread): Running with dbt=0.19.0
2022-12-17 01:17:56.333226 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 01:17:56.334460 (MainThread): Tracking: tracking
2022-12-17 01:17:56.342916 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f8beae48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f8beaf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f8beaf98>]}
2022-12-17 01:17:56.373710 (MainThread): Partial parsing not enabled
2022-12-17 01:17:56.374724 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:17:56.379428 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:17:56.387492 (MainThread): Parsing macros/etc.sql
2022-12-17 01:17:56.390483 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:17:56.415098 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:17:56.418785 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:17:56.422390 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:17:56.438853 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:17:56.451067 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:17:56.456608 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:17:56.459915 (MainThread): Parsing macros/core.sql
2022-12-17 01:17:56.465032 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:17:56.518530 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:17:56.519969 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:17:56.531883 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:17:56.534133 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:17:56.536262 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:17:56.537690 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:17:56.540345 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:17:56.542587 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:17:56.545050 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:17:56.548662 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:17:56.550692 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:17:56.562934 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:17:56.571129 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:17:56.573513 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:17:56.581156 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:17:56.598883 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:17:56.601219 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:17:56.623441 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:17:56.662255 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:17:56.687740 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:17:56.695444 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:17:56.708732 (MainThread): Partial parsing not enabled
2022-12-17 01:17:56.767222 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:17:56.800758 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:17:56.817912 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:17:56.835025 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:17:56.852527 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:17:57.069813 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57778aa9-9bff-4a52-96df-6aaabba86ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f89f4748>]}
2022-12-17 01:17:57.122760 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:17:57.124066 (MainThread): 
2022-12-17 01:17:57.124638 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:17:57.134204 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 01:17:57.134569 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:17:57.326973 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:17:57.327393 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 01:17:57.333022 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:17:57.465705 (MainThread): 01:17:57 | Concurrency: 1 threads (target='dev')
2022-12-17 01:17:57.466043 (MainThread): 01:17:57 | 
2022-12-17 01:17:57.468239 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:17:57.469663 (Thread-1): 01:17:57 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 01:17:57.470160 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:17:57.470398 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:17:57.492237 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:17:57.492774 (Thread-1): finished collecting timing info
2022-12-17 01:17:57.519308 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:17:57.524603 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:17:57.701131 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:17:57.701840 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 01:18:09.602743 (Thread-1): finished collecting timing info
2022-12-17 01:18:09.603876 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57778aa9-9bff-4a52-96df-6aaabba86ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860a605860>]}
2022-12-17 01:18:09.605319 (Thread-1): 01:18:09 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 645.5 MB processed) in 12.13s]
2022-12-17 01:18:09.606378 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:18:09.607131 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:18:09.608710 (Thread-1): 01:18:09 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 01:18:09.609469 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:18:09.609684 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:18:09.620214 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:18:09.620747 (Thread-1): finished collecting timing info
2022-12-17 01:18:09.626062 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:18:09.631278 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:18:09.790941 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:18:09.791712 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT 
    payment_type
    -- payment_type
    -- case payment_type
    --     when payment_type "CASH_IN" THEN 1
    --     when payment_type "CASH_OUT" THEN 2
    --     when payment_type "DEBIT" THEN 3
    --     when payment_type "PAYMENT" THEN 4
    -- end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_payment_type
  );
    
2022-12-17 01:18:13.179808 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 34390), raddr=('108.177.121.95', 443)>
2022-12-17 01:18:13.180205 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 45530), raddr=('74.125.124.95', 443)>
2022-12-17 01:18:13.180447 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 34394), raddr=('108.177.121.95', 443)>
2022-12-17 01:18:13.180656 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 45542), raddr=('74.125.124.95', 443)>
2022-12-17 01:18:13.181005 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 34396), raddr=('108.177.121.95', 443)>
2022-12-17 01:18:13.181271 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 45552), raddr=('74.125.124.95', 443)>
2022-12-17 01:18:13.183541 (Thread-1): finished collecting timing info
2022-12-17 01:18:13.184540 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57778aa9-9bff-4a52-96df-6aaabba86ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f81dc8d0>]}
2022-12-17 01:18:13.186090 (Thread-1): 01:18:13 | 2 of 5 OK created table model timestamp_fraud_complete.dim_payment_type [CREATE TABLE (6.4m rows, 57.2 MB processed) in 3.57s]
2022-12-17 01:18:13.186375 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:18:13.186657 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:18:13.188202 (Thread-1): 01:18:13 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 01:18:13.188787 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:18:13.189007 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:18:13.199024 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:18:13.199609 (Thread-1): finished collecting timing info
2022-12-17 01:18:13.205059 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:18:13.210272 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:18:13.365812 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:18:13.366462 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 01:18:18.849429 (Thread-1): finished collecting timing info
2022-12-17 01:18:18.850505 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57778aa9-9bff-4a52-96df-6aaabba86ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f81cec88>]}
2022-12-17 01:18:18.852305 (Thread-1): 01:18:18 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 5.66s]
2022-12-17 01:18:18.852537 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:18:18.852794 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:18:18.854152 (Thread-1): 01:18:18 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 01:18:18.854652 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:18:18.854844 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:18:18.865442 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:18:18.866035 (Thread-1): finished collecting timing info
2022-12-17 01:18:18.871292 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:18:18.876945 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:18:19.045086 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:18:19.045660 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 01:18:25.888722 (Thread-1): finished collecting timing info
2022-12-17 01:18:25.889909 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57778aa9-9bff-4a52-96df-6aaabba86ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f81e6ef0>]}
2022-12-17 01:18:25.891326 (Thread-1): 01:18:25 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 7.04s]
2022-12-17 01:18:25.891554 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:18:25.891771 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:18:25.893277 (Thread-1): 01:18:25 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 01:18:25.893802 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:18:25.894113 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:18:25.904221 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:18:25.904672 (Thread-1): finished collecting timing info
2022-12-17 01:18:25.909915 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:18:25.915068 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:18:26.060482 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:18:26.061032 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 01:18:26.494475 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/30cebe98-d48d-4a12-9f4d-b384a2cd2565?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]',)
2022-12-17 01:18:27.369612 (Thread-1): finished collecting timing info
2022-12-17 01:18:27.370448 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/fc0545d8-87a5-45c5-aea7-90212d96591e?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]

(job ID: fc0545d8-87a5-45c5-aea7-90212d96591e)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    id_transaction,
  18:    step,
  19:    timestamp,
  20:    payment_type,
  21:    amount,
  22:    old_balance_sender,
  23:    new_balance_sender,
  24:    old_balance_recipient,
  25:    new_balance_recipient,
  26:    is_fraud,
  27:    is_flagged_fraud
  28:FROM
  29:    fact_raw_fraud
  30:  );
  31:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 01:18:27.375492 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57778aa9-9bff-4a52-96df-6aaabba86ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f81a9320>]}
2022-12-17 01:18:27.377070 (Thread-1): 01:18:27 | 5 of 5 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 1.48s]
2022-12-17 01:18:27.377275 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:18:27.435042 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:18:27.435640 (MainThread): 01:18:27 | 
2022-12-17 01:18:27.435843 (MainThread): 01:18:27 | Finished running 5 table models in 30.31s.
2022-12-17 01:18:27.436045 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:18:27.436202 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:18:27.487797 (MainThread): 
2022-12-17 01:18:27.488058 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 01:18:27.488282 (MainThread): 
2022-12-17 01:18:27.488479 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-17 01:18:27.488674 (MainThread):   Unrecognized name: amount at [21:5]
2022-12-17 01:18:27.488859 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 01:18:27.489082 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-12-17 01:18:27.489456 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f8bbf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f88dd358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f818f4e0>]}
2022-12-17 01:18:27.489752 (MainThread): Flushing usage events
2022-12-17 01:19:21.684694 (MainThread): Running with dbt=0.19.0
2022-12-17 01:19:22.351745 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 01:19:22.352947 (MainThread): Tracking: tracking
2022-12-17 01:19:22.361288 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd276ba1dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd276ba1f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd276ba1f98>]}
2022-12-17 01:19:22.412526 (MainThread): Partial parsing not enabled
2022-12-17 01:19:22.414136 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:19:22.419249 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:19:22.427243 (MainThread): Parsing macros/etc.sql
2022-12-17 01:19:22.430010 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:19:22.454778 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:19:22.458556 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:19:22.462166 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:19:22.478131 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:19:22.490401 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:19:22.496215 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:19:22.499592 (MainThread): Parsing macros/core.sql
2022-12-17 01:19:22.504525 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:19:22.557793 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:19:22.559276 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:19:22.570724 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:19:22.572974 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:19:22.575091 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:19:22.576588 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:19:22.579235 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:19:22.581478 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:19:22.583987 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:19:22.587497 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:19:22.589532 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:19:22.601459 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:19:22.609914 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:19:22.612515 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:19:22.620295 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:19:22.637527 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:19:22.640003 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:19:22.663229 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:19:22.701229 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:19:22.727190 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:19:22.735285 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:19:22.748778 (MainThread): Partial parsing not enabled
2022-12-17 01:19:22.811844 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:19:22.845644 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:19:22.862427 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:19:22.879245 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:19:22.895988 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:19:23.120053 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4a435b6-06af-4c20-becf-86a83042d571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2769aa080>]}
2022-12-17 01:19:23.172668 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:19:23.174109 (MainThread): 
2022-12-17 01:19:23.174715 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:19:23.183286 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:19:23.183672 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:19:23.189612 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:19:23.319114 (MainThread): 01:19:23 | Concurrency: 1 threads (target='dev')
2022-12-17 01:19:23.319634 (MainThread): 01:19:23 | 
2022-12-17 01:19:23.322350 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:19:23.322855 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:19:23.323083 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:19:23.344943 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:19:23.345519 (Thread-1): finished collecting timing info
2022-12-17 01:19:23.345995 (Thread-1): finished collecting timing info
2022-12-17 01:19:23.346674 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:19:23.347412 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:19:23.347809 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:19:23.347995 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:19:23.357774 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:19:23.358259 (Thread-1): finished collecting timing info
2022-12-17 01:19:23.358652 (Thread-1): finished collecting timing info
2022-12-17 01:19:23.359252 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:19:23.359567 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:19:23.360102 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:19:23.360274 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:19:23.369736 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:19:23.370226 (Thread-1): finished collecting timing info
2022-12-17 01:19:23.370616 (Thread-1): finished collecting timing info
2022-12-17 01:19:23.371210 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:19:23.371467 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:19:23.372005 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:19:23.372178 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:19:23.381744 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:19:23.382205 (Thread-1): finished collecting timing info
2022-12-17 01:19:23.382590 (Thread-1): finished collecting timing info
2022-12-17 01:19:23.383163 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:19:23.383425 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:19:23.383933 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:19:23.384116 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:19:23.393645 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:19:23.394190 (Thread-1): finished collecting timing info
2022-12-17 01:19:23.394575 (Thread-1): finished collecting timing info
2022-12-17 01:19:23.395160 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:19:23.422318 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:19:23.422599 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:19:23.474274 (MainThread): 01:19:23 | Done.
2022-12-17 01:19:23.474627 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd276a3d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd276a09438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27699f2b0>]}
2022-12-17 01:19:23.475211 (MainThread): Flushing usage events
2022-12-17 01:19:27.105139 (MainThread): Running with dbt=0.19.0
2022-12-17 01:19:27.780822 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 01:19:27.781886 (MainThread): Tracking: tracking
2022-12-17 01:19:27.790068 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f22dde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f22ddf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f22ddfd0>]}
2022-12-17 01:19:27.841870 (MainThread): Partial parsing not enabled
2022-12-17 01:19:27.843362 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:19:27.850400 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:19:27.858379 (MainThread): Parsing macros/etc.sql
2022-12-17 01:19:27.861167 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:19:27.884942 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:19:27.888637 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:19:27.892187 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:19:27.908142 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:19:27.920678 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:19:27.926405 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:19:27.929769 (MainThread): Parsing macros/core.sql
2022-12-17 01:19:27.934711 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:19:27.988406 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:19:27.989870 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:19:28.001340 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:19:28.003632 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:19:28.005740 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:19:28.007189 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:19:28.009808 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:19:28.012044 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:19:28.014560 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:19:28.017985 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:19:28.020010 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:19:28.031453 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:19:28.039853 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:19:28.042190 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:19:28.049849 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:19:28.067116 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:19:28.069442 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:19:28.092042 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:19:28.130294 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:19:28.155804 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:19:28.163651 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:19:28.177386 (MainThread): Partial parsing not enabled
2022-12-17 01:19:28.237964 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:19:28.271736 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:19:28.288450 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:19:28.305265 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:19:28.321965 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:19:28.542932 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ea8cf87-1599-4167-8105-7e50bb6d0345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f20e68d0>]}
2022-12-17 01:19:28.595471 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:19:28.596925 (MainThread): 
2022-12-17 01:19:28.597512 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:19:28.606571 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 01:19:28.606966 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:19:28.767439 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:19:28.767782 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 01:19:28.773024 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:19:28.913718 (MainThread): 01:19:28 | Concurrency: 1 threads (target='dev')
2022-12-17 01:19:28.914021 (MainThread): 01:19:28 | 
2022-12-17 01:19:28.916326 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:19:28.917748 (Thread-1): 01:19:28 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 01:19:28.918186 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:19:28.918412 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:19:28.940209 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:19:28.940757 (Thread-1): finished collecting timing info
2022-12-17 01:19:28.968057 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:19:28.973303 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:19:29.131362 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:19:29.132187 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    --     -- CASE payment_type,
    -- --     WHEN "CASH_IN" THEN 1
    -- --     WHEN "CASH_OUT" THEN 2
    -- --     WHEN "DEBIT" THEN 3
    -- --     WHEN "PAYMENT" THEN 4
    -- --     WHEN "TRANSFER" THEN 5
    -- -- END AS id_payment_type,
    -- -- COUNT(*) AS total_of_payment_type
    -- amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 01:19:40.646544 (Thread-1): finished collecting timing info
2022-12-17 01:19:40.647673 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea8cf87-1599-4167-8105-7e50bb6d0345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39fe9cb1d0>]}
2022-12-17 01:19:40.649585 (Thread-1): 01:19:40 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 645.5 MB processed) in 11.73s]
2022-12-17 01:19:40.649852 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:19:40.650627 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:19:40.652060 (Thread-1): 01:19:40 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 01:19:40.652530 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:19:40.652719 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:19:40.662574 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:19:40.663055 (Thread-1): finished collecting timing info
2022-12-17 01:19:40.668496 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:19:40.673651 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:19:40.811917 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:19:40.812741 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT 
    payment_type
    -- payment_type
    -- case payment_type
    --     when payment_type "CASH_IN" THEN 1
    --     when payment_type "CASH_OUT" THEN 2
    --     when payment_type "DEBIT" THEN 3
    --     when payment_type "PAYMENT" THEN 4
    -- end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_payment_type
  );
    
2022-12-17 01:19:44.013026 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 48622), raddr=('108.177.121.95', 443)>
2022-12-17 01:19:44.013480 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 60318), raddr=('74.125.124.95', 443)>
2022-12-17 01:19:44.013760 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 48630), raddr=('108.177.121.95', 443)>
2022-12-17 01:19:44.014002 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 60332), raddr=('74.125.124.95', 443)>
2022-12-17 01:19:44.014285 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 48638), raddr=('108.177.121.95', 443)>
2022-12-17 01:19:44.014494 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 60336), raddr=('74.125.124.95', 443)>
2022-12-17 01:19:44.016770 (Thread-1): finished collecting timing info
2022-12-17 01:19:44.017747 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea8cf87-1599-4167-8105-7e50bb6d0345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f10c3a58>]}
2022-12-17 01:19:44.019549 (Thread-1): 01:19:44 | 2 of 5 OK created table model timestamp_fraud_complete.dim_payment_type [CREATE TABLE (6.4m rows, 57.2 MB processed) in 3.37s]
2022-12-17 01:19:44.019766 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:19:44.020009 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:19:44.021565 (Thread-1): 01:19:44 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 01:19:44.022099 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:19:44.022300 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:19:44.032162 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:19:44.032631 (Thread-1): finished collecting timing info
2022-12-17 01:19:44.038046 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:19:44.043547 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:19:44.194706 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:19:44.195490 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 01:19:49.273639 (Thread-1): finished collecting timing info
2022-12-17 01:19:49.274632 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea8cf87-1599-4167-8105-7e50bb6d0345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f1f44828>]}
2022-12-17 01:19:49.276370 (Thread-1): 01:19:49 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 5.25s]
2022-12-17 01:19:49.276575 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:19:49.276844 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:19:49.278882 (Thread-1): 01:19:49 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 01:19:49.279332 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:19:49.279608 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:19:49.289773 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:19:49.290248 (Thread-1): finished collecting timing info
2022-12-17 01:19:49.295474 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:19:49.300681 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:19:49.439718 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:19:49.440460 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 01:19:56.074533 (Thread-1): finished collecting timing info
2022-12-17 01:19:56.075671 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea8cf87-1599-4167-8105-7e50bb6d0345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f1091cf8>]}
2022-12-17 01:19:56.077146 (Thread-1): 01:19:56 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.80s]
2022-12-17 01:19:56.077398 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:19:56.077630 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:19:56.078864 (Thread-1): 01:19:56 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 01:19:56.080108 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:19:56.080362 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:19:56.090756 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:19:56.091340 (Thread-1): finished collecting timing info
2022-12-17 01:19:56.096605 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:19:56.101914 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:19:56.240303 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:19:56.240847 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 01:19:56.642498 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/bbaaecfd-0560-4b95-838a-2b51c55ec49c?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]',)
2022-12-17 01:19:57.359516 (Thread-1): finished collecting timing info
2022-12-17 01:19:57.360475 (Thread-1): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1028, in done
    timeout=transport_timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/home/jee/.local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/home/jee/.local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/final-project-team1/queries/549d02ab-2c03-4a25-8d76-2431a755cafc?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [21:5]

(job ID: 549d02ab-2c03-4a25-8d76-2431a755cafc)

                                                                   -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */
   2:
   3:
   4:  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    
  10:
  11:with fact_raw_fraud as (
  12:    SELECT * 
  13:    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  14:)
  15:
  16:SELECT 
  17:    id_transaction,
  18:    step,
  19:    timestamp,
  20:    payment_type,
  21:    amount,
  22:    old_balance_sender,
  23:    new_balance_sender,
  24:    old_balance_recipient,
  25:    new_balance_recipient,
  26:    is_fraud,
  27:    is_flagged_fraud
  28:FROM
  29:    fact_raw_fraud
  30:  );
  31:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/home/jee/.local/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_tables (models/warehouse/fact_tables.sql)
  Unrecognized name: amount at [21:5]
  compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 01:19:57.366003 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea8cf87-1599-4167-8105-7e50bb6d0345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f1f44e80>]}
2022-12-17 01:19:57.367732 (Thread-1): 01:19:57 | 5 of 5 ERROR creating table model timestamp_fraud_complete.fact_tables [ERROR in 1.29s]
2022-12-17 01:19:57.367951 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:19:57.383059 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:19:57.383525 (MainThread): 01:19:57 | 
2022-12-17 01:19:57.383763 (MainThread): 01:19:57 | Finished running 5 table models in 28.79s.
2022-12-17 01:19:57.383947 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:19:57.384079 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:19:57.436061 (MainThread): 
2022-12-17 01:19:57.436322 (MainThread): Completed with 1 error and 0 warnings:
2022-12-17 01:19:57.436505 (MainThread): 
2022-12-17 01:19:57.436704 (MainThread): Database Error in model fact_tables (models/warehouse/fact_tables.sql)
2022-12-17 01:19:57.436891 (MainThread):   Unrecognized name: amount at [21:5]
2022-12-17 01:19:57.437091 (MainThread):   compiled SQL at target/run/online_payment_fraud/models/warehouse/fact_tables.sql
2022-12-17 01:19:57.437291 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-12-17 01:19:57.437645 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f2145470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f2070eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f1082470>]}
2022-12-17 01:19:57.438010 (MainThread): Flushing usage events
2022-12-17 01:20:50.813668 (MainThread): Running with dbt=0.19.0
2022-12-17 01:20:51.467188 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 01:20:51.468364 (MainThread): Tracking: tracking
2022-12-17 01:20:51.476598 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da144dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da144f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da144f98>]}
2022-12-17 01:20:51.528552 (MainThread): Partial parsing not enabled
2022-12-17 01:20:51.530120 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:20:51.536409 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:20:51.544165 (MainThread): Parsing macros/etc.sql
2022-12-17 01:20:51.546817 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:20:51.570375 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:20:51.573936 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:20:51.577725 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:20:51.593442 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:20:51.605793 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:20:51.611127 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:20:51.614466 (MainThread): Parsing macros/core.sql
2022-12-17 01:20:51.619454 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:20:51.672098 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:20:51.673428 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:20:51.684601 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:20:51.686762 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:20:51.688828 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:20:51.690210 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:20:51.692813 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:20:51.695149 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:20:51.697609 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:20:51.701141 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:20:51.703123 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:20:51.714284 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:20:51.722329 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:20:51.724681 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:20:51.732381 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:20:51.749327 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:20:51.751583 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:20:51.773787 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:20:51.811226 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:20:51.836732 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:20:51.844298 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:20:51.857604 (MainThread): Partial parsing not enabled
2022-12-17 01:20:51.916850 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:20:51.949923 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:20:51.966661 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:20:51.983554 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:20:52.000283 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:20:52.219271 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93e8396b-3917-4c04-b1ce-df4f777ab26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d9f4d278>]}
2022-12-17 01:20:52.273394 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:20:52.274832 (MainThread): 
2022-12-17 01:20:52.275483 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:20:52.284992 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 01:20:52.285307 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:20:52.449016 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:20:52.449378 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 01:20:52.454656 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:20:52.576729 (MainThread): 01:20:52 | Concurrency: 1 threads (target='dev')
2022-12-17 01:20:52.577126 (MainThread): 01:20:52 | 
2022-12-17 01:20:52.579540 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:20:52.581166 (Thread-1): 01:20:52 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 01:20:52.581772 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:20:52.582152 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:20:52.604086 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:20:52.604701 (Thread-1): finished collecting timing info
2022-12-17 01:20:52.632342 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:20:52.637589 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:20:52.806813 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:20:52.807445 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 01:21:04.944197 (Thread-1): finished collecting timing info
2022-12-17 01:21:04.945277 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e8396b-3917-4c04-b1ce-df4f777ab26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d9eeb7f0>]}
2022-12-17 01:21:04.946727 (Thread-1): 01:21:04 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 12.36s]
2022-12-17 01:21:04.946968 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:21:04.947813 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:21:04.949535 (Thread-1): 01:21:04 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 01:21:04.949977 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:21:04.950192 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:21:04.960196 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:21:04.960673 (Thread-1): finished collecting timing info
2022-12-17 01:21:04.965986 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:21:04.971118 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:21:05.110741 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:21:05.111358 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT 
    payment_type
    -- payment_type
    -- case payment_type
    --     when payment_type "CASH_IN" THEN 1
    --     when payment_type "CASH_OUT" THEN 2
    --     when payment_type "DEBIT" THEN 3
    --     when payment_type "PAYMENT" THEN 4
    -- end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_payment_type
  );
    
2022-12-17 01:21:08.213813 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 45754), raddr=('108.177.121.95', 443)>
2022-12-17 01:21:08.214140 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 52596), raddr=('74.125.124.95', 443)>
2022-12-17 01:21:08.214372 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 45756), raddr=('108.177.121.95', 443)>
2022-12-17 01:21:08.214553 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 52610), raddr=('74.125.124.95', 443)>
2022-12-17 01:21:08.214784 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 45766), raddr=('108.177.121.95', 443)>
2022-12-17 01:21:08.214999 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 52620), raddr=('74.125.124.95', 443)>
2022-12-17 01:21:08.217463 (Thread-1): finished collecting timing info
2022-12-17 01:21:08.218417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e8396b-3917-4c04-b1ce-df4f777ab26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d8f2bac8>]}
2022-12-17 01:21:08.219930 (Thread-1): 01:21:08 | 2 of 5 OK created table model timestamp_fraud_complete.dim_payment_type [CREATE TABLE (6.4m rows, 57.2 MB processed) in 3.27s]
2022-12-17 01:21:08.220166 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:21:08.220447 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:21:08.221735 (Thread-1): 01:21:08 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 01:21:08.222379 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:21:08.222580 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:21:08.232774 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:21:08.233279 (Thread-1): finished collecting timing info
2022-12-17 01:21:08.238729 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:21:08.243868 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:21:08.381597 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:21:08.382305 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 01:21:14.525360 (Thread-1): finished collecting timing info
2022-12-17 01:21:14.526470 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e8396b-3917-4c04-b1ce-df4f777ab26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d8f3ee80>]}
2022-12-17 01:21:14.528330 (Thread-1): 01:21:14 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.30s]
2022-12-17 01:21:14.528580 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:21:14.528843 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:21:14.530304 (Thread-1): 01:21:14 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 01:21:14.530849 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:21:14.531161 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:21:14.541572 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:21:14.542037 (Thread-1): finished collecting timing info
2022-12-17 01:21:14.547847 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:21:14.553289 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:21:14.698747 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:21:14.699402 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 01:21:21.499147 (Thread-1): finished collecting timing info
2022-12-17 01:21:21.500609 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e8396b-3917-4c04-b1ce-df4f777ab26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d8f3ef28>]}
2022-12-17 01:21:21.502145 (Thread-1): 01:21:21 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.97s]
2022-12-17 01:21:21.502403 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:21:21.502629 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:21:21.504049 (Thread-1): 01:21:21 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 01:21:21.504749 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:21:21.504929 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:21:21.515146 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:21:21.515702 (Thread-1): finished collecting timing info
2022-12-17 01:21:21.521149 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:21:21.526340 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:21:21.658294 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:21:21.658989 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 01:21:32.091772 (Thread-1): finished collecting timing info
2022-12-17 01:21:32.092905 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93e8396b-3917-4c04-b1ce-df4f777ab26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d9ee24a8>]}
2022-12-17 01:21:32.094397 (Thread-1): 01:21:32 | 5 of 5 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 579.0 MB processed) in 10.59s]
2022-12-17 01:21:32.094662 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:21:32.156359 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:21:32.157040 (MainThread): 01:21:32 | 
2022-12-17 01:21:32.157273 (MainThread): 01:21:32 | Finished running 5 table models in 39.88s.
2022-12-17 01:21:32.157448 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:21:32.157565 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:21:32.211348 (MainThread): 
2022-12-17 01:21:32.211623 (MainThread): Completed successfully
2022-12-17 01:21:32.211810 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-12-17 01:21:32.212083 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d9f9fc18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d9f46908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d8eeaeb8>]}
2022-12-17 01:21:32.212355 (MainThread): Flushing usage events
2022-12-17 01:23:54.290905 (MainThread): Running with dbt=0.19.0
2022-12-17 01:23:54.960062 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2022-12-17 01:23:54.961396 (MainThread): Tracking: tracking
2022-12-17 01:23:54.977510 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc827295e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc827295f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc827295fd0>]}
2022-12-17 01:23:55.026223 (MainThread): Partial parsing not enabled
2022-12-17 01:23:55.027661 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:23:55.034389 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:23:55.046708 (MainThread): Parsing macros/etc.sql
2022-12-17 01:23:55.050976 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:23:55.082933 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:23:55.086567 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:23:55.090106 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:23:55.107635 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:23:55.121362 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:23:55.126961 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:23:55.130285 (MainThread): Parsing macros/core.sql
2022-12-17 01:23:55.135512 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:23:55.194166 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:23:55.195640 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:23:55.206882 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:23:55.209101 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:23:55.211163 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:23:55.212569 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:23:55.215521 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:23:55.217769 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:23:55.220229 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:23:55.223627 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:23:55.225614 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:23:55.238705 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:23:55.247223 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:23:55.249671 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:23:55.257415 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:23:55.274766 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:23:55.277089 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:23:55.299270 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:23:55.338460 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:23:55.364014 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:23:55.372585 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:23:55.386267 (MainThread): Partial parsing not enabled
2022-12-17 01:23:55.446073 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:23:55.479630 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:23:55.496715 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:23:55.513841 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:23:55.530553 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:23:55.755048 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dfc97f0-5163-4d76-97c1-f10ecf761b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8270a3470>]}
2022-12-17 01:23:55.812713 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:23:55.814432 (MainThread): 
2022-12-17 01:23:55.814897 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:23:55.824179 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:23:55.824467 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:23:55.830317 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:23:55.952622 (MainThread): 01:23:55 | Concurrency: 1 threads (target='dev')
2022-12-17 01:23:55.952900 (MainThread): 01:23:55 | 
2022-12-17 01:23:55.955094 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:23:55.955686 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:23:55.955911 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:23:55.977628 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:23:55.978195 (Thread-1): finished collecting timing info
2022-12-17 01:23:55.978647 (Thread-1): finished collecting timing info
2022-12-17 01:23:55.979266 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:23:55.979911 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:23:55.980313 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:23:55.980482 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:23:55.989932 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:23:55.990359 (Thread-1): finished collecting timing info
2022-12-17 01:23:55.990723 (Thread-1): finished collecting timing info
2022-12-17 01:23:55.991266 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:23:55.991494 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:23:55.991993 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:23:55.992172 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:23:56.001713 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:23:56.002135 (Thread-1): finished collecting timing info
2022-12-17 01:23:56.002507 (Thread-1): finished collecting timing info
2022-12-17 01:23:56.003043 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:23:56.003256 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:23:56.003771 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:23:56.003943 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:23:56.013254 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:23:56.013662 (Thread-1): finished collecting timing info
2022-12-17 01:23:56.014032 (Thread-1): finished collecting timing info
2022-12-17 01:23:56.014586 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:23:56.014799 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:23:56.015275 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:23:56.015465 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:23:56.024794 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:23:56.025212 (Thread-1): finished collecting timing info
2022-12-17 01:23:56.025582 (Thread-1): finished collecting timing info
2022-12-17 01:23:56.026128 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:23:56.055213 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:23:56.055483 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:23:56.108230 (MainThread): 01:23:56 | Done.
2022-12-17 01:23:56.108592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8270b9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc826fdfba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8271300f0>]}
2022-12-17 01:23:56.108890 (MainThread): Flushing usage events
2022-12-17 01:24:00.206125 (MainThread): Running with dbt=0.19.0
2022-12-17 01:24:00.867658 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/jee/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-12-17 01:24:00.868642 (MainThread): Tracking: tracking
2022-12-17 01:24:00.877332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd135b2bf28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd135b2bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd135b401d0>]}
2022-12-17 01:24:00.929241 (MainThread): Partial parsing not enabled
2022-12-17 01:24:00.930257 (MainThread): Parsing macros/decode_fraud.sql
2022-12-17 01:24:00.934875 (MainThread): Parsing macros/catalog.sql
2022-12-17 01:24:00.942776 (MainThread): Parsing macros/etc.sql
2022-12-17 01:24:00.945432 (MainThread): Parsing macros/adapters.sql
2022-12-17 01:24:00.969178 (MainThread): Parsing macros/materializations/view.sql
2022-12-17 01:24:00.972947 (MainThread): Parsing macros/materializations/seed.sql
2022-12-17 01:24:00.976388 (MainThread): Parsing macros/materializations/incremental.sql
2022-12-17 01:24:00.992215 (MainThread): Parsing macros/materializations/table.sql
2022-12-17 01:24:01.004410 (MainThread): Parsing macros/materializations/copy.sql
2022-12-17 01:24:01.009778 (MainThread): Parsing macros/materializations/snapshot.sql
2022-12-17 01:24:01.013024 (MainThread): Parsing macros/core.sql
2022-12-17 01:24:01.017965 (MainThread): Parsing macros/adapters/common.sql
2022-12-17 01:24:01.072010 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-12-17 01:24:01.073344 (MainThread): Parsing macros/etc/datetime.sql
2022-12-17 01:24:01.084670 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-12-17 01:24:01.086792 (MainThread): Parsing macros/etc/is_incremental.sql
2022-12-17 01:24:01.088819 (MainThread): Parsing macros/etc/query.sql
2022-12-17 01:24:01.090157 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-12-17 01:24:01.092714 (MainThread): Parsing macros/schema_tests/unique.sql
2022-12-17 01:24:01.094869 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-12-17 01:24:01.097254 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-12-17 01:24:01.100722 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-12-17 01:24:01.102684 (MainThread): Parsing macros/materializations/helpers.sql
2022-12-17 01:24:01.113950 (MainThread): Parsing macros/materializations/table/table.sql
2022-12-17 01:24:01.122239 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-12-17 01:24:01.124564 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-12-17 01:24:01.132144 (MainThread): Parsing macros/materializations/common/merge.sql
2022-12-17 01:24:01.149312 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-12-17 01:24:01.151555 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-12-17 01:24:01.173710 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-12-17 01:24:01.211507 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-12-17 01:24:01.236739 (MainThread): Parsing macros/materializations/view/view.sql
2022-12-17 01:24:01.244548 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-12-17 01:24:01.258391 (MainThread): Partial parsing not enabled
2022-12-17 01:24:01.317384 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:24:01.350722 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:24:01.367249 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:24:01.384874 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:24:01.401871 (MainThread): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:24:01.631307 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '375ac3dd-9545-4af8-bbf9-7142c9c2758d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1359352e8>]}
2022-12-17 01:24:01.683644 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 159 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-12-17 01:24:01.684881 (MainThread): 
2022-12-17 01:24:01.685340 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:24:01.694204 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_final-project-team1".
2022-12-17 01:24:01.694593 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-12-17 01:24:01.873966 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_final-project-team1_timestamp_fraud_complete".
2022-12-17 01:24:01.874335 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-12-17 01:24:01.879852 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:24:02.005635 (MainThread): 01:24:02 | Concurrency: 1 threads (target='dev')
2022-12-17 01:24:02.005893 (MainThread): 01:24:02 | 
2022-12-17 01:24:02.007987 (Thread-1): Began running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:24:02.009386 (Thread-1): 01:24:02 | 1 of 5 START table model timestamp_fraud_complete.stg_raw_fraud...... [RUN]
2022-12-17 01:24:02.010613 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.stg_raw_fraud".
2022-12-17 01:24:02.010793 (Thread-1): Compiling model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:24:02.032765 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:24:02.033270 (Thread-1): finished collecting timing info
2022-12-17 01:24:02.060200 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:24:02.065408 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:24:02.234224 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.stg_raw_fraud"
2022-12-17 01:24:02.234872 (Thread-1): On model.online_payment_fraud.stg_raw_fraud: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.stg_raw_fraud"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
  
  
  OPTIONS()
  as (
    


SELECT     
    transactionID as id_transaction,
    step,
    timestamp,
    type as payment_type,
    amount,
    nameOrig as name_sender,
    oldbalanceOrg as old_balance_sender,
    newbalanceOrig as new_balance_sender,
    nameDest as name_recipient,
    oldbalanceDest as old_balance_recipient,
    newbalanceDest as new_balance_recipient,
    case isFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_fraud,
    case isFlaggedFraud
        when 0 then "Not Fraud"
        when 1 then "Fraud"
    end as is_flagged_fraud,
FROM `final-project-team1`.`timestamp_fraud_complete`.`raw_fraud`
ORDER BY timestamp, step
  );
    
2022-12-17 01:24:14.711695 (Thread-1): finished collecting timing info
2022-12-17 01:24:14.713015 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '375ac3dd-9545-4af8-bbf9-7142c9c2758d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1358bfeb8>]}
2022-12-17 01:24:14.714498 (Thread-1): 01:24:14 | 1 of 5 OK created table model timestamp_fraud_complete.stg_raw_fraud. [CREATE TABLE (6.4m rows, 694.1 MB processed) in 12.70s]
2022-12-17 01:24:14.714734 (Thread-1): Finished running node model.online_payment_fraud.stg_raw_fraud
2022-12-17 01:24:14.715597 (Thread-1): Began running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:24:14.716884 (Thread-1): 01:24:14 | 2 of 5 START table model timestamp_fraud_complete.dim_payment_type... [RUN]
2022-12-17 01:24:14.717341 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_payment_type".
2022-12-17 01:24:14.717516 (Thread-1): Compiling model.online_payment_fraud.dim_payment_type
2022-12-17 01:24:14.727317 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:24:14.727827 (Thread-1): finished collecting timing info
2022-12-17 01:24:14.733240 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:24:14.738452 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:24:14.866493 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_payment_type"
2022-12-17 01:24:14.867146 (Thread-1): On model.online_payment_fraud.dim_payment_type: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_payment_type"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_payment_type`
  
  
  OPTIONS()
  as (
    

WITH dim_payment_type AS(
    SELECT 
    payment_type
    -- payment_type
    -- case payment_type
    --     when payment_type "CASH_IN" THEN 1
    --     when payment_type "CASH_OUT" THEN 2
    --     when payment_type "DEBIT" THEN 3
    --     when payment_type "PAYMENT" THEN 4
    -- end as id_payment_type
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_payment_type
  );
    
2022-12-17 01:24:17.806682 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 43906), raddr=('209.85.147.95', 443)>
2022-12-17 01:24:17.807026 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 50984), raddr=('74.125.201.95', 443)>
2022-12-17 01:24:17.807258 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 43920), raddr=('209.85.147.95', 443)>
2022-12-17 01:24:17.807484 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 50996), raddr=('74.125.201.95', 443)>
2022-12-17 01:24:17.807799 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 43924), raddr=('209.85.147.95', 443)>
2022-12-17 01:24:17.808004 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 50998), raddr=('74.125.201.95', 443)>
2022-12-17 01:24:17.810536 (Thread-1): finished collecting timing info
2022-12-17 01:24:17.811524 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '375ac3dd-9545-4af8-bbf9-7142c9c2758d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd134911ba8>]}
2022-12-17 01:24:17.812938 (Thread-1): 01:24:17 | 2 of 5 OK created table model timestamp_fraud_complete.dim_payment_type [CREATE TABLE (6.4m rows, 57.2 MB processed) in 3.09s]
2022-12-17 01:24:17.813217 (Thread-1): Finished running node model.online_payment_fraud.dim_payment_type
2022-12-17 01:24:17.813484 (Thread-1): Began running node model.online_payment_fraud.dim_recipient
2022-12-17 01:24:17.815302 (Thread-1): 01:24:17 | 3 of 5 START table model timestamp_fraud_complete.dim_recipient...... [RUN]
2022-12-17 01:24:17.815788 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_recipient".
2022-12-17 01:24:17.815991 (Thread-1): Compiling model.online_payment_fraud.dim_recipient
2022-12-17 01:24:17.825916 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:24:17.826432 (Thread-1): finished collecting timing info
2022-12-17 01:24:17.831750 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:24:17.836983 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:24:17.982640 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_recipient"
2022-12-17 01:24:17.983307 (Thread-1): On model.online_payment_fraud.dim_recipient: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_recipient"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_recipient`
  
  
  OPTIONS()
  as (
    

WITH dim_recipient AS(
    SELECT
    name_recipient
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_recipient
  );
    
2022-12-17 01:24:34.201068 (Thread-1): finished collecting timing info
2022-12-17 01:24:34.202106 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '375ac3dd-9545-4af8-bbf9-7142c9c2758d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1358c9358>]}
2022-12-17 01:24:34.203571 (Thread-1): 01:24:34 | 3 of 5 OK created table model timestamp_fraud_complete.dim_recipient. [CREATE TABLE (6.4m rows, 75.7 MB processed) in 16.39s]
2022-12-17 01:24:34.203826 (Thread-1): Finished running node model.online_payment_fraud.dim_recipient
2022-12-17 01:24:34.204115 (Thread-1): Began running node model.online_payment_fraud.dim_sender
2022-12-17 01:24:34.205629 (Thread-1): 01:24:34 | 4 of 5 START table model timestamp_fraud_complete.dim_sender......... [RUN]
2022-12-17 01:24:34.206055 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.dim_sender".
2022-12-17 01:24:34.206254 (Thread-1): Compiling model.online_payment_fraud.dim_sender
2022-12-17 01:24:34.216161 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:24:34.216678 (Thread-1): finished collecting timing info
2022-12-17 01:24:34.222850 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:24:34.228092 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:24:34.366650 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.dim_sender"
2022-12-17 01:24:34.367461 (Thread-1): On model.online_payment_fraud.dim_sender: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.dim_sender"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`dim_sender`
  
  
  OPTIONS()
  as (
    

WITH dim_sender AS(
    SELECT
    name_sender
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    *
FROM 
    dim_sender
  );
    
2022-12-17 01:24:40.409030 (Thread-1): finished collecting timing info
2022-12-17 01:24:40.410193 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '375ac3dd-9545-4af8-bbf9-7142c9c2758d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1358bfe80>]}
2022-12-17 01:24:40.411695 (Thread-1): 01:24:40 | 4 of 5 OK created table model timestamp_fraud_complete.dim_sender.... [CREATE TABLE (6.4m rows, 75.7 MB processed) in 6.20s]
2022-12-17 01:24:40.411967 (Thread-1): Finished running node model.online_payment_fraud.dim_sender
2022-12-17 01:24:40.412317 (Thread-1): Began running node model.online_payment_fraud.fact_tables
2022-12-17 01:24:40.413940 (Thread-1): 01:24:40 | 5 of 5 START table model timestamp_fraud_complete.fact_tables........ [RUN]
2022-12-17 01:24:40.414429 (Thread-1): Acquiring new bigquery connection "model.online_payment_fraud.fact_tables".
2022-12-17 01:24:40.414582 (Thread-1): Compiling model.online_payment_fraud.fact_tables
2022-12-17 01:24:40.416078 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.128.0.12', 40442), raddr=('209.85.147.95', 443)>
2022-12-17 01:24:40.416286 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.128.0.12', 48036), raddr=('74.125.201.95', 443)>
2022-12-17 01:24:40.425596 (Thread-1): Writing injected SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:24:40.425978 (Thread-1): finished collecting timing info
2022-12-17 01:24:40.431056 (Thread-1): Opening a new connection, currently in state closed
2022-12-17 01:24:40.436219 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-12-17 01:24:40.569478 (Thread-1): Writing runtime SQL for node "model.online_payment_fraud.fact_tables"
2022-12-17 01:24:40.569979 (Thread-1): On model.online_payment_fraud.fact_tables: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "online_payment_fraud", "target_name": "dev", "node_id": "model.online_payment_fraud.fact_tables"} */


  create or replace table `final-project-team1`.`timestamp_fraud_complete`.`fact_tables`
  
  
  OPTIONS()
  as (
    

with fact_raw_fraud as (
    SELECT * 
    FROM `final-project-team1`.`timestamp_fraud_complete`.`stg_raw_fraud`
)

SELECT 
    id_transaction,
    step,
    timestamp,
    payment_type,
    amount,
    old_balance_sender,
    new_balance_sender,
    old_balance_recipient,
    new_balance_recipient,
    is_fraud,
    is_flagged_fraud
FROM
    fact_raw_fraud
  );
    
2022-12-17 01:24:48.159286 (Thread-1): finished collecting timing info
2022-12-17 01:24:48.160350 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '375ac3dd-9545-4af8-bbf9-7142c9c2758d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13488dfd0>]}
2022-12-17 01:24:48.161772 (Thread-1): 01:24:48 | 5 of 5 OK created table model timestamp_fraud_complete.fact_tables... [CREATE TABLE (6.4m rows, 579.0 MB processed) in 7.75s]
2022-12-17 01:24:48.161993 (Thread-1): Finished running node model.online_payment_fraud.fact_tables
2022-12-17 01:24:48.200356 (MainThread): Acquiring new bigquery connection "master".
2022-12-17 01:24:48.200962 (MainThread): 01:24:48 | 
2022-12-17 01:24:48.201213 (MainThread): 01:24:48 | Finished running 5 table models in 46.52s.
2022-12-17 01:24:48.201379 (MainThread): Connection 'master' was properly closed.
2022-12-17 01:24:48.201502 (MainThread): Connection 'model.online_payment_fraud.fact_tables' was properly closed.
2022-12-17 01:24:48.253652 (MainThread): 
2022-12-17 01:24:48.253917 (MainThread): Completed successfully
2022-12-17 01:24:48.254121 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-12-17 01:24:48.254415 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13592b278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd13599e6d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd166dd2320>]}
2022-12-17 01:24:48.254699 (MainThread): Flushing usage events
